<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>『魏超』的 blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.weichao.io/"/>
  <updated>2018-08-31T14:18:34.777Z</updated>
  <id>http://www.weichao.io/</id>
  
  <author>
    <name>魏超</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>U-Push 集成</title>
    <link href="http://www.weichao.io/2018/08/31/U-Push-%E9%9B%86%E6%88%90/"/>
    <id>http://www.weichao.io/2018/08/31/U-Push-集成/</id>
    <published>2018-08-31T14:06:55.000Z</published>
    <updated>2018-08-31T14:18:34.777Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li><a href="https://developer.umeng.com/docs/66632/detail/66744#h1-u91CDu8981u66F4u65B02" title="https://developer.umeng.com/docs/66632/detail/66744#h1-u91CDu8981u66F4u65B02" target="_blank" rel="external">U-Push集成文档</a></li></ul><hr><h1 id="在控制台创建-app"><a href="#在控制台创建-app" class="headerlink" title="在控制台创建 app"></a><strong>在控制台创建 app</strong></h1><hr><h1 id="导入-PushSDK"><a href="#导入-PushSDK" class="headerlink" title="导入 PushSDK"></a><strong>导入 PushSDK</strong></h1><p>1、工程添加仓库：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">allprojects</span> &#123;</div><div class="line">    <span class="keyword">repositories</span> &#123;</div><div class="line">        mavenCentral()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、app 添加依赖：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="string">'com.umeng.sdk:common:1.5.3'</span>     <span class="comment">// 友盟推送</span></div><div class="line">    implementation <span class="string">'com.umeng.sdk:utdid:1.1.5.3'</span></div><div class="line">    implementation <span class="string">'com.umeng.sdk:push:4.2.0'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>3、如果运行时报错：</p><blockquote><p>Program type already present: com.alibaba.sdk.android.utils.AMSDevReporter<br>Message{kind=ERROR, text=Program type already present: com.alibaba.sdk.android.utils.AMSDevReporter, sources=[Unknown source file], tool name=Optional.of(D8)}</p></blockquote><p>说明存在 jar 包冲突，即引用了同一 jar 包的不同版本，解决方法是去掉其中一个 jar 包的引用，比如：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation(<span class="string">'com.aliyun.ams:alicloud-android-hotfix:3.1.2'</span>) &#123;    <span class="comment">// 热修复</span></div><div class="line">        <span class="comment">// 关闭传递性依赖</span></div><div class="line">        <span class="keyword">exclude</span>(module: <span class="string">'alicloud-android-utdid'</span>)</div><div class="line">        <span class="keyword">exclude</span>(module: <span class="string">'alicloud-android-utils'</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><hr><h1 id="初始化-PushSDK"><a href="#初始化-PushSDK" class="headerlink" title="初始化 PushSDK"></a><strong>初始化 PushSDK</strong></h1><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>.onCreate();</div><div class="line">    initUPush();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><hr><h1 id="统计应用启动数据"><a href="#统计应用启动数据" class="headerlink" title="统计应用启动数据"></a><strong>统计应用启动数据</strong></h1><p>修改 BaseActivity：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">    Log.d(<span class="string">"life"</span>, TAG + <span class="string">" onCreate"</span>);</div><div class="line">    PushAgent.getInstance(<span class="keyword">this</span>).onAppStart();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>如果不调用此方法，不仅会导致按照“几天不活跃”条件来推送失效，还将导致广播发送不成功以及设备描述红色等问题发生。</p><hr><h1 id="混淆配置"><a href="#混淆配置" class="headerlink" title="混淆配置"></a><strong>混淆配置</strong></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">-dontwarn com.umeng.**</div><div class="line">-dontwarn com.taobao.**</div><div class="line">-dontwarn anet.channel.**</div><div class="line">-dontwarn anetwork.channel.**</div><div class="line">-dontwarn org.android.**</div><div class="line">-dontwarn org.apache.thrift.**</div><div class="line">-dontwarn com.xiaomi.**</div><div class="line">-dontwarn com.huawei.**</div><div class="line">-dontwarn com.meizu.**</div></pre></td></tr></table></figure><h1 id="功能集成"><a href="#功能集成" class="headerlink" title="功能集成"></a><strong>功能集成</strong></h1><h2 id="设置通知点击后的行为"><a href="#设置通知点击后的行为" class="headerlink" title="设置通知点击后的行为"></a><strong>设置通知点击后的行为</strong></h2><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="comment">// 自定义行为的回调处理，参考文档：高级功能-通知的展示及提醒-自定义通知打开动作</span></div><div class="line">    <span class="comment">// UmengNotificationClickHandler是在BroadcastReceiver中被调用，故如果需启动Activity，需添加Intent.FLAG_ACTIVITY_NEW_TASK</span></div><div class="line">    <span class="keyword">final</span> UmengNotificationClickHandler umengNotificationClickHandler = <span class="keyword">new</span> UmengNotificationClickHandler() &#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 启动 app</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">launchApp</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>.launchApp(context, msg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 打开 URL</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openUrl</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>.openUrl(context, msg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 打开指定页面</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openActivity</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>.openActivity(context, msg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 自定义行为</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealWithCustomAction</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (Constant.DEBUG) &#123;</div><div class="line">                Toast.makeText(context, msg.custom, Toast.LENGTH_LONG).show();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    pushAgent.setNotificationClickHandler(umengNotificationClickHandler);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="设置是否展示通知"><a href="#设置是否展示通知" class="headerlink" title="设置是否展示通知"></a><strong>设置是否展示通知</strong></h2><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">final</span> UmengMessageHandler umengMessageHandler = <span class="keyword">new</span> UmengMessageHandler() &#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 通知的回调方法，通知送达时触发</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealWithNotificationMessage</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            <span class="comment">// 调用super，会展示通知；不调用super，则不展示通知。</span></div><div class="line">            <span class="keyword">super</span>.dealWithNotificationMessage(context, msg);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    pushAgent.setMessageHandler(umengMessageHandler);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="设置通知免打扰时间段"><a href="#设置通知免打扰时间段" class="headerlink" title="设置通知免打扰时间段"></a><strong>设置通知免打扰时间段</strong></h2><p>默认是 23:00~7:00。</p><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.setNoDisturbMode(<span class="number">23</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>); <span class="comment">// 关闭免打扰：pushAgent.setNoDisturbMode(0, 0, 0, 0);</span></div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="设置通知冷却时间"><a href="#设置通知冷却时间" class="headerlink" title="设置通知冷却时间"></a><strong>设置通知冷却时间</strong></h2><p>默认是 60 秒。</p><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.setMuteDurationSeconds(<span class="number">10</span>);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="设置合并通知数"><a href="#设置合并通知数" class="headerlink" title="设置合并通知数"></a><strong>设置合并通知数</strong></h2><p>可以设置为 0~10 之间任意整数，默认是 1。</p><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.setDisplayNotificationNumber(<span class="number">2</span>); <span class="comment">// 参数为 0 时，表示不合并通知。</span></div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、效果</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%901.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%902.jpeg" alt=""></p><h2 id="自定义通知栏图标"><a href="#自定义通知栏图标" class="headerlink" title="自定义通知栏图标"></a><strong>自定义通知栏图标</strong></h2><ul><li>如果在发送后台没有指定通知栏图标，SDK 将使用本地的默认图标，其中，大图标默认使用 drawable 下的 umeng_push_notification_default_large_icon，小图标默认使用 drawable 下的 umeng_push_notification_default_small_icon。</li><li><del>若开发者没有设置这两个图标，则默认使用应用的图标（&lt;application android:icon=”@mipmap/ic_launcher”&gt;&lt;/application&gt;）。</del></li><li><del>若开发者在发送后台指定了图片的链接，则该链接将通过 Message 的 img 字段进行传输。当 SDK 接受到消息后，会先下载图片，下载成功后显示通知；若下载失败，会自动重试两次（总共下载 3 次）；若仍失败，则采用默认图片进行显示。</del></li><li><del>如果使用 API 方式来发送消息, 可以指定 icon 和 largeIcon 字段，分别对应状态栏图标和通知栏下拉之后左侧大图标 id（[R.drawable].icon）, 请填写对应图片文件名，不包含扩展名。</del></li><li><p>MIUI 暂时无法支持自定义通知栏图标，若开发者有需求，也可通过自定义通知栏样式来解决。</p></li><li><p>小图标 smallIcon：要求为 48*48 像素，图片各边至少留 1 个像素的透明，图标主体使用颜色，背景均使用透明。</p></li><li>大图标 largeIcon：要求为 64*64 像素。</li><li>对于超高分辨率的机型的适配，可以适当提高图标的尺寸。</li></ul><h2 id="自定义通知栏样式"><a href="#自定义通知栏样式" class="headerlink" title="自定义通知栏样式"></a><strong>自定义通知栏样式</strong></h2><p>1、新建布局 notification.xml：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"64dp"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@drawable/bg_new_word_list_recyclerview"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/notification_large_icon"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"64dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"64dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:scaleType</span>=<span class="string">"fitXY"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">"@mipmap/ic_launcher"</span> /&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/notification_title"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">"10dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">"5dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_toEndOf</span>=<span class="string">"@+id/notification_large_icon"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Title"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"@color/black"</span> /&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/notification_text"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_below</span>=<span class="string">"@+id/notification_title"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">"10dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_toEndOf</span>=<span class="string">"@+id/notification_large_icon"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Message"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"@color/black"</span> /&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_below</span>=<span class="string">"@+id/notification_text"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">"10dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_toEndOf</span>=<span class="string">"@+id/notification_large_icon"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"(嘿嘿，偷偷听告诉你，我是自定义的)"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"@color/black"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"12sp"</span> /&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/notification_small_icon"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"24dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"24dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_alignParentEnd</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">"5dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_marginEnd</span>=<span class="string">"5dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:scaleType</span>=<span class="string">"fitXY"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">"@mipmap/ic_launcher"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure><p>2、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">final</span> UmengMessageHandler umengMessageHandler = <span class="keyword">new</span> UmengMessageHandler() &#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 自定义通知栏样式的回调方法，通知展示到通知栏时触发</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> Notification <span class="title">getNotification</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">switch</span> (msg.builder_id) &#123;</div><div class="line">                <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">                    <span class="keyword">final</span> Notification.Builder builder;</div><div class="line">                    <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) &#123;</div><div class="line">                        <span class="keyword">final</span> NotificationChannel channel = <span class="keyword">new</span> NotificationChannel(<span class="string">"channel_id"</span>, <span class="string">"channel_name"</span>, NotificationManager.IMPORTANCE_HIGH);</div><div class="line">                        <span class="keyword">final</span> NotificationManager manager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);</div><div class="line">                        <span class="keyword">if</span> (manager != <span class="keyword">null</span>) &#123;</div><div class="line">                            manager.createNotificationChannel(channel);</div><div class="line">                        &#125;</div><div class="line">                        builder = <span class="keyword">new</span> Notification.Builder(context, <span class="string">"channel_id"</span>);</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        builder = <span class="keyword">new</span> Notification.Builder(context);</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">final</span> RemoteViews remoteViews = <span class="keyword">new</span> RemoteViews(context.getPackageName(), R.layout.notification);</div><div class="line">                    remoteViews.setTextViewText(R.id.notification_title, msg.title);</div><div class="line">                    remoteViews.setTextViewText(R.id.notification_text, msg.text);</div><div class="line">                    remoteViews.setImageViewBitmap(R.id.notification_large_icon, getLargeIcon(context, msg));</div><div class="line">                    remoteViews.setImageViewResource(R.id.notification_small_icon, getSmallIconId(context, msg));</div><div class="line">                    <span class="keyword">return</span> builder.setContent(remoteViews)</div><div class="line">                            .setSmallIcon(getSmallIconId(context, msg))</div><div class="line">                            .setTicker(msg.ticker)</div><div class="line">                            .setAutoCancel(<span class="keyword">true</span>)</div><div class="line">                            .build();</div><div class="line">                <span class="keyword">default</span>:</div><div class="line">                    <span class="comment">// 默认为0，若填写的builder_id并不存在，也使用默认。</span></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">super</span>.getNotification(context, msg);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    pushAgent.setMessageHandler(umengMessageHandler);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>3、效果</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%903.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%904.jpeg" alt=""></p><h2 id="设置通知到达时响铃、震动、呼吸灯策略"><a href="#设置通知到达时响铃、震动、呼吸灯策略" class="headerlink" title="设置通知到达时响铃、震动、呼吸灯策略"></a><strong>设置通知到达时响铃、震动、呼吸灯策略</strong></h2><ul><li>MsgConstant.NOTIFICATION_PLAY_SERVER：通过服务端推送状态来设置客户端响铃、震动、呼吸灯的状态。</li><li>MsgConstant.NOTIFICATION_PLAY_SDK_ENABLE：不关心服务端推送状态，客户端都会响铃、震动、呼吸灯亮。</li><li>MsgConstant.NOTIFICATION_PLAY_SDK_DISABLE：不关心服务端推送状态，客户端不会响铃、震动、呼吸灯亮。</li></ul><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.setNotificationPlaySound(MsgConstant.NOTIFICATION_PLAY_SERVER);       <span class="comment">// 声音</span></div><div class="line">    pushAgent.setNotificationPlayLights(MsgConstant.NOTIFICATION_PLAY_SDK_ENABLE);  <span class="comment">// 呼吸灯</span></div><div class="line">    pushAgent.setNotificationPlayVibrate(MsgConstant.NOTIFICATION_PLAY_SDK_DISABLE);<span class="comment">// 振动</span></div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="自定义通知栏声音"><a href="#自定义通知栏声音" class="headerlink" title="自定义通知栏声音"></a><strong>自定义通知栏声音</strong></h2><p><em>TODO 适配 8.0+。</em></p><ul><li>如果在发送后台没有指定通知栏的声音，SDK 将采用本地默认的声音，即 res/raw/umeng_push_notification_default_sound。若无此文件，则默认使用系统的 Notification 声音。</li><li>若需要在线配置声音，则需先将与配置的声音文件放置在 res/raw 下，然后自发送后台指定声音的 id，即 R.raw.[sound] 里的 sound。</li></ul><h2 id="设置应用在前台时是否显示通知"><a href="#设置应用在前台时是否显示通知" class="headerlink" title="设置应用在前台时是否显示通知"></a><strong>设置应用在前台时是否显示通知</strong></h2><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.setNotificaitonOnForeground(<span class="keyword">false</span>);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="自定义消息"><a href="#自定义消息" class="headerlink" title="自定义消息"></a><strong>自定义消息</strong></h2><p>自定义消息的内容存放在 UMessage.custom 字段里。</p><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">final</span> UmengMessageHandler umengMessageHandler = <span class="keyword">new</span> UmengMessageHandler() &#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 自定义消息的回调方法，通知被点击时触发</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealWithCustomMessage</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> UMessage msg)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"dealWithCustomMessage()"</span>);</div><div class="line">            <span class="keyword">if</span> (Constant.DEBUG) &#123;</div><div class="line">                Toast.makeText(context, msg.custom, Toast.LENGTH_LONG).show();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    pushAgent.setMessageHandler(umengMessageHandler);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="设置用户标签（Tag）"><a href="#设置用户标签（Tag）" class="headerlink" title="设置用户标签（Tag）"></a><strong>设置用户标签（Tag）</strong></h2><p>方便推送时按标签过滤。</p><h3 id="添加标签"><a href="#添加标签" class="headerlink" title="添加标签"></a><strong>添加标签</strong></h3><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.getTagManager().addTags(<span class="keyword">new</span> TagManager.TCallBack() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(<span class="keyword">final</span> <span class="keyword">boolean</span> isSuccess, <span class="keyword">final</span> ITagManager.Result result)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"isSuccess: "</span> + isSuccess + <span class="string">";result: "</span> + result.toString());</div><div class="line">        &#125;</div><div class="line">    &#125;, <span class="string">"movie"</span>, <span class="string">"sport"</span>);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%905.png" alt=""></p><p>3、添加完成后，如果之前没有用户添加过该标签，现在就可以从控制台可以看到该标签并可以按该标签推送了：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%906.png" alt=""></p><h3 id="获取服务器端的所有标签"><a href="#获取服务器端的所有标签" class="headerlink" title="获取服务器端的所有标签"></a><strong>获取服务器端的所有标签</strong></h3><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.getTagManager().getTags(<span class="keyword">new</span> TagManager.TagListCallBack() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(<span class="keyword">boolean</span> isSuccess, List&lt;String&gt; result)</span> </span>&#123;</div><div class="line">            Log.i(TAG, result.toString());</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%907.png" alt=""></p><h3 id="删除标签"><a href="#删除标签" class="headerlink" title="删除标签"></a><strong>删除标签</strong></h3><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.getTagManager().deleteTags(<span class="keyword">new</span> TagManager.TCallBack() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(<span class="keyword">final</span> <span class="keyword">boolean</span> isSuccess, <span class="keyword">final</span> ITagManager.Result result)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"isSuccess: "</span> + isSuccess + <span class="string">";result: "</span> + result.toString());</div><div class="line">        &#125;</div><div class="line">    &#125;, <span class="string">"movie"</span>);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%908.png" alt=""></p><h2 id="设置用户加权标签（Weighted-Tag）"><a href="#设置用户加权标签（Weighted-Tag）" class="headerlink" title="设置用户加权标签（Weighted Tag）"></a><strong>设置用户加权标签（Weighted Tag）</strong></h2><p><em>TODO 该功能尚未开通。</em></p><h3 id="添加加权标签"><a href="#添加加权标签" class="headerlink" title="添加加权标签"></a><strong>添加加权标签</strong></h3><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">final</span> Hashtable&lt;String, Integer&gt; hashtable = <span class="keyword">new</span> Hashtable&lt;&gt;();</div><div class="line">    hashtable.put(<span class="string">"财经"</span>, <span class="number">5</span>);</div><div class="line">    pushAgent.getTagManager().addWeightedTags(<span class="keyword">new</span> TagManager.TCallBack() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(<span class="keyword">final</span> <span class="keyword">boolean</span> isSuccess, <span class="keyword">final</span> ITagManager.Result result)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"isSuccess: "</span> + isSuccess + <span class="string">";result: "</span> + result.toString());</div><div class="line">        &#125;</div><div class="line">    &#125;, hashtable);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%909.png" alt=""></p><h3 id="获取服务器端的所有加权标签"><a href="#获取服务器端的所有加权标签" class="headerlink" title="获取服务器端的所有加权标签"></a><strong>获取服务器端的所有加权标签</strong></h3><h3 id="删除加权标签"><a href="#删除加权标签" class="headerlink" title="删除加权标签"></a><strong>删除加权标签</strong></h3><h2 id="设置用户别名（Alias）"><a href="#设置用户别名（Alias）" class="headerlink" title="设置用户别名（Alias）"></a><strong>设置用户别名（Alias）</strong></h2><p>如果你的应用有自有的用户 id 体系，可以 在SDK 中通过 Alias 字段上传自有用户 id，按用户 id 向用户推送消息。<br>方便推送时按别名过滤（单点推送）。</p><h3 id="添加用户别名"><a href="#添加用户别名" class="headerlink" title="添加用户别名"></a><strong>添加用户别名</strong></h3><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.addAlias(<span class="string">"659xxx"</span>, <span class="string">"ALIAS_TYPE_DEMO"</span>, <span class="keyword">new</span> UTrack.ICallBack() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(<span class="keyword">boolean</span> isSuccess, String message)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"isSuccess: "</span> + isSuccess + <span class="string">";message: "</span> + message);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%9010.png" alt=""></p><h3 id="删除用户别名"><a href="#删除用户别名" class="headerlink" title="删除用户别名"></a><strong>删除用户别名</strong></h3><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.deleteAlias(<span class="string">"659xxx"</span>, <span class="string">"ALIAS_TYPE_DEMO"</span>, <span class="keyword">new</span> UTrack.ICallBack() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(<span class="keyword">boolean</span> isSuccess, String message)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"isSuccess: "</span> + isSuccess + <span class="string">";message: "</span> + message);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%9011.png" alt=""></p><h2 id="自定义参数"><a href="#自定义参数" class="headerlink" title="自定义参数"></a><strong>自定义参数</strong></h2><h3 id="SDK-回调"><a href="#SDK-回调" class="headerlink" title="SDK 回调"></a><strong>SDK 回调</strong></h3><h4 id="getNotification-Context-context-UMessage-msg"><a href="#getNotification-Context-context-UMessage-msg" class="headerlink" title="getNotification(Context context, UMessage msg)"></a><strong>getNotification(Context context, UMessage msg)</strong></h4><p>通知展示到通知栏时触发。</p><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">final</span> UmengMessageHandler umengMessageHandler = <span class="keyword">new</span> UmengMessageHandler() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> Notification <span class="title">getNotification</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"getNotification()"</span>);</div><div class="line">            <span class="keyword">if</span> (msg != <span class="keyword">null</span> &amp;&amp; msg.extra != <span class="keyword">null</span>) &#123;</div><div class="line">                <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : msg.extra.entrySet()) &#123;</div><div class="line">                    <span class="keyword">final</span> String key = entry.getKey();</div><div class="line">                    <span class="keyword">final</span> String value = entry.getValue();</div><div class="line">                    Log.i(TAG, <span class="string">"key: "</span> + key + <span class="string">";value: "</span> + value);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    pushAgent.setMessageHandler(umengMessageHandler);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、Logcat 查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%9012.png" alt=""></p><h4 id="dealWithCustomAction-Context-context-UMessage-msg"><a href="#dealWithCustomAction-Context-context-UMessage-msg" class="headerlink" title="dealWithCustomAction(Context context, UMessage msg)"></a><strong>dealWithCustomAction(Context context, UMessage msg)</strong></h4><p>通知被点击时触发。</p><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">final</span> UmengNotificationClickHandler umengNotificationClickHandler = <span class="keyword">new</span> UmengNotificationClickHandler() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealWithCustomAction</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"dealWithCustomAction()"</span>);</div><div class="line">            <span class="keyword">if</span> (msg != <span class="keyword">null</span> &amp;&amp; msg.extra != <span class="keyword">null</span>) &#123;</div><div class="line">                <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : msg.extra.entrySet()) &#123;</div><div class="line">                    <span class="keyword">final</span> String key = entry.getKey();</div><div class="line">                    <span class="keyword">final</span> String value = entry.getValue();</div><div class="line">                    Log.i(TAG, <span class="string">"key: "</span> + key + <span class="string">";value: "</span> + value);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    pushAgent.setNotificationClickHandler(umengNotificationClickHandler);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Intent-回调"><a href="#Intent-回调" class="headerlink" title="Intent 回调"></a><strong>Intent 回调</strong></h3><p>1、修改 Activity：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>.onResume();</div><div class="line">    <span class="keyword">final</span> Bundle bundle = getIntent().getExtras();</div><div class="line">    <span class="keyword">if</span> (bundle != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">final</span> Set&lt;String&gt; keySet = bundle.keySet();</div><div class="line">        <span class="keyword">for</span> (String key : keySet) &#123;</div><div class="line">            <span class="keyword">final</span> String value = bundle.getString(key);</div><div class="line">            Log.i(TAG, <span class="string">"key: "</span> + key + <span class="string">";value: "</span> + value);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onNewIntent</span><span class="params">(Intent intent)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>.onNewIntent(intent);</div><div class="line">    setIntent(intent);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、修改 Activity 启动方式为 singleTask。</p><p>3、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%9013.png" alt=""></p><h2 id="自定义资源包名"><a href="#自定义资源包名" class="headerlink" title="自定义资源包名"></a><strong>自定义资源包名</strong></h2><p>修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initUPush</span><span class="params">()</span> </span>&#123;</div><div class="line">    UMConfigure.init(<span class="keyword">this</span>, <span class="string">"5xxxxxxxxxxxxxxxxxxxxxx0"</span>, AppUtil.getMetaDataValueFromApplication(<span class="keyword">this</span>, <span class="string">"UMENG_CHANNEL"</span>), UMConfigure.DEVICE_TYPE_PHONE, <span class="string">"4xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx3"</span>);</div><div class="line">    <span class="keyword">final</span> PushAgent pushAgent = PushAgent.getInstance(<span class="keyword">this</span>);</div><div class="line">    pushAgent.setResourcePackageName(<span class="string">"com.xx.xx"</span>);</div><div class="line">    <span class="comment">// 注册</span></div><div class="line">    pushAgent.register(<span class="keyword">new</span> IUmengRegisterCallback() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String deviceToken)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"device token: "</span> + deviceToken);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">            Log.i(TAG, <span class="string">"register failed: "</span> + s + <span class="string">" "</span> + s1);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="关闭推送"><a href="#关闭推送" class="headerlink" title="关闭推送"></a><strong>关闭推送</strong></h2><p>不能在刚刚注册后开启或关闭推送。</p><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">pushAgent.disable(<span class="keyword">new</span> IUmengCallback() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">()</span> </span>&#123;</div><div class="line">        Log.i(TAG, <span class="string">"onSuccess()"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">        Log.i(TAG, <span class="string">"onFailure(s"</span> + s + <span class="string">", "</span> + s1 + <span class="string">")"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%9014.png" alt=""></p><h2 id="开启推送"><a href="#开启推送" class="headerlink" title="开启推送"></a><strong>开启推送</strong></h2><p>不能在刚刚注册后开启或关闭推送。</p><p>1、修改 Application：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">pushAgent.enable(<span class="keyword">new</span> IUmengCallback() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">()</span> </span>&#123;</div><div class="line">        Log.i(TAG, <span class="string">"onSuccess()"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(String s, String s1)</span> </span>&#123;</div><div class="line">        Log.i(TAG, <span class="string">"onFailure(s"</span> + s + <span class="string">", "</span> + s1 + <span class="string">")"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p>2、断点查看：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%9015.png" alt=""></p><h2 id="支持多包名"><a href="#支持多包名" class="headerlink" title="支持多包名"></a><strong>支持多包名</strong></h2><p>若一个 APP 针对不同渠道有不同的包名，则可通过开通多包名支持一个 AppKey 对应多个包名发送消息。<br>如果同一设备安装同一应用的不同包名的多个安装包，只有最后安装的应用可以正常收到推送消息。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E9%9B%86%E6%88%9016.png" alt=""></p><h2 id="完全自定义处理（透传）"><a href="#完全自定义处理（透传）" class="headerlink" title="完全自定义处理（透传）"></a><strong>完全自定义处理（透传）</strong></h2><p><em>TODO 未实现。</em></p><p>使用完全自定义处理后，PushSDK 只负责下发消息体且只统计送达数，展示逻辑需由开发者自己写代码实现，点击数和忽略数需由开发者调用 UTrack 类的 trackMsgClick 和 trackMsgDismissed 方法进行统计。</p><h2 id="应用内消息"><a href="#应用内消息" class="headerlink" title="应用内消息"></a><strong>应用内消息</strong></h2><h3 id="全屏消息"><a href="#全屏消息" class="headerlink" title="全屏消息"></a><strong>全屏消息</strong></h3><p><em>TODO 未实现。</em></p><p>Activity 需要继承 UmengSplashMessageActivity，而不是实现某个接口。</p><h3 id="插屏消息"><a href="#插屏消息" class="headerlink" title="插屏消息"></a><strong>插屏消息</strong></h3><p><em>TODO 未实现。</em></p><h3 id="自定义插屏"><a href="#自定义插屏" class="headerlink" title="自定义插屏"></a><strong>自定义插屏</strong></h3><p><em>TODO 未实现。</em></p><h3 id="纯文本"><a href="#纯文本" class="headerlink" title="纯文本"></a><strong>纯文本</strong></h3><p><em>TODO 未实现。</em></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://de
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>U-Push 控制台可配置参数及其对应效果的测试</title>
    <link href="http://www.weichao.io/2018/08/24/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%95/"/>
    <id>http://www.weichao.io/2018/08/24/U-Push-控制台可配置参数及其对应效果的测试/</id>
    <published>2018-08-24T12:52:46.000Z</published>
    <updated>2018-08-24T13:22:39.727Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li><a href="https://github.com/umeng/MultiFunctionAndroidDemo" title="https://github.com/umeng/MultiFunctionAndroidDemo" target="_blank" rel="external">MultiFunctionAndroidDemo</a></li><li><a href="https://developer.umeng.com/docs/66632/detail/66744#h2--appkey-umeng-message-secret3" title="https://developer.umeng.com/docs/66632/detail/66744#h2--appkey-umeng-message-secret3" target="_blank" rel="external">U-Push集成文档</a></li></ul><hr><h1 id="全部默认"><a href="#全部默认" class="headerlink" title="全部默认"></a><strong>全部默认</strong></h1><h2 id="消息详情"><a href="#消息详情" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%951.png" alt=""></p><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a><strong>效果</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%952.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%953.jpeg" alt=""></p><hr><h1 id="基础内容-展示样式-定制样式"><a href="#基础内容-展示样式-定制样式" class="headerlink" title="基础内容/展示样式/定制样式"></a><strong>基础内容/展示样式/定制样式</strong></h1><h2 id="预置在-app-内的样式"><a href="#预置在-app-内的样式" class="headerlink" title="预置在 app 内的样式"></a><strong>预置在 app 内的样式</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> Notification <span class="title">getNotification</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">    <span class="keyword">switch</span> (msg.builder_id) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">            Notification.Builder builder = <span class="keyword">new</span> Notification.Builder(context);</div><div class="line">            RemoteViews myNotificationView = <span class="keyword">new</span> RemoteViews(context.getPackageName(),</div><div class="line">                R.layout.notification_view);</div><div class="line">            myNotificationView.setTextViewText(R.id.notification_title, msg.title);</div><div class="line">            myNotificationView.setTextViewText(R.id.notification_text, msg.text);</div><div class="line">            myNotificationView.setImageViewBitmap(R.id.notification_large_icon, getLargeIcon(context, msg));</div><div class="line">            myNotificationView.setImageViewResource(R.id.notification_small_icon,</div><div class="line">                getSmallIconId(context, msg));</div><div class="line">            builder.setContent(myNotificationView)</div><div class="line">                .setSmallIcon(getSmallIconId(context, msg))</div><div class="line">                .setTicker(msg.ticker)</div><div class="line">                .setAutoCancel(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">            <span class="keyword">return</span> builder.getNotification();</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="comment">//默认为0，若填写的builder_id并不存在，也使用默认。</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.getNotification(context, msg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="消息详情-1"><a href="#消息详情-1" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%954.png" alt=""></p><h2 id="效果-1"><a href="#效果-1" class="headerlink" title="效果"></a><strong>效果</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%955.png" alt=""></p><hr><h1 id="基础内容-展示样式-图片"><a href="#基础内容-展示样式-图片" class="headerlink" title="基础内容/展示样式/图片"></a><strong>基础内容/展示样式/图片</strong></h1><h2 id="上传图片"><a href="#上传图片" class="headerlink" title="上传图片"></a><strong>上传图片</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%956.png" alt=""></p><h2 id="消息详情-2"><a href="#消息详情-2" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%957.png" alt=""></p><h2 id="效果-2"><a href="#效果-2" class="headerlink" title="效果"></a><strong>效果</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%958.png" alt=""></p><hr><h1 id="基础内容-自定义图标-应用内图标文件"><a href="#基础内容-自定义图标-应用内图标文件" class="headerlink" title="基础内容/自定义图标/应用内图标文件"></a><strong>基础内容/自定义图标/应用内图标文件</strong></h1><h2 id="大图标文件"><a href="#大图标文件" class="headerlink" title="大图标文件"></a><strong>大图标文件</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%959.png" alt=""></p><h2 id="小图标文件"><a href="#小图标文件" class="headerlink" title="小图标文件"></a><strong>小图标文件</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9510.png" alt=""></p><h2 id="消息详情-3"><a href="#消息详情-3" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9511.png" alt=""></p><h2 id="效果-3"><a href="#效果-3" class="headerlink" title="效果"></a><strong>效果</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9512.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9513.jpeg" alt=""></p><hr><h1 id="基础内容-自定义图标-上传图标文件"><a href="#基础内容-自定义图标-上传图标文件" class="headerlink" title="基础内容/自定义图标/上传图标文件"></a><strong>基础内容/自定义图标/上传图标文件</strong></h1><h2 id="大图标文件-1"><a href="#大图标文件-1" class="headerlink" title="大图标文件"></a><strong>大图标文件</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9514.png" alt=""></p><h2 id="小图标文件-1"><a href="#小图标文件-1" class="headerlink" title="小图标文件"></a><strong>小图标文件</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9515.png" alt=""></p><h2 id="消息详情-4"><a href="#消息详情-4" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9516.png" alt=""></p><h2 id="效果-4"><a href="#效果-4" class="headerlink" title="效果"></a><strong>效果</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9517.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9518.jpeg" alt=""></p><hr><h1 id="基础内容-是否展开-大图"><a href="#基础内容-是否展开-大图" class="headerlink" title="基础内容/是否展开/大图"></a><strong>基础内容/是否展开/大图</strong></h1><h2 id="上传图片-1"><a href="#上传图片-1" class="headerlink" title="上传图片"></a><strong>上传图片</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9519.png" alt=""></p><h2 id="消息详情-5"><a href="#消息详情-5" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9520.png" alt=""></p><h2 id="效果-5"><a href="#效果-5" class="headerlink" title="效果"></a><strong>效果</strong></h2><p>点击下拉按钮可以显示图片。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9521.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9522.jpeg" alt=""></p><hr><h1 id="目标人群-目标人群-部分用户"><a href="#目标人群-目标人群-部分用户" class="headerlink" title="目标人群/目标人群/部分用户"></a><strong>目标人群/目标人群/部分用户</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9523.png" alt=""></p><p>按【标签】过滤时提示“无匹配结果”是因为没有用户添加过标签。</p><hr><h1 id="目标人群-目标人群-独立用户"><a href="#目标人群-目标人群-独立用户" class="headerlink" title="目标人群/目标人群/独立用户"></a><strong>目标人群/目标人群/独立用户</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9524.png" alt=""></p><hr><h1 id="目标人群-目标人群-推送时间-定时推送"><a href="#目标人群-目标人群-推送时间-定时推送" class="headerlink" title="目标人群/目标人群/推送时间/定时推送"></a><strong>目标人群/目标人群/推送时间/定时推送</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9525.png" alt=""></p><hr><h1 id="目标人群-目标人群-推送时间-重复推送"><a href="#目标人群-目标人群-推送时间-重复推送" class="headerlink" title="目标人群/目标人群/推送时间/重复推送"></a><strong>目标人群/目标人群/推送时间/重复推送</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9526.png" alt=""></p><hr><h1 id="后续行为-后续动作-打开连接-URL"><a href="#后续行为-后续动作-打开连接-URL" class="headerlink" title="后续行为/后续动作/打开连接(URL)"></a><strong>后续行为/后续动作/打开连接(URL)</strong></h1><h2 id="消息详情-6"><a href="#消息详情-6" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9527.png" alt=""></p><h2 id="效果-6"><a href="#效果-6" class="headerlink" title="效果"></a><strong>效果</strong></h2><p>显示效果和默认相同，但是点击后启动浏览器访问 URL。</p><hr><h1 id="后续行为-后续动作-打开指定页面"><a href="#后续行为-后续动作-打开指定页面" class="headerlink" title="后续行为/后续动作/打开指定页面"></a><strong>后续行为/后续动作/打开指定页面</strong></h1><h2 id="消息详情-7"><a href="#消息详情-7" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9528.png" alt=""></p><h2 id="效果-7"><a href="#效果-7" class="headerlink" title="效果"></a><strong>效果</strong></h2><p>显示效果和默认相同，但是点击后打开 app 内的一个 activity，不能是其他 app 的。</p><hr><h1 id="后续行为-后续动作-自定义行为"><a href="#后续行为-后续动作-自定义行为" class="headerlink" title="后续行为/后续动作/自定义行为"></a><strong>后续行为/后续动作/自定义行为</strong></h1><h2 id="预置在-app-内的处理"><a href="#预置在-app-内的处理" class="headerlink" title="预置在 app 内的处理"></a><strong>预置在 app 内的处理</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealWithCustomAction</span><span class="params">(Context context, UMessage msg)</span> </span>&#123;</div><div class="line">    Toast.makeText(context, msg.custom, Toast.LENGTH_LONG).show();</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="消息详情-8"><a href="#消息详情-8" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9530.png" alt=""></p><h2 id="效果-8"><a href="#效果-8" class="headerlink" title="效果"></a><strong>效果</strong></h2><p>显示效果和默认相同，但是点击后触发回调。</p><hr><h1 id="后续行为-后续动作-自定义参数"><a href="#后续行为-后续动作-自定义参数" class="headerlink" title="后续行为/后续动作/自定义参数"></a><strong>后续行为/后续动作/自定义参数</strong></h1><h2 id="消息详情-9"><a href="#消息详情-9" class="headerlink" title="消息详情"></a><strong>消息详情</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9531.png" alt=""></p><h2 id="效果-9"><a href="#效果-9" class="headerlink" title="效果"></a><strong>效果</strong></h2><p>显示效果和默认相同，但是点击后在触发 4 个可选【后续动作】中对应的回调的同时，会传递参数。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9532.png" alt=""></p><hr><h1 id="后续行为-系统通道-MIUI、EMUI、Flyme系统设备离线转为系统下发"><a href="#后续行为-系统通道-MIUI、EMUI、Flyme系统设备离线转为系统下发" class="headerlink" title="后续行为/系统通道/MIUI、EMUI、Flyme系统设备离线转为系统下发"></a><strong>后续行为/系统通道/MIUI、EMUI、Flyme系统设备离线转为系统下发</strong></h1><p><em>TODO 暂不清楚是干啥的。</em></p><hr><h1 id="后续行为-提醒方式"><a href="#后续行为-提醒方式" class="headerlink" title="后续行为/提醒方式"></a><strong>后续行为/提醒方式</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9533.png" alt=""></p><hr><h1 id="后续行为-高级设置-限制发送速度"><a href="#后续行为-高级设置-限制发送速度" class="headerlink" title="后续行为/高级设置/限制发送速度"></a><strong>后续行为/高级设置/限制发送速度</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9534.png" alt=""></p><hr><h1 id="后续行为-高级设置-消息触发器"><a href="#后续行为-高级设置-消息触发器" class="headerlink" title="后续行为/高级设置/消息触发器"></a><strong>后续行为/高级设置/消息触发器</strong></h1><p>为用户加上标签，方便推送时按照标签来筛选。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/U-Push-%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%AF%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E6%95%88%E6%9E%9C%E7%9A%84%E6%B5%8B%E8%AF%9535.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://gi
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>华为开发者联盟 MDM 和 ROM 定制</title>
    <link href="http://www.weichao.io/2018/08/16/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B6/"/>
    <id>http://www.weichao.io/2018/08/16/华为开发者联盟-MDM-和-ROM-定制/</id>
    <published>2018-08-16T15:12:11.000Z</published>
    <updated>2018-08-16T15:22:11.385Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li><a href="https://developer.huawei.com/consumer/cn/devservice/doc/10101" title="https://developer.huawei.com/consumer/cn/devservice/doc/10101" target="_blank" rel="external">安全类授权开放SDK</a></li></ul><hr><h1 id="MDM"><a href="#MDM" class="headerlink" title="MDM"></a><strong>MDM</strong></h1><h2 id="在官网下载资料"><a href="#在官网下载资料" class="headerlink" title="在官网下载资料"></a><strong>在官网下载资料</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B61.png" alt=""></p><p>下载的 SecurityAuthorizationOpenSDK-2.0.rar 包里面提供了部分资料，但是《目录结构说明.txt》中提到的【华为证书HUAWEI.cer】和【MDMSample.apk】均没有提供。</p><h3 id="coding-前"><a href="#coding-前" class="headerlink" title="coding 前"></a><strong>coding 前</strong></h3><p>1、开发指导书：<br>docs/HW安全类授权开放SDK开发指导书V2.0.pdf</p><p>2、功能概述：<br>docs/功能简介V2.0.pdf<br>docs/HW安全类授权开放SDK功能介绍及展示文档V2.0.pdf</p><p>3、demo（该项目直接导入 IDE 后不能正常使用，修改后的版本可<a href="https://github.com/weichao66666/MDMSample" title="https://github.com/weichao66666/MDMSample" target="_blank" rel="external">下载</a>）：<br>samples/MDMSample</p><h3 id="coding-中"><a href="#coding-中" class="headerlink" title="coding 中"></a><strong>coding 中</strong></h3><p>1、调用华为接口所需的 jar 包：<br>libs/hwsdk-mdm-openapi-2.0.0.jar</p><p>2、API：<br>docs/HW安全类授权开放SDK API接口(EMUI4.1-8.0)V2.0.pdf</p><h3 id="coding-后"><a href="#coding-后" class="headerlink" title="coding 后"></a><strong>coding 后</strong></h3><p>1、APK 签名与华为证书签名要求：<br>docs/关于签名.pdf</p><p>2、华为证书签名工具和使用说明：<br>tools/DevPack.exe<br>tools/Devpack使用说明.pdf</p><h2 id="SDK-集成步骤"><a href="#SDK-集成步骤" class="headerlink" title="SDK 集成步骤"></a><strong>SDK 集成步骤</strong></h2><h3 id="添加基本权限"><a href="#添加基本权限" class="headerlink" title="添加基本权限"></a><strong>添加基本权限</strong></h3><p>在 AndroidManifest.xml 中添加：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"com.huawei.permission.sec.MDM"</span> /&gt;</span></div></pre></td></tr></table></figure><h3 id="引入-jar-包"><a href="#引入-jar-包" class="headerlink" title="引入 jar 包"></a><strong>引入 jar 包</strong></h3><p>1、将 hwsdk-mdm-openapi-2.0.0.jar 放入 libs 目录。</p><p>2、确保 build.gradle 中有：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div></pre></td></tr></table></figure><p>或：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">implementation files(<span class="string">'libs/hwsdk-mdm-openapi-2.0.0.jar'</span>)</div></pre></td></tr></table></figure><h3 id="调用接口（比如：最基本的静默激活管控）"><a href="#调用接口（比如：最基本的静默激活管控）" class="headerlink" title="调用接口（比如：最基本的静默激活管控）"></a><strong>调用接口（比如：最基本的静默激活管控）</strong></h3><p>1、创建 ComponentName 时可以添加回调：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SampleDeviceReceiver</span> <span class="keyword">extends</span> <span class="title">DeviceAdminReceiver</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"SampleDeviceReceiver"</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEnabled</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</div><div class="line">        Log.v(TAG, <span class="string">"onEnabled()"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisabled</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</div><div class="line">        Log.v(TAG, <span class="string">"onDisabled()"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> CharSequence <span class="title">onDisableRequested</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</div><div class="line">        Log.v(TAG, <span class="string">"onDisableRequested()"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="string">"onDisableRequested()"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、创建 ComponentName，调用接口静默激活管控：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">final</span> ComponentName componentName = <span class="keyword">new</span> ComponentName(<span class="keyword">this</span>, SampleDeviceReceiver.class);</div><div class="line">    DevicePolicyManager devicePolicyManager = (DevicePolicyManager) getSystemService(Context.DEVICE_POLICY_SERVICE);</div><div class="line">    <span class="keyword">if</span> (devicePolicyManager != <span class="keyword">null</span> &amp;&amp; !devicePolicyManager.isAdminActive(componentName)) &#123;</div><div class="line">        DeviceControlManager deviceControlManager = <span class="keyword">new</span> DeviceControlManager();</div><div class="line">        deviceControlManager.setSilentActiveAdmin(componentName);</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">    e.printStackTrace();</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="避免混淆"><a href="#避免混淆" class="headerlink" title="避免混淆"></a><strong>避免混淆</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-keep class com.huawei.android.app.**&#123;*;&#125;</div></pre></td></tr></table></figure><h2 id="跳转到华为桌面"><a href="#跳转到华为桌面" class="headerlink" title="跳转到华为桌面"></a><strong>跳转到华为桌面</strong></h2><p>直接使用：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Intent intent = getPackageManager().getLaunchIntentForPackage(<span class="string">"com.huawei.android.launcher"</span>);</div><div class="line">startActivity(intent);</div></pre></td></tr></table></figure><p>返回的 intent 为 null。</p><p>需要直接指定包名和类名：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Intent intent = <span class="keyword">new</span> Intent();</div><div class="line">intent.setClassName(<span class="string">"com.huawei.android.launcher"</span>, <span class="string">"com.huawei.android.launcher.unihome.UniHomeLauncher"</span>);</div><div class="line">startActivity(intent);</div></pre></td></tr></table></figure><h2 id="打包时签名"><a href="#打包时签名" class="headerlink" title="打包时签名"></a><strong>打包时签名</strong></h2><p>打包时签名只使用 V1 签名，不使用 V2 签名：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B62.png" alt=""></p><h2 id="华为证书签名"><a href="#华为证书签名" class="headerlink" title="华为证书签名"></a><strong>华为证书签名</strong></h2><p>首先需要一个华为开发者账号，这个账号和应用在华为应用市场上架是同一个。</p><h3 id="证书申请"><a href="#证书申请" class="headerlink" title="证书申请"></a><strong>证书申请</strong></h3><p>1、在官网找到【权签】：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B63.png" alt=""></p><p>2、申请权签服务（第一次申请的是开发证书）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B64.png" alt=""></p><p>3、与代理商签订《API授权证书申请承诺函》并将电子扫描件发送。</p><p>该文件需要盖公章、骑缝章，法人授权代码签名。</p><h4 id="开发证书申请"><a href="#开发证书申请" class="headerlink" title="开发证书申请"></a><strong>开发证书申请</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B65.png" alt=""></p><p>证书和设备绑定，在同一设备上可以正常使用开发证书签名后的任意版本的同一包名的 app，也就是实现了修改 app 后签名有效。<br>证书有效期最长半年。<br>审批时间大概 1 天。</p><h4 id="商用证书申请"><a href="#商用证书申请" class="headerlink" title="商用证书申请"></a><strong>商用证书申请</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B66.png" alt=""></p><p>证书和 app 绑定，在任意设备上可以正常使用商用证书签名后的唯一 app，也就是实现了更换设备后签名有效。<br>证书有效期无限。<br>审批时间大概 3 天。</p><h3 id="证书签名"><a href="#证书签名" class="headerlink" title="证书签名"></a><strong>证书签名</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B67.png" alt=""></p><hr><h1 id="ROM-定制"><a href="#ROM-定制" class="headerlink" title="ROM 定制"></a><strong>ROM 定制</strong></h1><h2 id="开机动画前的-Logo"><a href="#开机动画前的-Logo" class="headerlink" title="开机动画前的 Logo"></a><strong>开机动画前的 Logo</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/%E5%8D%8E%E4%B8%BA%E5%BC%80%E5%8F%91%E8%80%85%E8%81%94%E7%9B%9F-MDM-%E5%92%8C-ROM-%E5%AE%9A%E5%88%B68.jpeg" alt=""></p><p>仅支持修改黑色背景图。</p><h2 id="开机动画"><a href="#开机动画" class="headerlink" title="开机动画"></a><strong>开机动画</strong></h2><p>需要提供 30~50 张 JPG 或 PNG 格式的图片，形成帧动画。<br>支持单次/循环播放。</p><h2 id="开机向导界面裁剪"><a href="#开机向导界面裁剪" class="headerlink" title="开机向导界面裁剪"></a><strong>开机向导界面裁剪</strong></h2><p>最少保留：选择语言、协议与条款、应用权限开关说明。</p><h2 id="预置-app-到-Pad-中"><a href="#预置-app-到-Pad-中" class="headerlink" title="预置 app 到 Pad 中"></a><strong>预置 app 到 Pad 中</strong></h2><p>1、填写《【开发者联盟专用】第三方应用安全自检checklist V2.1》并发送。</p><p>2、与代理商签订《预置软件免责协议》并将电子扫描件发送。</p><p>该文件需要盖公章、骑缝章，法人授权代码签名。</p><h2 id="app-开机自启"><a href="#app-开机自启" class="headerlink" title="app 开机自启"></a><strong>app 开机自启</strong></h2><h2 id="硬件定制-Logo"><a href="#硬件定制-Logo" class="headerlink" title="硬件定制 Logo"></a><strong>硬件定制 Logo</strong></h2><p>需要找第三方厂商，需要单独收费，如果订货量在 3000 台以上厂商可以做。</p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://de
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>腾讯浏览服务（TBS）bug 反馈流程</title>
    <link href="http://www.weichao.io/2018/08/16/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B/"/>
    <id>http://www.weichao.io/2018/08/16/腾讯浏览服务（TBS）bug-反馈流程/</id>
    <published>2018-08-16T15:03:09.000Z</published>
    <updated>2018-08-16T15:08:30.830Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li><a href="https://x5.tencent.com/" title="https://x5.tencent.com/" target="_blank" rel="external">腾讯浏览服务</a></li><li><a href="http://bbs.mb.qq.com/forum-110-1.html" title="http://bbs.mb.qq.com/forum-110-1.html" target="_blank" rel="external">QQ 浏览器移动产品论坛-X5专区</a></li></ul><hr><h1 id="bug-示例"><a href="#bug-示例" class="headerlink" title="bug 示例"></a><strong>bug 示例</strong></h1><p>快速点击按钮，两次加载同一 url，部分时候会出现：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B1.png" alt=""></p><hr><h1 id="确认-bug-是否由-TBS-导致"><a href="#确认-bug-是否由-TBS-导致" class="headerlink" title="确认 bug 是否由 TBS 导致"></a><strong>确认 bug 是否由 TBS 导致</strong></h1><h2 id="确认-bug-是否属于原生"><a href="#确认-bug-是否属于原生" class="headerlink" title="确认 bug 是否属于原生"></a><strong>确认 bug 是否属于原生</strong></h2><p>打开【开发者选项】中的【显示布局边界】。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B2.png" alt=""></p><h2 id="复现-bug"><a href="#复现-bug" class="headerlink" title="复现 bug"></a><strong>复现 bug</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8Bdemo480p.gif" alt=""></p><p>如果可以看见布局边框，说明 bug 属于原生，否则可能是原生自定义控件或前端页面。</p><h2 id="确认-bug-在系统-WebView-中是否存在"><a href="#确认-bug-在系统-WebView-中是否存在" class="headerlink" title="确认 bug 在系统 WebView 中是否存在"></a><strong>确认 bug 在系统 WebView 中是否存在</strong></h2><p>1、长按 WebView 中的文字部分，如果未出现【选择复制】说明是系统 WebView（第一次启动app肯定是系统 WebView，如果第一次使用时间足够长，会将 TBS 下载到本地，从第二次开始 app 使用的就是 TBS）。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B3.png" alt=""></p><p>在该场景下尝试复现 bug。</p><p>2、长按 WebView 中的文字部分，如果出现【选择复制】说明是 TBS。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B4.png" alt=""></p><p>在该场景下尝试复现 bug。</p><hr><h1 id="通过论坛反馈-bug"><a href="#通过论坛反馈-bug" class="headerlink" title="通过论坛反馈 bug"></a><strong>通过论坛反馈 bug</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B5.png" alt=""></p><h2 id="生成网络日志"><a href="#生成网络日志" class="headerlink" title="生成网络日志"></a><strong>生成网络日志</strong></h2><p>参考官方文档<a href="http://bbs.mb.qq.com/thread-1945241-1-1.html" title="http://bbs.mb.qq.com/thread-1945241-1-1.html" target="_blank" rel="external">《合作方网络日志抓取方法（反馈时附带抓取的日志，可优先处理）》</a>。</p><p>1、可以在 Log 层添加加载 <a href="http://debugx5.qq.com" target="_blank" rel="external">http://debugx5.qq.com</a> 的开关。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B6.png" alt=""></p><p>2、如果本地没有 TBS，加载 <a href="http://debugx5.qq.com" target="_blank" rel="external">http://debugx5.qq.com</a> 时会有相关提示：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B7.png" alt=""></p><p>3、点击【进入DebugTbs安装或打开X5内核】，安装线上内核。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B8.png" alt=""></p><p>4、重启 app，再次加载 <a href="http://debugx5.qq.com。" target="_blank" rel="external">http://debugx5.qq.com。</a></p><p>5、点击【日志功能开启】。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B9.png" alt=""></p><p>6、点击 Log 层的 WebView 返回，再复现 bug。</p><p>7、点击【日志功能关闭并上传】。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B10.png" alt=""></p><p>8、记录 GUID，将 GUID 输入反馈页面的【操作步骤】中。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%85%BE%E8%AE%AF%E6%B5%8F%E8%A7%88%E6%9C%8D%E5%8A%A1%EF%BC%88TBS%EF%BC%89bug-%E5%8F%8D%E9%A6%88%E6%B5%81%E7%A8%8B11.png" alt=""></p><hr><h1 id="等待客服人员联系"><a href="#等待客服人员联系" class="headerlink" title="等待客服人员联系"></a><strong>等待客服人员联系</strong></h1><p>联系我的时间在晚上 10 点左右。</p><hr><h1 id="bug-修复结果"><a href="#bug-修复结果" class="headerlink" title="bug 修复结果"></a><strong>bug 修复结果</strong></h1><p>bug 解决后在对应贴子下回复修复结果。</p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://x5
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg 录制 HTTP 流</title>
    <link href="http://www.weichao.io/2018/07/29/FFmpeg-%E5%BD%95%E5%88%B6-HTTP-%E6%B5%81/"/>
    <id>http://www.weichao.io/2018/07/29/FFmpeg-录制-HTTP-流/</id>
    <published>2018-07-29T07:41:15.000Z</published>
    <updated>2018-07-29T07:44:51.746Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a><strong>简介</strong></h1><p>使用 HTTP 可以传输 FLV 直播流、TS 直播流、M3U8 及 TS 文件。</p><hr><h1 id="HTTP-参数说明"><a href="#HTTP-参数说明" class="headerlink" title="HTTP 参数说明"></a><strong>HTTP 参数说明</strong></h1><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>seekable</td><td>布尔</td><td>设置 HTTP 链接为可以 seek 操作</td></tr><tr><td>chunked_post</td><td>布尔</td><td>使用 Chunked 模式 post 数据</td></tr><tr><td>http_proxy</td><td>字符串</td><td>设置 HTTP 代理传输数据</td></tr><tr><td>headers</td><td>字符串</td><td>自定义 HTTP Header 数据</td></tr><tr><td>content_type</td><td>字符串</td><td>设置 POST 的内容类型</td></tr><tr><td>user_agent</td><td>字符串</td><td>设置 HTTP 请求客户端信息</td></tr><tr><td>multiple_requests</td><td>布尔</td><td>HTTP 长连接开启</td></tr><tr><td>post_data</td><td>二进制数据</td><td>设置将要 POST 的数据</td></tr><tr><td>cookies</td><td>字符串</td><td>设置 HTTP 请求时写代码的 Cookies</td></tr><tr><td>icy</td><td>布尔</td><td>请求 ICY 元数据：默认打开</td></tr><tr><td>auth_type</td><td>整数</td><td>HTTP 验证类型设置</td></tr><tr><td>offset</td><td>整数</td><td>初始化 HTTP 请求时的偏移位置</td></tr><tr><td>method</td><td>字符串</td><td>发起 HTTP 请求时使用的 HTTP 的方法</td></tr><tr><td>reconnect</td><td>布尔</td><td>在 EOF 之前断开发起重连</td></tr><tr><td>reconnect_at_eof</td><td>布尔</td><td>在得到 EOF 时发起重连</td></tr><tr><td>reply_code</td><td>整数</td><td>作为 HTTP 服务时向客户端反馈状态码</td></tr></tbody></table><hr><h1 id="参数使用示例"><a href="#参数使用示例" class="headerlink" title="参数使用示例"></a><strong>参数使用示例</strong></h1><h2 id="seekable"><a href="#seekable" class="headerlink" title="seekable"></a><strong>seekable</strong></h2><h3 id="阻塞"><a href="#阻塞" class="headerlink" title="阻塞"></a><strong>阻塞</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -ss 300 -seekable 0 -i http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8 -c copy output.mp4</div></pre></td></tr></table></figure><p>2、输出结果（实际没播放成功）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%BD%95%E5%88%B6-HTTP-%E6%B5%811.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%BD%95%E5%88%B6-HTTP-%E6%B5%812.png" alt=""></p><h3 id="非阻塞"><a href="#非阻塞" class="headerlink" title="非阻塞"></a><strong>非阻塞</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -ss 300 -seekable 1 -i http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8 -c copy -y output.mp4</div></pre></td></tr></table></figure><p>2、输出结果（实际没播放成功）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%BD%95%E5%88%B6-HTTP-%E6%B5%813.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%BD%95%E5%88%B6-HTTP-%E6%B5%814.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg 录制 RTSP 流</title>
    <link href="http://www.weichao.io/2018/07/29/FFmpeg-%E5%BD%95%E5%88%B6-RTSP-%E6%B5%81/"/>
    <id>http://www.weichao.io/2018/07/29/FFmpeg-录制-RTSP-流/</id>
    <published>2018-07-29T07:38:50.000Z</published>
    <updated>2018-07-29T07:40:41.702Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="FFmpeg-操作-RTSP-的参数"><a href="#FFmpeg-操作-RTSP-的参数" class="headerlink" title="FFmpeg 操作 RTSP 的参数"></a><strong>FFmpeg 操作 RTSP 的参数</strong></h1><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>initial_pause</td><td>布尔</td><td>建立连接后暂停播放</td></tr><tr><td>rtsp_transport</td><td>标记</td><td>设置 RTSP 传输协议，具体如下：<br>udp：UDP<br>tcp：TCP<br>udp_multicast：UDP 多播协议<br>http：HTTP 隧道</td></tr><tr><td>rtsp_flags</td><td>标记</td><td>RTSP 使用标记，具体如下：<br>filter_src：只接收指定 IP 的流<br>listen：设置为被动接收模式<br>prefer_tcp：TCP 亲和模式，如果 TCP 可用则首选 TCP 传输</td></tr><tr><td>allowed_media_types</td><td>标记</td><td>设置允许接收的数据模式（默认为全部开启）：<br>video：只接收视频<br>audio：只接收音频<br>data：只接收数据<br>subtitle：只接收字幕</td></tr><tr><td>min_port</td><td>整数</td><td>设置最小本地 UDP 端口，默认为 5000</td></tr><tr><td>max_port</td><td>整数</td><td>设置最大本地 UDP 端口，默认为 65000</td></tr><tr><td>timeout</td><td>整数</td><td>设置监听端口超时时间</td></tr><tr><td>reorder_queue_size</td><td>整数</td><td>设置录制数据 Buffer 的大小</td></tr><tr><td>buffer_size</td><td>整数</td><td>设置底层传输包 Buffer 的大小</td></tr><tr><td>user-agent</td><td>字符串</td><td>用户客户端标识</td></tr></tbody></table><hr><h1 id="参数使用示例"><a href="#参数使用示例" class="headerlink" title="参数使用示例"></a><strong>参数使用示例</strong></h1><h2 id="rtsp-transport"><a href="#rtsp-transport" class="headerlink" title="rtsp_transport"></a><strong>rtsp_transport</strong></h2><p>FFmpeg 默认使用的 RTSP 拉流的方式是 UDP 传输。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -rtsp_transport tcp -i rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov -c copy -f mp4 output.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%BD%95%E5%88%B6-RTSP-%E6%B5%811.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg 发布与录制 RTMP 流</title>
    <link href="http://www.weichao.io/2018/07/29/FFmpeg-%E5%8F%91%E5%B8%83%E4%B8%8E%E5%BD%95%E5%88%B6-RTMP-%E6%B5%81/"/>
    <id>http://www.weichao.io/2018/07/29/FFmpeg-发布与录制-RTMP-流/</id>
    <published>2018-07-29T07:34:57.000Z</published>
    <updated>2018-07-29T07:38:03.035Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="FFmpeg-操作-RTMP-的参数"><a href="#FFmpeg-操作-RTMP-的参数" class="headerlink" title="FFmpeg 操作 RTMP 的参数"></a><strong>FFmpeg 操作 RTMP 的参数</strong></h1><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>rtmp_app</td><td>字符串</td><td>RTMP 流发布点，又称 APP</td></tr><tr><td>rtmp_buffer</td><td>整数</td><td>客户端 buffer 大小（单位：毫秒），默认为 3 秒</td></tr><tr><td>rtmp_conn</td><td>字符串</td><td>在 RTMP 的 Connect 命令中增加自定义 AMF 数据</td></tr><tr><td>rtmp_flashver</td><td>字符串</td><td>设置模拟的 flashplugin 的版本号</td></tr><tr><td>rtmp_live</td><td>整数</td><td>指定 RTMP 流媒体播放类型，具体如下：<br>any：直播或点播随意<br>live：直播<br>recorded：点播</td></tr><tr><td>rtmp_pageurl</td><td>字符串</td><td>RTMP 在 Connect 命令中设置的 PageURL 字段，其为播放时所在的 Web 页面 URL</td></tr><tr><td>rtmp_playpath</td><td>字符串</td><td>RTMP 流播放的 Stream 地址，或者称为密钥，或者称为发布流</td></tr><tr><td>rtmp_subscribe</td><td>字符串</td><td>直播流名称，默认设置为 rtmp_playpath 的值</td></tr><tr><td>rtmp_swfhash</td><td>二进制数据</td><td>解压 swf 文件后的 SHA256 的 hash 值</td></tr><tr><td>rtmp_swfsize</td><td>整数</td><td>swf 文件解压后的大小，用于 swf 认证</td></tr><tr><td>rtmp_swfurl</td><td>字符串</td><td>RTMP 的 Connect 命令中设置的 swfURL 播放器的 URL</td></tr><tr><td>rtmp_swfverify</td><td>字符串</td><td>设置 swf 认证时 swf 文件的 URL 地址</td></tr><tr><td>rtmp_tcurl</td><td>字符串</td><td>RTMP 的 Connect 命令中设置的 tcURL 目标发布点地址，一般形如 rtmp://xxx.xxx.xxx/app</td></tr><tr><td>rtmp_listen</td><td>整数</td><td>开启 RTMP 服务时所监听的端口</td></tr><tr><td>listen</td><td>整数</td><td>与 rtmp_listen 相同</td></tr><tr><td>timeout</td><td>整数</td><td>监听 rtmp 端口时设置的超时时间，以秒为单位</td></tr></tbody></table><hr><h1 id="参数使用示例"><a href="#参数使用示例" class="headerlink" title="参数使用示例"></a><strong>参数使用示例</strong></h1><h2 id="rtmp-app"><a href="#rtmp-app" class="headerlink" title="rtmp_app"></a><strong>rtmp_app</strong></h2><h3 id="推流"><a href="#推流" class="headerlink" title="推流"></a><strong>推流</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i sample.mp4 -c copy -f flv -rtmp_app live rtmp://publish.chinaffmpeg.com</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%8F%91%E5%B8%83%E4%B8%8E%E5%BD%95%E5%88%B6-RTMP-%E6%B5%811.png" alt=""></p><h3 id="拉流"><a href="#拉流" class="headerlink" title="拉流"></a><strong>拉流</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -rtmp_app live -i rtmp://publish.chinaffmpeg.com -c copy -f flv output.flv</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%8F%91%E5%B8%83%E4%B8%8E%E5%BD%95%E5%88%B6-RTMP-%E6%B5%812.png" alt=""></p><h2 id="rtmp-playpath"><a href="#rtmp-playpath" class="headerlink" title="rtmp_playpath"></a><strong>rtmp_playpath</strong></h2><h3 id="推流-1"><a href="#推流-1" class="headerlink" title="推流"></a><strong>推流</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f flv -rtmp_app live -rtmp_playpath class rtmp://publish.chinaffmpeg.com</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%8F%91%E5%B8%83%E4%B8%8E%E5%BD%95%E5%88%B6-RTMP-%E6%B5%813.png" alt=""></p><h3 id="拉流-1"><a href="#拉流-1" class="headerlink" title="拉流"></a><strong>拉流</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -rtmp_app live -rtmp_playpath class -i rtmp://publish.chinaffmpeg.com -c copy -f flv output.flv</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%8F%91%E5%B8%83%E4%B8%8E%E5%BD%95%E5%88%B6-RTMP-%E6%B5%814.png" alt=""></p><h2 id="省略-rtmp-app-和-rtmp-playpath-的写法"><a href="#省略-rtmp-app-和-rtmp-playpath-的写法" class="headerlink" title="省略 rtmp_app 和 rtmp_playpath 的写法"></a><strong>省略 rtmp_app 和 rtmp_playpath 的写法</strong></h2><h3 id="推流-2"><a href="#推流-2" class="headerlink" title="推流"></a><strong>推流</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.flv -c copy -f flv rtmp://publish.chinaffmpeg.com/live/class</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%8F%91%E5%B8%83%E4%B8%8E%E5%BD%95%E5%88%B6-RTMP-%E6%B5%815.png" alt=""></p><h3 id="拉流-2"><a href="#拉流-2" class="headerlink" title="拉流"></a><strong>拉流</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i rtmp://publish.chinaffmpeg.com/live/class -c copy -f flv output.flv</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E5%8F%91%E5%B8%83%E4%B8%8E%E5%BD%95%E5%88%B6-RTMP-%E6%B5%816.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg 输出 AAC</title>
    <link href="http://www.weichao.io/2018/07/29/FFmpeg-%E8%BE%93%E5%87%BA-AAC/"/>
    <id>http://www.weichao.io/2018/07/29/FFmpeg-输出-AAC/</id>
    <published>2018-07-29T07:25:31.000Z</published>
    <updated>2018-07-29T07:55:56.964Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="AAC"><a href="#AAC" class="headerlink" title="AAC"></a><strong>AAC</strong></h1><p>与 MP3 相比，AAC 是一种编码效率更高、编码音质更好的音频编码格式，常见的使用 AAC 编码后的文件存储格式为 m4a。</p><hr><h1 id="抽取-MP4-文件中的音频为-AAC"><a href="#抽取-MP4-文件中的音频为-AAC" class="headerlink" title="抽取 MP4 文件中的音频为 AAC"></a><strong>抽取 MP4 文件中的音频为 AAC</strong></h1><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -c:a aac -b:a 160k output.aac</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-AAC1.png" alt=""></p><h2 id="使用-q-参数"><a href="#使用-q-参数" class="headerlink" title="使用 q 参数"></a><strong>使用 q 参数</strong></h2><p>q 表示 qscale，有效范围为 0.1~2，用于设置 AAC 音频的 VBR 质量。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -c:a aac -q:a 2 output.aac</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-AAC2.png" alt=""></p><hr><h1 id="FDK-AAC-第三方的-AAC-编解码-Codec-库"><a href="#FDK-AAC-第三方的-AAC-编解码-Codec-库" class="headerlink" title="FDK AAC 第三方的 AAC 编解码 Codec 库"></a><strong>FDK AAC 第三方的 AAC 编解码 Codec 库</strong></h1><p>FDK AAC 是 FFmpeg 支持的第三方编码库中质量最高的 AAC 编码库。</p><h2 id="恒定码率（CBR）模式"><a href="#恒定码率（CBR）模式" class="headerlink" title="恒定码率（CBR）模式"></a><strong>恒定码率（CBR）模式</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -c:a libfdk_aac -b:a 128k output.aac</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-AAC3.png" alt=""></p><h2 id="动态码率（VBR）模式"><a href="#动态码率（VBR）模式" class="headerlink" title="动态码率（VBR）模式"></a><strong>动态码率（VBR）模式</strong></h2><table><thead><tr><th>VBR</th><th>每声道码率（kbit/s）</th><th>码率信息</th></tr></thead><tbody><tr><td>1</td><td>20~32</td><td>LC、HE、HEv2</td></tr><tr><td>2</td><td>32~40</td><td>LC、HE、HEv2</td></tr><tr><td>3</td><td>48~56</td><td>LC、HE、HEv2</td></tr><tr><td>4</td><td>64~72</td><td>LC</td></tr><tr><td>5</td><td>96~112</td><td>LC</td></tr></tbody></table><ul><li>LC：Low Complexity AAC，这种编码相对来说体积比较大，质量稍差</li><li>HE：High-Efficiency AAC，这种编码相对来说体积稍小，质量较好</li><li>HEv2：High-Efficiency AAC version2，这种编码相对来说体积小，质量优</li></ul><h3 id="AAC-编码-LC、HE、HEv2-推荐参数"><a href="#AAC-编码-LC、HE、HEv2-推荐参数" class="headerlink" title="AAC 编码 LC、HE、HEv2 推荐参数"></a><strong>AAC 编码 LC、HE、HEv2 推荐参数</strong></h3><table><tr><td>编码类型</td><td>码率范围（bit/s）</td><td>支持的采样率/kHz</td><td>推荐的采样率/kHz</td><td>声道数</td></tr><tr><td rowspan="4">HE-AAC v2（AAC LC + SBR + P）</td><td>8000 ~ 11999</td><td>22.05, 24.00</td><td>24.00</td><td>2</td></tr><tr><td>12000 ~ 17999</td><td>32.00</td><td>32.00</td><td>2</td></tr><tr><td>18000 ~ 39999</td><td>32.00, 44.10, 48.00</td><td>44.10</td><td>2</td></tr><tr><td>40000 ~ 56000</td><td>32.00, 44.10, 48.00</td><td>48.00</td><td>2</td></tr><tr><td rowspan="7">HE-AAC（AAC LC + SBR）</td><td>8000 ~ 11999</td><td>22.05, 24.00</td><td>24.00</td><td>1</td></tr><tr><td>12000 ~ 17999</td><td>32.00</td><td>32.00</td><td>1</td></tr><tr><td>18000 ~ 39999</td><td>32.00, 44.10, 48.00</td><td>44.10</td><td>1</td></tr><tr><td>40000 ~ 56000</td><td>32.00, 44.10, 48.00</td><td>48.00</td><td>1</td></tr><tr><td>16000 ~ 27999</td><td>32.00, 44.10, 48.00</td><td>32.00</td><td>2</td></tr><tr><td>28000 ~ 63999</td><td>32.00, 44.10, 48.00</td><td>44.10</td><td>2</td></tr><tr><td>64000 ~ 128000</td><td>32.00, 44.10, 48.00</td><td>48.00</td><td>2</td></tr><tr><td rowspan="4">HE-AAC（AAC LC + SBR）</td><td>64000 ~ 69999</td><td>32.00, 44.10, 48.00</td><td>32.00</td><td>5, 5.1</td></tr><tr><td>70000 ~ 159999</td><td>32.00, 44.10, 48.00</td><td>44.10</td><td>5, 5.1</td></tr><tr><td>160000 ~ 245999</td><td>32.00, 44.10, 48.00</td><td>48.00</td><td>5</td></tr><tr><td>160000 ~ 265999</td><td>32.00, 44.10, 48.00</td><td>48.00</td><td>5.1</td></tr><tr><td rowspan="6">AAC LC</td><td>8000 ~ 15999</td><td>11.025, 12.00, 16.00</td><td>12.00</td><td>1</td></tr><tr><td>16000 ~ 23999</td><td>16.00</td><td>16.00</td><td>1</td></tr><tr><td>24000 ~ 31999</td><td>16.00, 22.05, 24.00</td><td>24.00</td><td>1</td></tr><tr><td>32000 ~ 55999</td><td>32.00</td><td>32.00</td><td>1</td></tr><tr><td>56000 ~ 160000</td><td>32.00, 44.10, 48.00</td><td>44.10</td><td>1</td></tr><tr><td>160001 ~ 288000</td><td>48.00</td><td>48.00</td><td>1</td></tr><tr><td rowspan="7">AAC LC</td><td>16000 ~ 23999</td><td>11.025, 12.00, 16.00</td><td>12.00</td><td>2</td></tr><tr><td>24000 ~ 31999</td><td>16.00</td><td>16.00</td><td>2</td></tr><tr><td>32000 ~ 39999</td><td>16.00, 22.05, 24.00</td><td>22.05</td><td>2</td></tr><tr><td>40000 ~ 95999</td><td>32.00</td><td>32.00</td><td>2</td></tr><tr><td>96000 ~ 111999</td><td>32.00, 44.10, 48.00</td><td>32.00</td><td>2</td></tr><tr><td>112000 ~ 320001</td><td>32.00, 44.10, 48.00</td><td>44.10</td><td>2</td></tr><tr><td>320002 ~ 576000</td><td>48.00</td><td>48.00</td><td>2</td></tr><tr><td rowspan="3">AAC LC</td><td>160000 ~ 239999</td><td>32.00</td><td>32.00</td><td>5, 5.1</td></tr><tr><td>240000 ~ 279999</td><td>32.00, 44.10, 48.00</td><td>32.00</td><td>5, 5.1</td></tr><tr><td>280000 ~ 800000</td><td>32.00, 44.10, 48.00</td><td>44.10</td><td>5, 5.1</td></tr></table><h2 id="压缩为-AAC-编码的-m4a-容器"><a href="#压缩为-AAC-编码的-m4a-容器" class="headerlink" title="压缩为 AAC 编码的 m4a 容器"></a><strong>压缩为 AAC 编码的 m4a 容器</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -c:a libfdk_aac output.m4a</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-AAC4.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-AAC5.png" alt=""></p><h3 id="高质量-AAC-设置"><a href="#高质量-AAC-设置" class="headerlink" title="高质量 AAC 设置"></a><strong>高质量 AAC 设置</strong></h3><h4 id="HE-AAC-音频编码设置"><a href="#HE-AAC-音频编码设置" class="headerlink" title="HE-AAC 音频编码设置"></a><strong>HE-AAC 音频编码设置</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -c:a libfdk_aac -profile:a aac_he -b:a 64k output.aac</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-AAC6.png" alt=""></p><h4 id="HEv2-AAC-音频编码设置"><a href="#HEv2-AAC-音频编码设置" class="headerlink" title="HEv2-AAC 音频编码设置"></a><strong>HEv2-AAC 音频编码设置</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -c:a libfdk_aac -profile:a aac_he_v2 -b:a 32k output.aac</div></pre></td></tr></table></figure><p>2、输出结果（失败）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-AAC7.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg 输出 MP3</title>
    <link href="http://www.weichao.io/2018/07/29/FFmpeg-%E8%BE%93%E5%87%BA-MP3/"/>
    <id>http://www.weichao.io/2018/07/29/FFmpeg-输出-MP3/</id>
    <published>2018-07-29T03:11:11.000Z</published>
    <updated>2018-07-29T03:18:28.948Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a><strong>实现方式</strong></h1><p>FFmpeg 使用第三方库 libmp3lame 编码 MP3。</p><hr><h1 id="获取-libmp3lame-编码-MP3-的参数"><a href="#获取-libmp3lame-编码-MP3-的参数" class="headerlink" title="获取 libmp3lame 编码 MP3 的参数"></a><strong>获取 libmp3lame 编码 MP3 的参数</strong></h1><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -h encoder=libmp3lame</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-MP31.png" alt=""></p><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a><strong>参数</strong></h2><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>b</td><td>布尔</td><td>设置 MP3 编码的码率</td></tr><tr><td>joint_stereo</td><td>布尔</td><td>设置环绕立体声模式</td></tr><tr><td>abr</td><td>布尔</td><td>设置编码为 ABR 状态，自动调整码率</td></tr><tr><td>compression_level</td><td>整数</td><td>设置压缩算法质量，参数设置为 0~9 区间的值即可，数值越大质量越差，但是编码速度越快</td></tr><tr><td>q</td><td>整型</td><td>设置恒质量的 VBR。调用 lame 接口的话，设置 global_quality 变量具有同样的效果</td></tr></tbody></table><hr><h1 id="转编码-MP3"><a href="#转编码-MP3" class="headerlink" title="转编码 MP3"></a><strong>转编码 MP3</strong></h1><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -acodec libmp3lame output.mp3</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-MP32.png" alt=""></p><hr><h1 id="设置编码-MP3-的质量"><a href="#设置编码-MP3-的质量" class="headerlink" title="设置编码 MP3 的质量"></a><strong>设置编码 MP3 的质量</strong></h1><table><thead><tr><th>lame 操作参数</th><th>平均码率(kbit/s)</th><th>码率区间(kbit/s)</th><th>ffmpeg 操作参数</th></tr></thead><tbody><tr><td>-b 320</td><td>320</td><td>320(CBR)</td><td>-b:a 320k</td></tr><tr><td>-v 0</td><td>245</td><td>220~260</td><td>-q:a 0</td></tr><tr><td>-v 1</td><td>225</td><td>190~250</td><td>-q:a 1</td></tr><tr><td>-v 2</td><td>190</td><td>170~210</td><td>-q:a 2</td></tr><tr><td>-v 3</td><td>175</td><td>150~195</td><td>-q:a 3</td></tr><tr><td>-v 4</td><td>165</td><td>140~185</td><td>-q:a 4</td></tr><tr><td>-v 5</td><td>130</td><td>120~150</td><td>-q:a 5</td></tr><tr><td>-v 6</td><td>115</td><td>100~130</td><td>-q:a 6</td></tr><tr><td>-v 7</td><td>100</td><td>80~120</td><td>-q:a 7</td></tr><tr><td>-v 8</td><td>85</td><td>70~105</td><td>-q:a 8</td></tr><tr><td>-v 9</td><td>65</td><td>45~85</td><td>-q:a 9</td></tr></tbody></table><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -acodec libmp3lame -q:a 8 output.mp3</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-MP33.png" alt=""></p><hr><h1 id="使用平均码率编码参数-ABR"><a href="#使用平均码率编码参数-ABR" class="headerlink" title="使用平均码率编码参数 ABR"></a><strong>使用平均码率编码参数 ABR</strong></h1><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -acodec libmp3lame -b:a 64k -abr 1 output.mp3</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BE%93%E5%87%BA-MP34.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg 软编码 H264、H265</title>
    <link href="http://www.weichao.io/2018/05/27/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H265/"/>
    <id>http://www.weichao.io/2018/05/27/FFmpeg-软编码-H264、H265/</id>
    <published>2018-05-27T08:38:56.000Z</published>
    <updated>2018-05-27T08:47:25.948Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="x264"><a href="#x264" class="headerlink" title="x264"></a><strong>x264</strong></h1><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a><strong>参数</strong></h2><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>preset</td><td>字符串</td><td>编码器预设参数</td></tr><tr><td>tune</td><td>字符串</td><td>调优编码参数</td></tr><tr><td>profile</td><td>字符串</td><td>编码 profile 档级设置</td></tr><tr><td>level</td><td>字符串</td><td>编码 level 层级设置</td></tr><tr><td>wpredp</td><td>字符串</td><td>P 帧预测设置</td></tr><tr><td>x264opts</td><td>字符串</td><td>设置 x264 专有参数</td></tr><tr><td>crf</td><td>浮点数</td><td>选择质量恒定质量模式</td></tr><tr><td>crf_max</td><td>浮点数</td><td>选择质量恒定质量模式最大值</td></tr><tr><td>qp</td><td>整数</td><td>恒定量化参数控制</td></tr><tr><td>psy</td><td>浮点数</td><td>只用 psychovisual 优化</td></tr><tr><td>rc-lookahead</td><td>整数</td><td>设置预读帧设置</td></tr><tr><td>weightb</td><td>浮点数</td><td>B 帧预测设置</td></tr><tr><td>weightp</td><td>整数</td><td>设置预测分析方法：none、simple、smart 三种模式</td></tr><tr><td>ssim</td><td>布尔</td><td>计算打印 SSIM 状态</td></tr><tr><td>intra-refresh</td><td>布尔</td><td>定时刷 I 帧以替代 IDR 帧</td></tr><tr><td>bluray-compat</td><td>布尔</td><td>蓝光兼容参数</td></tr><tr><td>b-bias</td><td>整数</td><td>B 帧使用频率设置</td></tr><tr><td>mixed-refs</td><td>布尔</td><td>每个 partition 一个参考，而不是每个宏块一个参考</td></tr><tr><td>8x8dct</td><td>布尔</td><td>8x8 矩阵变换，用在 high profile</td></tr><tr><td>aud</td><td>布尔</td><td>带 AUD 分隔标识</td></tr><tr><td>mbtree</td><td>布尔</td><td>宏块树频率控制</td></tr><tr><td>deblock</td><td>字符串</td><td>环路滤波参数</td></tr><tr><td>cplxblur</td><td>浮点数</td><td>减少波动 QP 参数</td></tr><tr><td>partitions</td><td>字符串</td><td>逗号分隔的 partition 列表，可以包含的值有 p8x8、p4x4、b8x8、i8x8、i4x4、none、all</td></tr><tr><td>direct-pred</td><td>整数</td><td>运动向量预测模式</td></tr><tr><td>slice-max-size</td><td>整数</td><td>Slice 的最大值</td></tr><tr><td>nal-hrd</td><td>整数</td><td>HRD 信号信息设置：None、VBR、CBR 设置</td></tr><tr><td>motion-est</td><td>整数</td><td>运动估计方法</td></tr><tr><td>forced-idr</td><td>布尔</td><td>强行设置关键帧为 IDR 帧</td></tr><tr><td>coder</td><td>整数</td><td>编码器类型包括 default、cavlc、cabac、vlc、ac</td></tr><tr><td>b_strategy</td><td>整数</td><td>I/P/B 帧选择策略</td></tr><tr><td>chromaoffset</td><td>整数</td><td>QP 色度和亮度之间的差异参数</td></tr><tr><td>sc_threshold</td><td>整数</td><td>场景切换阈值参数</td></tr><tr><td>noise_reduction</td><td>整数</td><td>降噪处理参数</td></tr><tr><td>x264-params</td><td>字符串</td><td>与 x264opts 操作相同</td></tr></tbody></table><h3 id="preset"><a href="#preset" class="headerlink" title="preset"></a><strong>preset</strong></h3><h4 id="ultrafast"><a href="#ultrafast" class="headerlink" title="ultrafast"></a><strong>ultrafast</strong></h4><p>最快的编码方式。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -vcodec libx264 -preset ultrafast -b:v 2000k output.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2651.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2652.png" alt=""></p><h4 id="superfast"><a href="#superfast" class="headerlink" title="superfast"></a><strong>superfast</strong></h4><h4 id="veryfast"><a href="#veryfast" class="headerlink" title="veryfast"></a><strong>veryfast</strong></h4><h4 id="faster"><a href="#faster" class="headerlink" title="faster"></a><strong>faster</strong></h4><h4 id="fast"><a href="#fast" class="headerlink" title="fast"></a><strong>fast</strong></h4><h4 id="medium"><a href="#medium" class="headerlink" title="medium"></a><strong>medium</strong></h4><h4 id="slow"><a href="#slow" class="headerlink" title="slow"></a><strong>slow</strong></h4><h4 id="slower"><a href="#slower" class="headerlink" title="slower"></a><strong>slower</strong></h4><h4 id="veryslow"><a href="#veryslow" class="headerlink" title="veryslow"></a><strong>veryslow</strong></h4><h4 id="placebo"><a href="#placebo" class="headerlink" title="placebo"></a><strong>placebo</strong></h4><p>最慢的编码方式。</p><h3 id="tune"><a href="#tune" class="headerlink" title="tune"></a><strong>tune</strong></h3><p>在使用 FFmpeg 与 x264 进行 H264 直播编码并进行推流时，只用 tune 参数的 zerolatency 将会提升效率，因为其降低了因编码导致的延迟。</p><h4 id="zerolatency"><a href="#zerolatency" class="headerlink" title="zerolatency"></a><strong>zerolatency</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -vcodec libx264 -tune zerolatency -b:v 2000k output_tune_zerolatency.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2653.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2654.png" alt=""></p><h3 id="profile"><a href="#profile" class="headerlink" title="profile"></a><strong>profile</strong></h3><p>x264 共支持 7 种 profile。</p><table><thead><tr><th></th><th>Baseline</th><th>Extented</th><th>Main</th><th>High</th><th>High10</th><th>High4:2:2</th><th>High4:4:4（Predictive）</th></tr></thead><tbody><tr><td>I 与 P 分片</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>B 分片</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>SI 与 SP 分片</td><td>不支持</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr><td>多参考帧</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>环路去块滤波</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>CAVLC 熵编码</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>CABAC 熵编码</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>FMO</td><td>不支持</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr><td>ASO</td><td>不支持</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr><td>RS</td><td>不支持</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr><td>数据分区</td><td>支持</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr><td>场编码 PAFF/MBAFF</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>4:2:0 色度格式</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>4:0:0 色度格式</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>4:2:2 色度格式</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td></tr><tr><td>4:4:4 色度格式</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>8 位采样深度</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>9 和 10 位采样深度</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>11 至 14 位采样深度</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>8x8 与 4x4 转换适配</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>量化计算矩阵</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>分离 Cb 和 Cr 量化参数控制</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>分离色彩平面编码</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>分离无损编码</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td></tr></tbody></table><h3 id="level"><a href="#level" class="headerlink" title="level"></a><strong>level</strong></h3><table><tr><td rowspan="2"></td><td colspan="2">最大解码速度</td><td colspan="2">帧最大尺寸</td><td colspan="3">视频编码层最大码率</td><td rowspan="2">最大分辨率@最大帧率(最大存储帧数)切换其他细节</td></tr><tr><td>亮度采样</td><td>宏块</td><td>亮度采样</td><td>宏块</td><td>Baseline、Extended 和 Main Profile</td><td>High Profile</td><td>High 10 Profile</td></tr><tr><td>1</td><td>380160</td><td>1485</td><td>25344</td><td>99</td><td>64</td><td>80</td><td>192</td><td>128x96@30.9(8)<br>176x144@15.0(4)</td></tr><tr><td>1b</td><td>380160</td><td>1485</td><td>25344</td><td>99</td><td>128</td><td>160</td><td>384</td><td>128x96@30.9(8)<br>176x144@15.0(4)</td></tr><tr><td>1.1</td><td>768000</td><td>3000</td><td>101376</td><td>396</td><td>192</td><td>240</td><td>576</td><td>176x144@30.3(9)<br>320x240@10.0(3)<br>352x288@7.5(2)</td></tr><tr><td>1.2</td><td>1536000</td><td>6000</td><td>101376</td><td>396</td><td>384</td><td>480</td><td>1152</td><td>320x240@20.0(7)<br>352x288@15.2(6)</td></tr><tr><td>1.3</td><td>3041280</td><td>11880</td><td>101376</td><td>396</td><td>768</td><td>960</td><td>2304</td><td>320x240@36.0(7)<br>352x288@30.0(6)</td></tr><tr><td>2</td><td>3041280</td><td>11880</td><td>101376</td><td>396</td><td>2000</td><td>2500</td><td>6000</td><td>320x240@36.0(7)<br>352x288@30.0(6)</td></tr><tr><td>2.1</td><td>3041280</td><td>19800</td><td>202752</td><td>396</td><td>4000</td><td>5000</td><td>12000</td><td>352x480@30.0(7)<br>352x576@25.0(6)</td></tr><tr><td>2.2</td><td>5068800</td><td>20250</td><td>414720</td><td>1620</td><td>4000</td><td>5000</td><td>12000</td><td>352x480@30.7(12)<br>352x576@25.6(10)<br>720x480@15.0(6)<br>720x576@12.5(5)</td></tr><tr><td>3</td><td>5184000</td><td>40500</td><td>414720</td><td>1620</td><td>10000</td><td>12500</td><td>30000</td><td>352x480@61.4(12)<br>352x576@51.1(10)<br>720x480@30.0(6)<br>720x576@25.0(5)</td></tr><tr><td>3.1</td><td>10368000</td><td>108000</td><td>921600</td><td>3600</td><td>14000</td><td>17500</td><td>42000</td><td>720x480@80.0(13)<br>720x576@66.7(11)<br>1280x720@30.0(5)</td></tr><tr><td>3.2</td><td>27648000</td><td>216000</td><td>1310720</td><td>5120</td><td>20000</td><td>25000</td><td>60000</td><td>1280x720@60.0(5)<br>1280x1024@42.2(4)</td></tr><tr><td>4</td><td>55296000</td><td>245760</td><td>2097152</td><td>8192</td><td>20000</td><td>25000</td><td>60000</td><td>1280x720@68.3(9)<br>1920x1080@30.1(4)<br>2048x1024@30.0(4)</td></tr><tr><td>4.1</td><td>62914560</td><td>245760</td><td>2097152</td><td>8192</td><td>50000</td><td>62500</td><td>150000</td><td>1280x720@68.3(9)<br>1920x1080@30.1(4)<br>2048x1024@30.0(4)</td></tr><tr><td>4.2</td><td>133693440</td><td>522240</td><td>2228224</td><td>8740</td><td>50000</td><td>62500</td><td>150000</td><td>1280x720@145.1(9)<br>1920x1080@64.0(4)<br>2048x1080@60.0(4)</td></tr><tr><td>5</td><td>150994944</td><td>589824</td><td>5652480</td><td>22080</td><td>135000</td><td>168750</td><td>405000</td><td>1920x1080@72.3(13)<br>2048x1024@72.0(13)<br>2048x1080@67.8(12)<br>2560x1920@30.7(5)<br>3672x1536@26.7(5)</td></tr><tr><td>5.1</td><td>251658240</td><td>983040</td><td>9437184</td><td>36864</td><td>240000</td><td>300000</td><td>720000</td><td>1920x1080@120.5(16)<br>2560x1920@51.2(9)<br>3840x2160@31.7(5)<br>4096x2048@30.0(5)<br>4096x2160@28.5(5)<br>4096x2304@26.7(5)</td></tr><tr><td>5.2</td><td>530841600</td><td>2073600</td><td>9437184</td><td>36864</td><td>240000</td><td>300000</td><td>720000</td><td>1920x1080@172.0(16)<br>2560x1920@108.0(9)<br>3840x2160@66.8(5)<br>4096x2048@63.3(5)<br>4096x2160@60.0(5)<br>4096x2304@56.3(5)</td></tr></table><h4 id="生成-baseline-视频"><a href="#生成-baseline-视频" class="headerlink" title="生成 baseline 视频"></a><strong>生成 baseline 视频</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -vcodec libx264 -profile:v baseline -level 3.1 -s 352x288 -an -y -t 10 output_baseline.ts</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2655.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2656.png" alt=""></p><h4 id="生成-high-视频"><a href="#生成-high-视频" class="headerlink" title="生成 high 视频"></a><strong>生成 high 视频</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -vcodec libx264 -profile:v high -level 3.1 -s 352x288 -an -y -t 10 output_baseline.ts</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2657.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2658.png" alt=""></p><h3 id="sc-threshold"><a href="#sc-threshold" class="headerlink" title="sc_threshold"></a><strong>sc_threshold</strong></h3><p>在 FFmpeg 中，可以通过命令行的 -g 参数设置以帧数间隔为 GOP 的长度，但是当遇到场景切换时，例如从一个画面突然变成另外一个画面时，会强行插入一个关键帧，这时 GOP 的间隔将会重新开始。可以通过 sc_threshold 参数设置是否在场景切换时插入关键帧。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -c:v libx264 -g 50 -t 60 -sc_threshold 0 output_sc_threshold.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H2659.png" alt=""></p><h3 id="x264opts"><a href="#x264opts" class="headerlink" title="x264opts"></a><strong>x264opts</strong></h3><p>可以通过该参数设置 x264 内部私有参数，比如设置 I 帧、P 帧、B 帧的顺序及规律等。</p><h4 id="不允许-B-帧"><a href="#不允许-B-帧" class="headerlink" title="不允许 B 帧"></a><strong>不允许 B 帧</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -c:v libx264 -x264opts "bframes=0" -g 50 -sc_threshold 0 output_no_bframe.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H26510.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H26511.png" alt=""></p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H26512.png" alt=""></p><h4 id="每两个-P-帧之间存放-3-个-B-帧"><a href="#每两个-P-帧之间存放-3-个-B-帧" class="headerlink" title="每两个 P 帧之间存放 3 个 B 帧"></a><strong>每两个 P 帧之间存放 3 个 B 帧</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -c:v libx264 -x264opts "bframes=3:b-adapt=0" -g 50 -sc_threshold 0 output_pbframe.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H26513.png" alt=""></p><h3 id="nal-hrd"><a href="#nal-hrd" class="headerlink" title="nal-hrd"></a><strong>nal-hrd</strong></h3><p>编码可以设置为 VBR 或 CBR 模式，VBR 为可变码率，CBR 为恒定码率。<br>FFmpeg 可以通过参数 -b:v 指定视频的编码码率，但是设定的码率是平均码率，并不能很好的控制最大码率和最小码率的波动，如果需要控制最大码率和最小码率，则需要使用 FFmpeg 的三个参数 -b:v、maxrate、minrate。<br>同时，为了更好地控制编码时的波动，还可以设置编码时 buffer 的大小，buffer 的大小使用参数 -bufsize 设置即可，buffer 的设置不是越小越好，而是要设置得恰到好处。</p><p>比如设置 1M bit/s 码率，bufsize 为 50 KB。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.mp4 -c:v libx264 -x264opts "bframes=10:b-adapt=0" -b:v 1000k -maxrate 1000k -minrate 1000k -bufsize 50k -nal-hrd cbr -g 50 -sc_threshold 0 output_nal_hrd.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E8%BD%AF%E7%BC%96%E7%A0%81-H264%E3%80%81H26514.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>HLS 封装格式</title>
    <link href="http://www.weichao.io/2018/05/20/HLS-%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F/"/>
    <id>http://www.weichao.io/2018/05/20/HLS-封装格式/</id>
    <published>2018-05-20T15:06:13.000Z</published>
    <updated>2018-05-20T15:18:42.303Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="FFmpeg-转封装-HLS-可配置的参数"><a href="#FFmpeg-转封装-HLS-可配置的参数" class="headerlink" title="FFmpeg 转封装 HLS 可配置的参数"></a><strong>FFmpeg 转封装 HLS 可配置的参数</strong></h1><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>start_number</td><td>整数</td><td>设置 M3U8 列表中的第一片的序列数</td></tr><tr><td>hls_time</td><td>浮点数</td><td>设置每一片时长<br>该切片规则采用的方式是从关键帧处开始切片，所以时间不一定不均匀，如果先转码再进行切片，则时间会比较均匀；或者使用 hls_flags 的 split_by_time（可能导致花屏等问题，因为第一帧不一定为关键帧）</td></tr><tr><td>hls_list_size</td><td>整数</td><td>设置 M3U8 中分片的个数</td></tr><tr><td>hls_ts_options</td><td>字符串</td><td>设置 TS 切片的参数</td></tr><tr><td>hls_wrap</td><td>整数</td><td>设置切片索引回滚的边界值</td></tr><tr><td>hls_allow_cache</td><td>整数</td><td>设置 M3U8 中 EXT-X-ALLOW-CACHE 的标签</td></tr><tr><td>hls_base_url</td><td>字符串</td><td>设置 M3U8 中每一片的前置路径</td></tr><tr><td>hls_segment_filename</td><td>字符串</td><td>设置切片名模板</td></tr><tr><td>hls_key_info_file</td><td>字符串</td><td>设置 M3U8 加密的 key 文件路径</td></tr><tr><td>hls_subtitle_path</td><td>字符串</td><td>设置 M3U8 字幕路径</td></tr><tr><td>hls_flags</td><td>标签（整数）</td><td>设置 M3U8 文件列表的操作：<br>single_file：生成一个媒体文件索引与字节范围<br>delete_segments：删除 M3U8 文件中不包含的过期的 TS 切片文件<br>round_durations：生成的 M3U8 切片信息的 duration 为整数<br>discont_start：生成 M3U8 的时候在列表前边加上 discontinuity 标签<br>omit_endlist：在 M3U8 末尾不追加 endlist 标签</td></tr><tr><td>use_localtime</td><td>布尔</td><td>设置 M3U8 文件序号为本地时间戳</td></tr><tr><td>use_localtime_mkdir</td><td>布尔</td><td>根据本地时间戳生成目录</td></tr><tr><td>hls_playlist_type</td><td>整数</td><td>设置 M3U8 列表为事件或者点播列表</td></tr><tr><td>method</td><td>字符串</td><td>设置 HTTP 属性</td></tr></tbody></table><h1 id="FFmpeg-转封装-HLS"><a href="#FFmpeg-转封装-HLS" class="headerlink" title="FFmpeg 转封装 HLS"></a><strong>FFmpeg 转封装 HLS</strong></h1><h2 id="MP4-转封装-HLS（不加多余参数）"><a href="#MP4-转封装-HLS（不加多余参数）" class="headerlink" title="MP4 转封装 HLS（不加多余参数）"></a><strong>MP4 转封装 HLS（不加多余参数）</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.mp4 -c copy -f hls -bsf:v h264_mp4toannexb output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F1.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F2.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:10</div><div class="line">#EXT-X-MEDIA-SEQUENCE:10</div><div class="line">#EXTINF:9.800000,</div><div class="line">output10.ts</div><div class="line">#EXTINF:10.000000,</div><div class="line">output11.ts</div><div class="line">#EXTINF:5.280000,</div><div class="line">output12.ts</div><div class="line">#EXTINF:10.000000,</div><div class="line">output13.ts</div><div class="line">#EXTINF:2.000000,</div><div class="line">output14.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output14.ts</p><h2 id="FLV-转封装-HLS"><a href="#FLV-转封装-HLS" class="headerlink" title="FLV 转封装 HLS"></a><strong>FLV 转封装 HLS</strong></h2><p><code>-bsf:v h264_mp4toannexb</code> 的作用是将 MP4 中的 H264 编码格式的数据转换为 H264AnnexB 编码格式的数据，AnnexB 编码格式常见于实时传输流中。如果源文件为 FLV、TS 等可作为直播传输流的视频，则不需要这个参数。</p><h3 id="不加多余参数"><a href="#不加多余参数" class="headerlink" title="不加多余参数"></a><strong>不加多余参数</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F3.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F4.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6.000000,</div><div class="line">output18.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output19.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">output20.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output21.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output22.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output22.ts</p><h3 id="start-number"><a href="#start-number" class="headerlink" title="start_number"></a><strong>start_number</strong></h3><p>比如设置 M3U8 列表中的第一片的序列数为 100。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -start_number 100 output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F5.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F6.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:118</div><div class="line">#EXTINF:6.000000,</div><div class="line">output118.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output119.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">output120.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output121.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output122.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output100.ts～output122.ts</p><h3 id="hls-time"><a href="#hls-time" class="headerlink" title="hls_time"></a><strong>hls_time</strong></h3><p>比如设置每片长度为 10 秒。<br>该切片规则采用的方式是从关键帧处开始切片，所以时间不一定不均匀，如果先转码再进行切片，则时间会比较均匀；或者使用 hls_flags 的 split_by_time。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_time 10 output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F7.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F8.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:12</div><div class="line">#EXT-X-MEDIA-SEQUENCE:8</div><div class="line">#EXTINF:11.200000,</div><div class="line">output8.ts</div><div class="line">#EXTINF:5.520000,</div><div class="line">output9.ts</div><div class="line">#EXTINF:12.000000,</div><div class="line">output10.ts</div><div class="line">#EXTINF:7.200000,</div><div class="line">output11.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output12.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output12.ts</p><h3 id="hls-list-size"><a href="#hls-list-size" class="headerlink" title="hls_list_size"></a><strong>hls_list_size</strong></h3><p>比如设置 M3U8 列表中 TS 切片的个数为 3。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_list_size 3 output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F9.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F10.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:20</div><div class="line">#EXTINF:1.200000,</div><div class="line">output20.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output21.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output22.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output22.ts</p><h3 id="hls-wrap"><a href="#hls-wrap" class="headerlink" title="hls_wrap"></a><strong>hls_wrap</strong></h3><p>比如设置 M3U8 列表中 TS 分片序号大于 2 时回滚为 0。<br><strong>注意：该参数对 CDN 支持不友好，会引起兼容性问题，新版本会被弃用。</strong></p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_wrap 3 output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F11.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F12.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6.000000,</div><div class="line">output0.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output1.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">output2.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output0.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output1.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output2.ts</p><h3 id="hls-base-url"><a href="#hls-base-url" class="headerlink" title="hls_base_url"></a><strong>hls_base_url</strong></h3><p>设置 M3U8 列表中的文件路径。<br>该路径可以为本地绝对路径、相对路径、网络路径（比如<code>http://192.168.0.1/live/</code>）。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_base_url /home/weichao/ output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F13.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F14.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6.000000,</div><div class="line">/home/weichao/output18.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">/home/weichao/output19.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">/home/weichao/output20.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">/home/weichao/output21.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">/home/weichao/output22.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output22.ts</p><h3 id="hls-segment-filename"><a href="#hls-segment-filename" class="headerlink" title="hls_segment_filename"></a><strong>hls_segment_filename</strong></h3><p>比如设置 M3U8 列表切片文件名以 live 开头。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_segment_filename live-%d.ts output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F15.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F16.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6.000000,</div><div class="line">live-18.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">live-19.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">live-20.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">live-21.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">live-22.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>live-0.ts～live-22.ts</p><h3 id="hls-flags"><a href="#hls-flags" class="headerlink" title="hls_flags"></a><strong>hls_flags</strong></h3><h4 id="delete-segments"><a href="#delete-segments" class="headerlink" title="delete_segments"></a><strong>delete_segments</strong></h4><p>删除旧文件（以 hls_list_size 的 2 倍作为删除的依据）。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_flags delete_segments output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F17.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F18.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6.000000,</div><div class="line">output18.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output19.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">output20.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output21.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output22.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output17.ts～output22.ts</p><h4 id="round-durations"><a href="#round-durations" class="headerlink" title="round_durations"></a><strong>round_durations</strong></h4><p>实现切片信息的 duration 为整型。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_flags round_durations output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F19.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F20.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6,</div><div class="line">output18.ts</div><div class="line">#EXTINF:6,</div><div class="line">output19.ts</div><div class="line">#EXTINF:1,</div><div class="line">output20.ts</div><div class="line">#EXTINF:6,</div><div class="line">output21.ts</div><div class="line">#EXTINF:6,</div><div class="line">output22.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output22.ts</p><h4 id="discont-start"><a href="#discont-start" class="headerlink" title="discont_start"></a><strong>discont_start</strong></h4><p>输出的 M3U8 在第一片<strong>（后续会刷掉）</strong> TS 信息的前面有一个 EXT-X-DISCONTINUTY 标签。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_flags discont_start output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F21.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:0</div><div class="line">#EXT-X-DISCONTINUITY</div><div class="line">#EXTINF:6.000000,</div><div class="line">output0.ts</div><div class="line">#EXTINF:5.760000,</div><div class="line">output1.ts</div><div class="line">#EXTINF:4.760000,</div><div class="line">output2.ts</div><div class="line">#EXTINF:5.600000,</div><div class="line">output3.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output22.ts</p><h4 id="omit-endlist"><a href="#omit-endlist" class="headerlink" title="omit_endlist"></a><strong>omit_endlist</strong></h4><p>生成 M3U8 结束后不在文件末尾追加 endlist 标签。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_flags omit_endlist output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F23.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F24.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6.000000,</div><div class="line">output18.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output19.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">output20.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output21.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output22.ts</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output22.ts</p><h4 id="split-by-time"><a href="#split-by-time" class="headerlink" title="split_by_time"></a><strong>split_by_time</strong></h4><p>更精确地设置每一片时长<strong>（可能导致花屏等问题，因为第一帧不一定为关键帧）</strong>。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -hls_time 10 -hls_flags split_by_time output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F25.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F26.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:10</div><div class="line">#EXT-X-MEDIA-SEQUENCE:8</div><div class="line">#EXTINF:9.960000,</div><div class="line">output8.ts</div><div class="line">#EXTINF:10.000000,</div><div class="line">output9.ts</div><div class="line">#EXTINF:9.920000,</div><div class="line">output10.ts</div><div class="line">#EXTINF:10.080000,</div><div class="line">output11.ts</div><div class="line">#EXTINF:6.480000,</div><div class="line">output12.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>output0.ts～output12.ts</p><h3 id="use-localtime"><a href="#use-localtime" class="headerlink" title="use_localtime"></a><strong>use_localtime</strong></h3><p>以时间戳为切片文件名。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f hls -use_localtime 1 output.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F27.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/HLS%20%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F28.png" alt=""></p><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-TARGETDURATION:6</div><div class="line">#EXT-X-MEDIA-SEQUENCE:18</div><div class="line">#EXTINF:6.000000,</div><div class="line">output-1526809032.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output-1526809038.ts</div><div class="line">#EXTINF:1.200000,</div><div class="line">output-1526809044.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output-1526809046.ts</div><div class="line">#EXTINF:6.000000,</div><div class="line">output-1526809052.ts</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><p>22 个 output-时间戳.ts</p><h3 id="method"><a href="#method" class="headerlink" title="method"></a><strong>method</strong></h3><p>将 M3U8 及 TS 文件上传至 HTTP 服务器。</p><h4 id="配置-Nginx"><a href="#配置-Nginx" class="headerlink" title="配置 Nginx"></a><strong>配置 Nginx</strong></h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TODO</div></pre></td></tr></table></figure><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a><strong>测试</strong></h4><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.flv -c copy -f hls -method PUT http://127.0.0.1/test/output_test.m3u8</div></pre></td></tr></table></figure><p>2、输出结果：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TODO</div></pre></td></tr></table></figure><p>3、输出的 M3U8 文件的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TODO</div></pre></td></tr></table></figure><p>4、生成的 ts 文件：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TODO</div></pre></td></tr></table></figure><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MP4 封装格式</title>
    <link href="http://www.weichao.io/2018/05/16/MP4-%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F/"/>
    <id>http://www.weichao.io/2018/05/16/MP4-封装格式/</id>
    <published>2018-05-16T15:57:15.000Z</published>
    <updated>2018-05-17T14:57:24.002Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li><li><a href="https://www.cnblogs.com/CoderTian/p/8277965.html" title="https://www.cnblogs.com/CoderTian/p/8277965.html" target="_blank" rel="external">Mp4文件格式解析</a></li><li><a href="https://blog.csdn.net/wenmang1977/article/details/7736238" title="https://blog.csdn.net/wenmang1977/article/details/7736238" target="_blank" rel="external">ffmpeg demux mp4</a></li></ul><hr><h1 id="MP4-的-box-树"><a href="#MP4-的-box-树" class="headerlink" title="MP4 的 box 树"></a><strong>MP4 的 box 树</strong></h1><p><img src="http://otkw6sse5.bkt.clouddn.com/MP4-%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F1.png" alt=""></p><p>MP4 常用参考标准排列方式：</p><table><thead><tr><th>一级</th><th>二级</th><th>三级</th><th>四级</th><th>五级</th><th>六级</th><th>必须性</th><th>说明</th></tr></thead><tbody><tr><td>ftyp</td><td></td><td></td><td></td><td></td><td></td><td>是</td><td>文件类型</td></tr><tr><td>pdin</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>下载进度信息</td></tr><tr><td>moov</td><td></td><td></td><td></td><td></td><td></td><td>是</td><td>音视频数据的 metadata 信息<br>如果希望在视频点播中 MP4 被快速打开，则需要将 moov 存放在 mdat 前面<br>如果放在后面，则需要将 MP4 下载完才可以播放</td></tr><tr><td></td><td>mvhd</td><td></td><td></td><td></td><td></td><td>是</td><td>电影文件头</td></tr><tr><td></td><td>trak</td><td></td><td></td><td></td><td></td><td>是</td><td>流的 track</td></tr><tr><td></td><td></td><td>tkhd</td><td></td><td></td><td></td><td>是</td><td>流的 track 头</td></tr><tr><td></td><td></td><td>tref</td><td></td><td></td><td></td><td>否</td><td>track 参考容器</td></tr><tr><td></td><td></td><td>edts</td><td></td><td></td><td></td><td>否</td><td>edit list 容器</td></tr><tr><td></td><td></td><td></td><td>elst</td><td></td><td></td><td>否</td><td>edit list 元素信息</td></tr><tr><td></td><td></td><td>mdia</td><td></td><td></td><td></td><td>是</td><td>track 里面的 media 信息</td></tr><tr><td></td><td></td><td></td><td>mdhd</td><td></td><td></td><td>是</td><td>media 信息头</td></tr><tr><td></td><td></td><td></td><td>hdlr</td><td></td><td></td><td>是</td><td>media 信息的句柄</td></tr><tr><td></td><td></td><td></td><td>minf</td><td></td><td></td><td>是</td><td>media 信息容器</td></tr><tr><td></td><td></td><td></td><td></td><td>vmhd</td><td></td><td>否</td><td>视频 media 头（只存在于视频的 track）</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>smhd</td><td>否</td><td>音频 media 头（只存在于音频的 track）</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>hmhd</td><td>否</td><td>提示 media 头（只存在于提示的 track）</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>nmhd</td><td>否</td><td>空 media 头（其他的 track）</td></tr><tr><td></td><td></td><td></td><td></td><td>dinf</td><td></td><td>是</td><td>数据信息容器</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>dref</td><td>是</td><td>数据参考容器，track 中 media 的参考信息</td></tr><tr><td></td><td></td><td></td><td></td><td>stbl</td><td></td><td>是</td><td>采样表容器，容器做时间与数据所在位置的描述</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stsd</td><td>是</td><td>采样描述（codec 类型与初始化信息）</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stts</td><td>是</td><td>（decoding）采样时间</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>ctts</td><td>否</td><td>（composition）采样时间</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stsc</td><td>是</td><td>chunk 采样，数据片段信息</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stsz</td><td>否</td><td>采样大小</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stz2</td><td>否</td><td>采样大小详细描述</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stco</td><td>是</td><td>chunk 偏移信息，数据偏移信息</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>co64</td><td>否</td><td>64 位 chunk 偏移信息</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stss</td><td>否</td><td>同步采样表</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stsh</td><td>否</td><td>采样同步表</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>padb</td><td>否</td><td>采样 padding</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>stdp</td><td>否</td><td>采样退化优先描述</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>sdtp</td><td>否</td><td>独立于可支配采样描述</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>sbgp</td><td>否</td><td>采样组</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>sgpd</td><td>否</td><td>采样组描述</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>subs</td><td>否</td><td>子采样信息</td></tr><tr><td></td><td>mvex</td><td></td><td></td><td></td><td></td><td>否</td><td>视频扩展容器</td></tr><tr><td></td><td></td><td>mehd</td><td></td><td></td><td></td><td>否</td><td>视频扩展容器头</td></tr><tr><td></td><td></td><td>trex</td><td></td><td></td><td></td><td>是</td><td>track 扩展信息</td></tr><tr><td></td><td>ipmc</td><td></td><td></td><td></td><td></td><td>否</td><td>IPMP 控制容器</td></tr><tr><td>moof</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>视频分片</td></tr><tr><td></td><td>mfhd</td><td></td><td></td><td></td><td></td><td>是</td><td>视频分片头</td></tr><tr><td></td><td>traf</td><td></td><td></td><td></td><td></td><td>否</td><td>track 分片</td></tr><tr><td></td><td></td><td>tfhd</td><td></td><td></td><td></td><td>是</td><td>track 分片头</td></tr><tr><td></td><td></td><td>trun</td><td></td><td></td><td></td><td>否</td><td>track 分片 run 信息</td></tr><tr><td></td><td></td><td>sdtp</td><td></td><td></td><td></td><td>否</td><td>独立和可支配的采样</td></tr><tr><td></td><td></td><td>sbgp</td><td></td><td></td><td></td><td>否</td><td>采样组</td></tr><tr><td></td><td></td><td>subs</td><td></td><td></td><td></td><td>否</td><td>子采样信息</td></tr><tr><td>mfra</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>视频分片访问控制信息</td></tr><tr><td></td><td>tfra</td><td></td><td></td><td></td><td></td><td>否</td><td>track 分片访问控制信息</td></tr><tr><td></td><td>mfro</td><td></td><td></td><td></td><td></td><td>是</td><td>拼分片访问控制偏移量</td></tr><tr><td>mdat</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>media 数据容器</td></tr><tr><td>free</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>空闲区域</td></tr><tr><td>skip</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>空闲区域</td></tr><tr><td></td><td>udta</td><td></td><td></td><td></td><td></td><td>否</td><td>用户数据</td></tr><tr><td></td><td></td><td>cprt</td><td></td><td></td><td></td><td>否</td><td>copyright 信息</td></tr><tr><td>meta</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>元数据</td></tr><tr><td></td><td>hdlr</td><td></td><td></td><td></td><td></td><td>是</td><td>定义元数据的句柄</td></tr><tr><td></td><td>dinf</td><td></td><td></td><td></td><td></td><td>否</td><td>数据信息容器</td></tr><tr><td></td><td></td><td>dref</td><td></td><td></td><td></td><td>否</td><td>元数据的源参考信息</td></tr><tr><td></td><td>ipmc</td><td></td><td></td><td></td><td></td><td>否</td><td>IPMP 控制容器</td></tr><tr><td></td><td>iloc</td><td></td><td></td><td></td><td></td><td>否</td><td>所在位置信息容器</td></tr><tr><td></td><td>ipro</td><td></td><td></td><td></td><td></td><td>否</td><td>样本保护容器</td></tr><tr><td></td><td></td><td>sinf</td><td></td><td></td><td></td><td>否</td><td>计划信息保护容器</td></tr><tr><td></td><td></td><td></td><td>frma</td><td></td><td></td><td>否</td><td>原格式容器</td></tr><tr><td></td><td></td><td></td><td>imif</td><td></td><td></td><td>否</td><td>IPMP 信息容器</td></tr><tr><td></td><td></td><td></td><td>schm</td><td></td><td></td><td>否</td><td>计划类型容器</td></tr><tr><td></td><td></td><td></td><td>schi</td><td></td><td></td><td>否</td><td>计划信息容器</td></tr><tr><td></td><td>iinf</td><td></td><td></td><td></td><td></td><td>否</td><td>容器所在项目信息</td></tr><tr><td></td><td>xml</td><td></td><td></td><td></td><td></td><td>否</td><td>XML 容器</td></tr><tr><td></td><td>bxml</td><td></td><td></td><td></td><td></td><td>否</td><td>binary XML 容器</td></tr><tr><td></td><td>pitm</td><td></td><td></td><td></td><td></td><td>否</td><td>主要参考容器</td></tr><tr><td></td><td>fiin</td><td></td><td></td><td></td><td></td><td>否</td><td>文件发送信息</td></tr><tr><td></td><td></td><td>paen</td><td></td><td></td><td></td><td>否</td><td>partition 入口</td></tr><tr><td></td><td></td><td></td><td>fpar</td><td></td><td></td><td>否</td><td>文件片段容器</td></tr><tr><td></td><td></td><td></td><td>fecr</td><td></td><td></td><td>否</td><td>FEC reservoir</td></tr><tr><td></td><td></td><td>segr</td><td></td><td></td><td></td><td>否</td><td>文件发送 session 组信息</td></tr><tr><td></td><td></td><td>gitn</td><td></td><td></td><td></td><td>否</td><td>组 id 转名称信息</td></tr><tr><td></td><td></td><td>tsel</td><td></td><td></td><td></td><td>否</td><td>track 选择信息</td></tr><tr><td>meco</td><td></td><td></td><td></td><td></td><td></td><td>否</td><td>追加的 metadata 信息</td></tr><tr><td></td><td>mere</td><td></td><td></td><td></td><td></td><td>否</td><td>metabox 关系</td></tr></tbody></table><p>一个 box 是由 box header 和 box 里面包含的数据组成。</p><h2 id="box-header"><a href="#box-header" class="headerlink" title="box header"></a><strong>box header</strong></h2><p>box header 中包含了 box 的大小（size）和类型（type）等信息。<br>其中，size 指明了整个 box 所占用的大小（包括 header 部分）：<br>（1）size = 0 表示该 box 是最后一个 box；<br>（2）如果 box 很大（例如存放具体视频数据的 mdat box），超过了 uint32 的最大数值，size 就被设置为 1，并用接下来的 uint64 的 largesize 来存放大小。<br>type = uuid 表示该 box 中的数据是用户自定义扩展类型。<br>box 中的字节序为网络字节序，也就是大端字节序（Big-Endian）。</p><p>box 根据 header 部分包含的信息的不同可以分为 Box 和 Full Box：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/MP4-%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F2.png" alt=""></p><p>Box 定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">aligned(8) class Box (unsigned int(32) boxtype, optional unsigned int(8)[16] extended_type) </div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> size</span>;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> type </span>= boxtype;</div><div class="line">    <span class="keyword">if</span> (size==<span class="number">1</span>) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> largesize</span>;</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (size==<span class="number">0</span>) </div><div class="line">    &#123;</div><div class="line">        <span class="comment">// box extends to end of file</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (boxtype==‘uuid’) </div><div class="line">    &#123;</div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">8</span>)[<span class="number">16</span>] usertype = extended_type;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Full Box 定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">aligned(8) class FullBox(unsigned int(32) boxtype, unsigned int(8) v, bit(24) f) extends Box(boxtype) </div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">8</span>)</span> version </span>= v;</div><div class="line">    bit(<span class="number">24</span>) flags = f;</div><div class="line">&#125;</div></pre></td></tr></table></figure><hr><h1 id="box-介绍"><a href="#box-介绍" class="headerlink" title="box 介绍"></a><strong>box 介绍</strong></h1><h2 id="ftyp（File-Type）"><a href="#ftyp（File-Type）" class="headerlink" title="ftyp（File Type）"></a><strong>ftyp（File Type）</strong></h2><p>文件层 box，有且只有在文件最开始有一个，用于表明文件类型。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class FileTypeBox extends <span class="title">Box</span><span class="params">(‘ftyp’)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> major_brand</span>;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> minor_version</span>;</div><div class="line">    unsigned int(32) compatible_brands[]; // to end of the box</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="free（Free-Space）"><a href="#free（Free-Space）" class="headerlink" title="free（Free Space）"></a><strong>free（Free Space）</strong></h2><p>free box 中的内容是无关紧要的，可以被忽略。该 box 被删除后，不会对播放产生任何影响，它的 type 域可以是 free 或 skip。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class FreeSpaceBox extends <span class="title">Box</span><span class="params">(free_type)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    unsigned int(8) data[];</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="mdat（Media-Data）"><a href="#mdat（Media-Data）" class="headerlink" title="mdat（Media Data）"></a><strong>mdat（Media Data）</strong></h2><p>文件层 box，可以有多个，也可以没有（当媒体数据全部为外部文件引用时），用于存储媒体数据。</p><p>数据直接跟在 box type 字段后面，它的结构是由 metadata 来描述的，metadata 通过文件中的绝对偏移来引用媒体数据。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class MediaDataBox extends <span class="title">Box</span><span class="params">(‘mdat’)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    bit(<span class="number">8</span>) data[];</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="moov（Movie）"><a href="#moov（Movie）" class="headerlink" title="moov（Movie）"></a><strong>moov（Movie）</strong></h2><p>文件层 box，有且只有一个，用于存放媒体信息，至少包含以下三种中的一个：<br>（1）mvhd：存放未压缩过的电影信息；<br>（2）cmov：存放压缩过的电影信息；<br>（3）rmra：存放参考电影信息。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class MovieBox extends <span class="title">Box</span><span class="params">(‘moov’)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>moov</td></tr></tbody></table><h3 id="mvhd（Movie-Header）"><a href="#mvhd（Movie-Header）" class="headerlink" title="mvhd（Movie Header）"></a><strong>mvhd（Movie Header）</strong></h3><p>用于存放文件的总体信息，如时长和创建时间等。它是独立于媒体的，并且与整个播放相关。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class MovieHeaderBox extends <span class="title">FullBox</span><span class="params">(‘mvhd’, version, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span> (version==<span class="number">1</span>) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> creation_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> modification_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> timescale</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> duration</span>;</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> </div><div class="line">    &#123; <span class="comment">// version==0</span></div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>) creation_time;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> modification_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> timescale</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> duration</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> rate </span>= <span class="number">0x00010000</span>; <span class="comment">// typically 1.0</span></div><div class="line">    <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> volume </span>= <span class="number">0x0100</span>; <span class="comment">// typically, full volume</span></div><div class="line">    <span class="function"><span class="keyword">const</span> <span class="title">bit</span><span class="params">(<span class="number">16</span>)</span> reserved </span>= <span class="number">0</span>;</div><div class="line">    const unsigned int(32)[2] reserved = 0;</div><div class="line">    <span class="comment">// Unity matrix</span></div><div class="line">    template int(32)[9] matrix = &#123; 0x00010000,0,0,0,0x00010000,0,0,0,0x40000000 &#125;;</div><div class="line">    bit(<span class="number">32</span>)[<span class="number">6</span>] pre_defined = <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> next_track_ID</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>mvhd</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 0</td></tr><tr><td>creation_time</td><td>4</td><td>起始时间，基准时间是 1904-1-1 0:00 AM</td></tr><tr><td>modification_time</td><td>4</td><td>修订时间，基准时间是 1904-1-1 0:00 AM</td></tr><tr><td>timescale</td><td>4</td><td>时间计算单位，就像系统时间单位换为 60 秒一样</td></tr><tr><td>duration</td><td>4</td><td>通过这个值可以得到影片的播放长度时间值</td></tr><tr><td>rate</td><td>4</td><td>播放速度，1.0 为正常播放速度（16.16 的浮点表示）</td></tr><tr><td>volume</td><td>2</td><td>播放音量，1.0 为最大音量（8.8 的浮点表示）</td></tr><tr><td>reserved</td><td>10</td><td>保留，这里是 0</td></tr><tr><td>matrix</td><td>36</td><td>该矩阵定义了两个坐标空间的映射关系</td></tr><tr><td>预览时间</td><td>4</td><td>开始预览的时间</td></tr><tr><td>预览 duration</td><td>4</td><td>以 time scale 为单位，预览的 duration</td></tr><tr><td>poster time</td><td>4</td><td>poster 的时间值</td></tr><tr><td>selection time</td><td>4</td><td>当前选择时间的开始时间值</td></tr><tr><td>selection duration</td><td>4</td><td>当前选择时间的计算后的时间值</td></tr><tr><td>当前时间</td><td>4</td><td>当前时间</td></tr><tr><td>next_track_ID</td><td>4</td><td>下一个待添加 track 的 ID 值，0 不是一个有效的 ID 值</td></tr></tbody></table><h3 id="iods（Initial-Object-Descriptor）"><a href="#iods（Initial-Object-Descriptor）" class="headerlink" title="iods（Initial Object Descriptor）"></a><strong>iods（Initial Object Descriptor）</strong></h3><h3 id="trak（Track）"><a href="#trak（Track）" class="headerlink" title="trak（Track）"></a><strong>trak（Track）</strong></h3><p>trak box 是一个 container box，其子 box 包含了该 track 的媒体数据引用和描述（流媒体协议的打包信息 hint track 除外，其可以引用或复制对应的媒体采样数据）。一个 MP4 文件中的媒体有一个或多个 track，这些 track 之间彼此独立，有自己的时间和空间信息。trak box 必须包含一个 tkhd box 和一个 mdia box。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class TrackBox extends <span class="title">Box</span><span class="params">(‘trak’)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>trak</td></tr></tbody></table><h4 id="tkhd（Track-Header）"><a href="#tkhd（Track-Header）" class="headerlink" title="tkhd（Track Header）"></a><strong>tkhd（Track Header）</strong></h4><p>包含了该 track 的特性和总体信息，如时长，宽高等。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class TrackHeaderBox extends <span class="title">FullBox</span><span class="params">(‘tkhd’, version, flags)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span> (version==<span class="number">1</span>) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> creation_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> modification_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> track_ID</span>;</div><div class="line">        <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> reserved </span>= <span class="number">0</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> duration</span>;</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> </div><div class="line">    &#123; <span class="comment">// version==0</span></div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>) creation_time;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> modification_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> track_ID</span>;</div><div class="line">        <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> reserved </span>= <span class="number">0</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> duration</span>;</div><div class="line">    &#125;</div><div class="line">    const unsigned int(32)[2] reserved = 0;</div><div class="line">    <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> layer </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> alternate_group </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> volume </span>= &#123;<span class="keyword">if</span> track_is_audio <span class="number">0x0100</span> <span class="keyword">else</span> <span class="number">0</span>&#125;;</div><div class="line">    <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> reserved </span>= <span class="number">0</span>;</div><div class="line">    <span class="comment">// unity matrix</span></div><div class="line">    template int(32)[9] matrix= &#123; 0x00010000,0,0,0,0x00010000,0,0,0,0x40000000 &#125;;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> width</span>;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> height</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>tkhd</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>有效的标志：<br>0x0001：track 生效<br>0x0002：track 被用在 Movie 中<br>0x0003：track 被用在 Movie 预览中<br>0x0004：track 被用在 Movie 的 poster 中</td></tr><tr><td>creation_time</td><td>4</td><td>起始时间，基准时间是 1904-1-1 0:00 AM</td></tr><tr><td>modification_time</td><td>4</td><td>修订时间，基准时间是 1904-1-1 0:00 AM</td></tr><tr><td>track_ID</td><td>4</td><td>唯一标志该 track 的一个非零值</td></tr><tr><td>reserved</td><td>4</td><td>这里为 0</td></tr><tr><td>duration</td><td>4</td><td>track 的 duration，在电影的时间戳中。与 track 的 edts list 进行的时间戳会建立关联，然后进行时间戳计算，得到对应的 track 的播放时间坐标</td></tr><tr><td>reserved</td><td>8</td><td>这里为 0</td></tr><tr><td>layer</td><td>2</td><td>视频层，默认为 0，值小的在上层</td></tr><tr><td>alternate_group</td><td>2</td><td>track 分组信息，默认为 0，表示该 track 未与其他 track 有群组关系</td></tr><tr><td>volume</td><td>2</td><td>播放此 track 的音量。1.0 为正常音量</td></tr><tr><td>reserved</td><td>2</td><td>这里为 0</td></tr><tr><td>matrix</td><td>36</td><td>该矩阵定义了两个坐标空间的映射关系</td></tr><tr><td>width</td><td>4</td><td>如果该 track 是 video track，那么此值为图像的宽度（16.16 浮点表示）</td></tr><tr><td>height</td><td>4</td><td>如果该 track 是 video track，那么此值为图像的高度（16.16 浮点表示）</td></tr></tbody></table><h4 id="mdia（Media）"><a href="#mdia（Media）" class="headerlink" title="mdia（Media）"></a><strong>mdia（Media）</strong></h4><p>包含了该 track 的媒体信息，比如媒体类型和 sample 信息。其必须包含：<br>（1）一个媒体头 mdhd；<br>（2）一个句柄参考 hdlr；<br>（3）一个媒体信息 minf 和 udta。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class MediaBox extends <span class="title">Box</span><span class="params">(‘mdia’)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>mdia</td></tr></tbody></table><h5 id="mdhd（Media-Header）"><a href="#mdhd（Media-Header）" class="headerlink" title="mdhd（Media Header）"></a><strong>mdhd（Media Header）</strong></h5><p>包含了该 track 的总体信息，mdhd 和 tkhd 内容大致都是一样的。tkhd 通常是对指定的 track 设定相关属性和内容，而 mdhd 是针对于独立的 media 来设置的，一般情况下二者相同。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class MediaHeaderBox extends <span class="title">FullBox</span><span class="params">(‘mdhd’, version, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span> (version==<span class="number">1</span>) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> creation_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> modification_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> timescale</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> duration</span>;</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> </div><div class="line">    &#123; </div><div class="line">        <span class="comment">// version==0</span></div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span>(<span class="number">32</span>) creation_time;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> modification_time</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> timescale</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> duration</span>;</div><div class="line">    &#125;</div><div class="line">    bit(<span class="number">1</span>) pad = <span class="number">0</span>;</div><div class="line">    unsigned int(5)[3] language; // ISO-639-2/T language code</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> pre_defined </span>= <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>mdhd</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 0</td></tr><tr><td>creation_time</td><td>4</td><td>起始时间，基准时间是 1904-1-1 0:00 AM</td></tr><tr><td>modification_time</td><td>4</td><td>修订时间，基准时间是 1904-1-1 0:00 AM</td></tr><tr><td>timescale</td><td>4</td><td>时间计算单位，就像系统时间单位换为 60 秒一样</td></tr><tr><td>duration</td><td>4</td><td>通过这个值可以得到影片的播放长度时间值</td></tr><tr><td>language</td><td>2</td><td>媒体的语言码</td></tr><tr><td>质量</td><td>2</td><td>媒体的回放质量</td></tr></tbody></table><h5 id="hdlr（Handler-Reference）"><a href="#hdlr（Handler-Reference）" class="headerlink" title="hdlr（Handler Reference）"></a><strong>hdlr（Handler Reference）</strong></h5><p>解释了媒体的播放过程信息，该 box 也可以被包含在 meta box（meta）中。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class HandlerBox extends <span class="title">FullBox</span><span class="params">(‘hdlr’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> pre_defined </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> handler_type</span>;</div><div class="line">    const unsigned int(32)[3] reserved = 0;</div><div class="line">    <span class="built_in">string</span> name;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>hdlr</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 0</td></tr><tr><td>handler_type</td><td>4</td><td>有效的 handle 类型：<br>（1）mhlr：media handlers<br>（2）dhlr：data handlers</td></tr><tr><td>component_type</td><td>4</td><td>media handler 或 data handler 的类型。如果 component type 是 mhlr，那么这个字段定义的就是数据的类型，例如，vide 是 video 数据，soun 是 sound 数据；如果 component type 是 dhlr，那么这个字段定义的就是数据引用的类型，例如，alis 是文件的别名</td></tr><tr><td>reserved</td><td>12</td><td>保留字段，默认为 0</td></tr><tr><td>name</td><td>可变</td><td>这个 component 的名字，也就是生成此 media 的 media handler。该字段的长度可以为 0</td></tr></tbody></table><h5 id="minf（Media-Information）"><a href="#minf（Media-Information）" class="headerlink" title="minf（Media Information）"></a><strong>minf（Media Information）</strong></h5><p>minf box 包含了所有描述该 track 中的媒体信息的对象，信息存储在其子 box 中。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class MediaInformationBox extends <span class="title">Box</span><span class="params">(‘minf’)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h6 id="vmhd（Video-Media-Information-Header）"><a href="#vmhd（Video-Media-Information-Header）" class="headerlink" title="vmhd（Video Media Information Header）"></a><strong>vmhd（Video Media Information Header）</strong></h6><p>用在视频 track 中，包含当前 track 的视频描述信息（如视频编码等信息）。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class VideoMediaHeaderBox extends <span class="title">FullBox</span><span class="params">(‘vmhd’, version = <span class="number">0</span>, <span class="number">1</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">template</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> graphicsmode </span>= <span class="number">0</span>; <span class="comment">// copy, see below</span></div><div class="line">    template unsigned int(16)[3] opcolor = &#123;0, 0, 0&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>vmhd</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 1</td></tr><tr><td>graphicsmode</td><td>2</td><td>传输模式，传输模式指定的布尔值</td></tr><tr><td>opcolor</td><td>6</td><td>颜色值，RGB 颜色值</td></tr></tbody></table><h6 id="smhd（Sound-Media-Information-Header）"><a href="#smhd（Sound-Media-Information-Header）" class="headerlink" title="smhd（Sound Media Information Header）"></a><strong>smhd（Sound Media Information Header）</strong></h6><p>用在音频 track 中，包含当前 track 的音频描述信息（如编码格式等信息）。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class SoundMediaHeaderBox extends <span class="title">FullBox</span><span class="params">(‘smhd’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">template</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> balance </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> reserved </span>= <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>smhd</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 0</td></tr><tr><td>balance</td><td>2</td><td>音频的均衡是用来控制计算机的两个扬声器的声音混合效果，一般是 0</td></tr><tr><td>reserved</td><td>2</td><td>保留字段，默认为 0</td></tr></tbody></table><h6 id="dinf（Data-Information）"><a href="#dinf（Data-Information）" class="headerlink" title="dinf（Data Information）"></a><strong>dinf（Data Information）</strong></h6><p>用于解释如何定位媒体信息，是一个 container box。dinf box 一般包含一个 dref box，即 data reference box。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class DataInformationBox extends <span class="title">Box</span><span class="params">(‘dinf’)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>dinf</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 0</td></tr><tr><td>条目数目</td><td>4</td><td>data reference 的数目</td></tr></tbody></table><p>####### <strong>dref（Data Reference）</strong></p><p>用于设置当前 Box 描述信息的 data_entry，dref box 下会包含若干个 url 或 urn，这些 box 组成一个表，用于定位 track 数据。简单的说，track 可以被分成若干段，每一段都可以根据 url 或 urn 指向的地址来获取数据，sample 描述中会用这些片段的序号将这些片段组成一个完整的 track。一般情况下，当数据被完全包含在文件中时，url 或 urn 中的定位字符串是空的。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">aligned(8) class DataEntryUrlBox (bit(24) flags) extends FullBox(‘url ’, version = 0, flags)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">string</span> location;</div><div class="line">&#125;</div><div class="line">aligned(8) class DataEntryUrnBox (bit(24) flags) extends FullBox(‘urn ’, version = 0, flags) </div><div class="line">&#123;</div><div class="line">    <span class="built_in">string</span> name;</div><div class="line">    <span class="built_in">string</span> location;</div><div class="line">&#125;</div><div class="line">aligned(<span class="number">8</span>) <span class="function">class DataReferenceBox extends <span class="title">FullBox</span><span class="params">(‘dref’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= entry_count; i++) </div><div class="line">    &#123;</div><div class="line">        DataEntryBox(entry_version, entry_flags) data_entry;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>url/alis/rsrc</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 1</td></tr><tr><td>数据</td><td>可变</td><td>data reference 的信息</td></tr></tbody></table><h6 id="stbl（Sample-Table）"><a href="#stbl（Sample-Table）" class="headerlink" title="stbl（Sample Table）"></a><strong>stbl（Sample Table）</strong></h6><p>包含转化媒体时间到实际的 sample 的信息，例如，视频数据是否需要被解压缩、解压缩算法是什么等信息。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class SampleTableBox extends <span class="title">Box</span><span class="params">(‘stbl’)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>####### <strong>stsd</strong></p><p>box header 和 version 字段后会有一个 entry count 字段，根据 entry 的个数，每个 entry 会有 type 信息，如 vide、sund 等，根据 type 不同 sample description 会提供不同的信息，例如对于 video track，会有 VisualSampleEntry 类型信息，对于 audio track 会有 AudioSampleEntry 类型信息。视频的编码类型、宽高、长度，音频的声道、采样等信息都会出现在这个 box 中。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">aligned(8) abstract class SampleEntry (unsigned int(32) format) extends Box(format)</div><div class="line">&#123;</div><div class="line">    const unsigned int(8)[6] reserved = 0;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">16</span>)</span> data_reference_index</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">aligned(8) class SampleDescriptionBox (unsigned int(32) handler_type) extends FullBox('stsd', version, 0)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> i ;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</div><div class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= entry_count ; i++)</div><div class="line">    &#123;</div><div class="line">        SampleEntry(); <span class="comment">// an instance of a class derived from SampleEntry</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>######## <strong>esds（Element Stream Descriptors）</strong></p><p>存放 Element Stream Descriptors。</p><p>参数：</p><table><thead><tr><th>字段</th><th>长度/字节</th><th>说明</th></tr></thead><tbody><tr><td>size</td><td>4</td><td>字节数</td></tr><tr><td>type</td><td>4</td><td>esds</td></tr><tr><td>version</td><td>1</td><td>版本</td></tr><tr><td>flags</td><td>3</td><td>扩展的标志，这里是 0</td></tr><tr><td>数据</td><td>可变</td><td>数据</td></tr></tbody></table><p>####### <strong>stts</strong></p><p>stts box 存储了 sample 的 duration，描述了 sample 时序的映射方法，我们通过它可以找到任何时间的 sample。stts box 可以包含一个压缩的表来映射时间和 sample 序号，用其他的表来提供每个 sample 的长度和指针。表中每个条目提供了在同一个时间偏移量里面连续的 sample 序号，以及 samples 的偏移量。递增这些偏移量，就可以建立一个完整的 time to sample 表（时间戳到 sample 序号的映射表）。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class TimeToSampleBox extends <span class="title">FullBox</span><span class="params">(’stts’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; entry_count; i++) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_count</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_delta</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>####### <strong>stsz</strong></p><p>stsz 定义了每个 sample 的大小，包含了媒体中全部 sample 的数目和一张给出每个 sample 大小的表。这个 box 相对来说体积是比较大的。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class SampleSizeBox extends <span class="title">FullBox</span><span class="params">(‘stsz’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_size</span>;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_count</span>;</div><div class="line">    <span class="keyword">if</span> (sample_size==<span class="number">0</span>) </div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= sample_count; i++) </div><div class="line">        &#123;</div><div class="line">            <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_size</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>####### <strong>stsc</strong></p><p>用 chunk 组织 sample 可以方便优化数据获取，一个 thunk 包含一个或多个 sample。stsc 中用一个表描述了 sample 与 chunk 的映射关系，查看这张表就可以找到包含指定 sample 的 thunk，从而找到这个 sample。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class SampleToChunkBox extends <span class="title">FullBox</span><span class="params">(‘stsc’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= entry_count; i++) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> first_chunk</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> samples_per_chunk</span>;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_description_index</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>####### <strong>stco</strong></p><p>stco 定义了每个 thunk 在媒体流中的位置，sample 的偏移可以根据其他 box 推算出来。位置有两种可能，32 位的和 64 位的，后者对非常大的电影很有用。在一个表中只会有一种可能，这个位置是在整个文件中的，而不是在任何 box 中的，这样做就可以直接在文件中找到媒体数据，而不用解释 box。需要注意的是一旦前面的 box 有了任何改变，这张表都要重新建立，因为位置信息已经改变了。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class ChunkOffsetBox extends <span class="title">FullBox</span><span class="params">(‘stco’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= entry_count; i++) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> chunk_offset</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">aligned(<span class="number">8</span>) <span class="function">class ChunkLargeOffsetBox extends <span class="title">FullBox</span><span class="params">(‘co64’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>; i &lt;= entry_count; i++) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">64</span>)</span> chunk_offset</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>####### <strong>stss</strong></p><p>stss 确定 media 中的关键帧。对于压缩媒体数据，关键帧是一系列压缩序列的开始帧，其解压缩时不依赖以前的帧，而后续帧的解压缩将依赖于这个关键帧。stss 可以非常紧凑的标记媒体内的随机存取点，它包含一个 sample 序号表，表内的每一项严格按照 sample 的序号排列，说明了媒体中的哪一个 sample 是关键帧。如果此表不存在，说明每一个 sample 都是一个关键帧，是一个随机存取点。</p><p>定义：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">aligned(<span class="number">8</span>) <span class="function">class SyncSampleBox extends <span class="title">FullBox</span><span class="params">(‘stss’, version = <span class="number">0</span>, <span class="number">0</span>)</span> </span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> entry_count</span>;</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; entry_count; i++) </div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">unsigned</span> <span class="title">int</span><span class="params">(<span class="number">32</span>)</span> sample_number</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>####### <strong>sdtp（Sample Degradation Priority）</strong></p><h3 id="udta（User-Data）"><a href="#udta（User-Data）" class="headerlink" title="udta（User Data）"></a><strong>udta（User Data）</strong></h3><h4 id="meta（Metadata）"><a href="#meta（Metadata）" class="headerlink" title="meta（Metadata）"></a><strong>meta（Metadata）</strong></h4><h5 id="ilst（未确定用途）"><a href="#ilst（未确定用途）" class="headerlink" title="ilst（未确定用途）"></a><strong>ilst（未确定用途）</strong></h5><hr><h1 id="将-MP4-文件按字节转十六进制"><a href="#将-MP4-文件按字节转十六进制" class="headerlink" title="将 MP4 文件按字节转十六进制"></a><strong>将 MP4 文件按字节转十六进制</strong></h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Changer</span> </span>&#123;</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] subBytes(<span class="keyword">byte</span>[] src, <span class="keyword">int</span> begin, <span class="keyword">int</span> count) &#123;</div><div class="line"><span class="keyword">byte</span>[] bs = <span class="keyword">new</span> <span class="keyword">byte</span>[count];</div><div class="line">System.arraycopy(src, begin, bs, <span class="number">0</span>, count);</div><div class="line"><span class="keyword">return</span> bs;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">converHexStr</span><span class="params">(<span class="keyword">byte</span>[] bytes)</span> </span>&#123;</div><div class="line">StringBuffer stringBuffer = <span class="keyword">new</span> StringBuffer();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, size = bytes.length, halfSize = size &gt;&gt; <span class="number">1</span>; i &lt; size; i++) &#123;</div><div class="line"><span class="keyword">if</span> (i == halfSize) &#123;</div><div class="line">stringBuffer.append(<span class="string">" "</span>);<span class="comment">// 从中间区分出来</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> ((bytes[i] &amp; <span class="number">0xff</span>) &lt; <span class="number">0x10</span>) &#123;</div><div class="line">stringBuffer.append(<span class="string">"0"</span>);<span class="comment">// 补0</span></div><div class="line">&#125;</div><div class="line">stringBuffer.append(Long.toString(bytes[i] &amp; <span class="number">0xff</span>, <span class="number">16</span>) + <span class="string">" "</span>);<span class="comment">// 转十六进制</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> stringBuffer.toString().trim();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">convertUtf8Str</span><span class="params">(<span class="keyword">byte</span>[] bytes)</span> </span>&#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line"><span class="keyword">byte</span>[] newBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[bytes.length];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, size = bytes.length; i &lt; size; i++) &#123;</div><div class="line"><span class="keyword">if</span> (bytes[i] &lt; <span class="number">32</span> || bytes[i] &gt; <span class="number">126</span>) &#123;</div><div class="line">newBytes[i] = <span class="number">0x20</span>;<span class="comment">// 不识别的使用空格代替</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">newBytes[i] = bytes[i];</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="keyword">new</span> String(newBytes, <span class="string">"utf-8"</span>);</div><div class="line">&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</div><div class="line"><span class="comment">// TODO Auto-generated catch block</span></div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">File inFile = <span class="keyword">new</span> File(<span class="string">"d:/sample.mp4"</span>);</div><div class="line">File outFile = <span class="keyword">new</span> File(<span class="string">"d:/sample.txt"</span>);</div><div class="line"></div><div class="line">DecimalFormat format = <span class="keyword">new</span> DecimalFormat(<span class="string">"00000000"</span>);</div><div class="line"><span class="keyword">int</span> line = <span class="number">0</span>;</div><div class="line"><span class="comment">// int count = 0;</span></div><div class="line"></div><div class="line">InputStream in = <span class="keyword">null</span>;</div><div class="line">PrintWriter out = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[bufferSize];</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">in = <span class="keyword">new</span> FileInputStream(inFile);</div><div class="line">out = <span class="keyword">new</span> PrintWriter(outFile);</div><div class="line"><span class="keyword">int</span> len;</div><div class="line"><span class="keyword">while</span> ((len = in.read(bytes)) != -<span class="number">1</span>) &#123;</div><div class="line"><span class="comment">// count++;</span></div><div class="line"><span class="comment">// System.out.println("count: " + count);</span></div><div class="line"><span class="comment">// if (len &lt; bufferSize) &#123;</span></div><div class="line"><span class="comment">// System.out.println("查询到最后一次");</span></div><div class="line"><span class="comment">// &#125;</span></div><div class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line"><span class="keyword">for</span> (; i &lt; len; i += lineSize) &#123;</div><div class="line">line++;</div><div class="line"><span class="keyword">byte</span>[] subBytes = subBytes(bytes, i, lineSize);</div><div class="line">out.write(</div><div class="line">format.format(line) + <span class="string">"    "</span> + converHexStr(subBytes) + <span class="string">"    "</span> + convertUtf8Str(subBytes));</div><div class="line">out.write(<span class="string">"\r\n"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">out.flush();</div><div class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line"><span class="comment">// TODO Auto-generated catch block</span></div><div class="line">e.printStackTrace();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line"><span class="comment">// TODO Auto-generated catch block</span></div><div class="line">e.printStackTrace();</div><div class="line">&#125; <span class="keyword">finally</span> &#123;</div><div class="line"><span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">in.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line"><span class="comment">// TODO Auto-generated catch block</span></div><div class="line">e.printStackTrace();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><hr><h1 id="实际-MP4-文件的-box-树"><a href="#实际-MP4-文件的-box-树" class="headerlink" title="实际 MP4 文件的 box 树"></a><strong>实际 MP4 文件的 box 树</strong></h1><h2 id="ftyp"><a href="#ftyp" class="headerlink" title="ftyp"></a><strong>ftyp</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00000001    00 00 00 1c 66 74 79 70  6d 70 34 32 00 00 00 00        ftypmp42    </div><div class="line">00000002    6d 70 34 32 69 73 6f 6d  61 76 63 31                mp42isomavc1</div></pre></td></tr></table></figure><h2 id="free"><a href="#free" class="headerlink" title="free"></a><strong>free</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">00000002                                         00 00 00 84    </div><div class="line">00000003    66 72 65 65 00 00 00 00  00 00 00 00 00 00 00 00    free            </div><div class="line">00000004    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00000005    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00000006    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00000007    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00000008    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00000009    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00000010    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div></pre></td></tr></table></figure><h2 id="mdat"><a href="#mdat" class="headerlink" title="mdat"></a><strong>mdat</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">00000011    00 05 cb e8 6d 64 61 74  00 00 02 09 06 05 ff ff        mdat        </div><div class="line">00000012    05 dc 45 e9 bd e6 d9 48  b7 96 2c d8 20 d9 23 ee      E    H  ,   # </div><div class="line">00000013    ef 78 32 36 34 20 2d 20  63 6f 72 65 20 37 39 20     x264 - core 79 </div><div class="line">.</div><div class="line">（内容超多，会导致编辑器渲染时间过长，此处省略）</div><div class="line">.</div><div class="line">00023751    37 e5 dd ef 14 00 00 00  00 00 ff 13 e0 34 f6 58    7            4 X</div><div class="line">00023752    00 00 00 00 00 fe ed d2  ff 74 00 00 1e dc 77 00             t    w </div><div class="line">00023753    00 00 00 00 00 00 03 80</div></pre></td></tr></table></figure><h2 id="moov"><a href="#moov" class="headerlink" title="moov"></a><strong>moov</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div></pre></td><td class="code"><pre><div class="line">00023753                             00 00 0d 83 6d 6f 6f 76                moov</div><div class="line">00023754    00 00 00 6c 6d 76 68 64  00 00 00 00 c7 ca ee a7       lmvhd        </div><div class="line">00023755    c7 ca ee a8 00 01 5f 90  00 07 a5 80 00 01 00 00          _         </div><div class="line">00023756    01 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023757    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023758    00 00 00 00 00 00 00 00  00 00 00 00 40 00 00 00                @   </div><div class="line">00023759    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023760    00 00 00 00 00 00 00 00  00 00 00 03 00 00 00 18                    </div><div class="line">00023761    69 6f 64 73 00 00 00 00  10 80 80 80 07 00 4f ff    iods          O </div><div class="line">00023762    ff 0f 7f ff 00 00 06 0a  74 72 61 6b 00 00 00 5c            trak   \</div><div class="line">00023763    74 6b 68 64 00 00 00 01  c7 ca ee a7 c7 ca ee a8    tkhd            </div><div class="line">00023764    00 00 00 01 00 00 00 00  00 07 99 50 00 00 00 00               P    </div><div class="line">00023765    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023766    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023767    00 00 00 00 00 00 00 00  00 00 00 00 40 00 00 00                @   </div><div class="line">00023768    02 30 00 00 01 40 00 00  00 00 05 a6 6d 64 69 61     0   @      mdia</div><div class="line">00023769    00 00 00 20 6d 64 68 64  00 00 00 00 c7 ca ee a7        mdhd        </div><div class="line">00023770    c7 ca ee a8 00 01 5f 90  00 07 99 50 55 c4 00 00          _    PU   </div><div class="line">00023771    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023772    76 69 64 65 00 00 00 00  00 00 00 00 00 00 00 00    vide            </div><div class="line">00023773    00 00 00 05 5d 6d 69 6e  66 00 00 00 14 76 6d 68        ]minf    vmh</div><div class="line">00023774    64 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00    d               </div><div class="line">00023775    24 64 69 6e 66 00 00 00  1c 64 72 65 66 00 00 00    $dinf    dref   </div><div class="line">00023776    00 00 00 00 01 00 00 00  0c 75 72 6c 20 00 00 00             url    </div><div class="line">00023777    01 00 00 05 1d 73 74 62  6c 00 00 00 ab 73 74 73         stbl    sts</div><div class="line">00023778    64 00 00 00 00 00 00 00  01 00 00 00 9b 61 76 63    d            avc</div><div class="line">00023779    31 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00    1               </div><div class="line">00023780    00 00 00 00 00 00 00 00  00 02 30 01 40 00 48 00              0 @ H </div><div class="line">00023781    00 00 48 00 00 00 00 00  00 00 01 0e 4a 56 54 2f      H         JVT/</div><div class="line">00023782    41 56 43 20 43 6f 64 69  6e 67 00 00 00 00 00 00    AVC Coding      </div><div class="line">00023783    00 00 00 00 00 00 00 00  00 00 00 00 18 ff ff 00                    </div><div class="line">00023784    00 00 33 61 76 63 43 01  42 c0 1e ff e1 00 1b 67      3avcC B      g</div><div class="line">00023785    42 c0 1e 9e 21 81 18 53  4d 40 40 40 50 00 00 03    B   !  SM@@@P   </div><div class="line">00023786    00 10 00 00 03 03 c8 f1  62 ee 01 00 05 68 ce 06            b    h  </div><div class="line">00023787    cb 20 00 00 00 12 63 6f  6c 72 6e 63 6c 63 00 01          colrnclc  </div><div class="line">00023788    00 01 00 01 00 00 00 18  73 74 74 73 00 00 00 00            stts    </div><div class="line">00023789    00 00 00 01 00 00 00 a6  00 00 0b b8 00 00 02 ac                    </div><div class="line">00023790    73 74 73 7a 00 00 00 00  00 00 00 00 00 00 00 a6    stsz            </div><div class="line">00023791    00 00 56 27 00 00 0b 20  00 00 05 bc 00 00 05 e2      V'            </div><div class="line">00023792    00 00 05 c1 00 00 04 37  00 00 04 07 00 00 03 b6           7        </div><div class="line">00023793    00 00 06 45 00 00 03 73  00 00 05 12 00 00 03 26       E   s       &amp;</div><div class="line">00023794    00 00 02 e9 00 00 03 7b  00 00 03 4a 00 00 03 6b           &#123;   J   k</div><div class="line">00023795    00 00 02 b6 00 00 03 4c  00 00 02 7a 00 00 02 c7           L   z    </div><div class="line">00023796    00 00 02 2e 00 00 03 16  00 00 02 26 00 00 02 7f       .       &amp;    </div><div class="line">00023797    00 00 01 ec 00 00 01 ea  00 00 01 f5 00 00 01 eb                    </div><div class="line">00023798    00 00 01 fa 00 00 01 e7  00 00 01 fc 00 00 01 dd                    </div><div class="line">00023799    00 00 01 c6 00 00 01 ae  00 00 01 c8 00 00 01 b9                    </div><div class="line">00023800    00 00 01 90 00 00 01 93  00 00 01 8c 00 00 01 da                    </div><div class="line">00023801    00 00 01 c2 00 00 05 d0  00 00 07 b8 00 00 06 7a                   z</div><div class="line">00023802    00 00 09 a9 00 00 0a 2c  00 00 0a 7c 00 00 0c b3           ,   |    </div><div class="line">00023803    00 00 09 8c 00 00 09 52  00 00 0c 04 00 00 0d c1           R        </div><div class="line">00023804    00 00 0f 74 00 00 10 48  00 00 11 06 00 00 10 61       t   H       a</div><div class="line">00023805    00 00 0c 63 00 00 0c 31  00 00 0b 42 00 00 0c 0d       c   1   B    </div><div class="line">00023806    00 00 0f 32 00 00 0a 7b  00 00 0d 0f 00 00 0a e0       2   &#123;        </div><div class="line">00023807    00 00 0a 0e 00 00 0b 6b  00 00 08 74 00 00 0c 36           k   t   6</div><div class="line">00023808    00 00 09 e6 00 00 06 8d  00 00 04 f8 00 00 07 8a                    </div><div class="line">00023809    00 00 07 c1 00 00 09 f3  00 00 07 c7 00 00 0a cb                    </div><div class="line">00023810    00 00 0a d2 00 00 0b 74  00 00 0c 28 00 00 0a 9a           t   (    </div><div class="line">00023811    00 00 0c 60 00 00 0d 6d  00 00 0c 3e 00 00 0f fc       `   m   &gt;    </div><div class="line">00023812    00 00 0e 82 00 00 0b 79  00 00 0d e4 00 00 0d 24           y       $</div><div class="line">00023813    00 00 0a 17 00 00 11 aa  00 00 12 65 00 00 0d 7b               e   &#123;</div><div class="line">00023814    00 00 12 a0 00 00 13 d8  00 00 11 49 00 00 0e 59               I   Y</div><div class="line">00023815    00 00 10 15 00 00 16 81  00 00 09 b4 00 00 06 eb                    </div><div class="line">00023816    00 00 05 ef 00 00 05 8a  00 00 03 d7 00 00 04 0d                    </div><div class="line">00023817    00 00 03 bb 00 00 04 6b  00 00 03 40 00 00 03 30           k   @   0</div><div class="line">00023818    00 00 02 de 00 00 03 ae  00 00 05 cf 00 00 04 6c                   l</div><div class="line">00023819    00 00 05 69 00 00 05 00  00 00 06 a1 00 00 03 35       i           5</div><div class="line">00023820    00 00 04 1a 00 00 03 fa  00 00 06 3d 00 00 05 d6               =    </div><div class="line">00023821    00 00 04 68 00 00 02 d6  00 00 04 b5 00 00 02 d9       h            </div><div class="line">00023822    00 00 02 7f 00 00 02 4d  00 00 02 7d 00 00 03 8c           M   &#125;    </div><div class="line">00023823    00 00 02 06 00 00 02 01  00 00 07 7f 00 00 05 ef                    </div><div class="line">00023824    00 00 05 b8 00 00 04 0a  00 00 02 99 00 00 03 1d                    </div><div class="line">00023825    00 00 07 c5 00 00 05 ac  00 00 04 78 00 00 08 71               x   q</div><div class="line">00023826    00 00 08 99 00 00 08 e9  00 00 08 99 00 00 05 73                   s</div><div class="line">00023827    00 00 07 c7 00 00 08 3d  00 00 0b 59 00 00 0a 36           =   Y   6</div><div class="line">00023828    00 00 06 ba 00 00 05 f9  00 00 07 2e 00 00 06 eb               .    </div><div class="line">00023829    00 00 04 c6 00 00 04 ba  00 00 05 66 00 00 04 31               f   1</div><div class="line">00023830    00 00 06 8a 00 00 06 cf  00 00 06 fe 00 00 04 97                    </div><div class="line">00023831    00 00 02 43 00 00 03 e2  00 00 04 06 00 00 02 e6       C            </div><div class="line">00023832    00 00 02 6b 00 00 02 75  00 00 00 28 73 74 73 63       k   u   (stsc</div><div class="line">00023833    00 00 00 00 00 00 00 02  00 00 00 01 00 00 00 04                    </div><div class="line">00023834    00 00 00 01 00 00 00 2a  00 00 00 02 00 00 00 01           *        </div><div class="line">00023835    00 00 00 b8 73 74 63 6f  00 00 00 00 00 00 00 2a        stco       *</div><div class="line">00023836    00 00 00 a8 00 00 73 e6  00 00 8b f4 00 00 a4 08          s         </div><div class="line">00023837    00 00 b7 64 00 00 c8 a5  00 00 d7 d8 00 00 e4 a5       d            </div><div class="line">00023838    00 00 ec 5f 00 00 f8 5f  00 01 04 41 00 01 1f c3       _   _   A    </div><div class="line">00023839    00 01 51 85 00 01 84 7e  00 01 cc a6 00 02 03 c0      Q    ~        </div><div class="line">00023840    00 02 3c 52 00 02 66 75  00 02 8a 1c 00 02 b4 a6      &lt;R  fu        </div><div class="line">00023841    00 02 e7 66 00 03 23 01  00 03 5d ac 00 03 9e 97       f  #   ]     </div><div class="line">00023842    00 03 ea 64 00 04 26 0a  00 04 3e 69 00 04 4c ff       d  &amp;   &gt;i  L </div><div class="line">00023843    00 04 63 d9 00 04 7e 43  00 04 98 9b 00 04 ad a9      c   ~C        </div><div class="line">00023844    00 04 be f7 00 04 d7 94  00 04 ed 6c 00 05 0e 3b               l   ;</div><div class="line">00023845    00 05 2d c9 00 05 59 f0  00 05 7b 82 00 05 95 2b      -   Y   &#123;    +</div><div class="line">00023846    00 05 b3 da 00 05 c6 67  00 00 00 14 73 74 73 73           g    stss</div><div class="line">00023847    00 00 00 00 00 00 00 01  00 00 00 01 00 00 00 b2                    </div><div class="line">00023848    73 64 74 70 00 00 00 00  04 44 44 44 44 44 44 44    sdtp     DDDDDDD</div><div class="line">00023849    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023850    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023851    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023852    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023853    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023854    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023855    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023856    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023857    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023858    44 44 44 44 44 44 44 44  44 44 44 44 44 44 00 00    DDDDDDDDDDDDDD  </div><div class="line">00023859    06 7e 74 72 61 6b 00 00  00 5c 74 6b 68 64 00 00     ~trak   \tkhd  </div><div class="line">00023860    00 03 c7 ca ee a7 c7 ca  ee a8 00 00 00 02 00 00                    </div><div class="line">00023861    00 00 00 07 a5 80 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023862    00 00 01 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023863    00 00 00 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023864    00 00 00 00 00 00 40 00  00 00 00 00 00 00 00 00          @         </div><div class="line">00023865    00 00 00 00 06 04 6d 64  69 61 00 00 00 20 6d 64          mdia    md</div><div class="line">00023866    68 64 00 00 00 00 c7 ca  ee a7 c7 ca ee a8 00 00    hd              </div><div class="line">00023867    bb 80 00 04 14 00 15 c7  00 00 00 00 00 21 68 64                 !hd</div><div class="line">00023868    6c 72 00 00 00 00 00 00  00 00 73 6f 75 6e 00 00    lr        soun  </div><div class="line">00023869    00 00 00 00 00 00 00 00  00 00 00 00 00 05 bb 6d                   m</div><div class="line">00023870    69 6e 66 00 00 00 10 73  6d 68 64 00 00 00 00 00    inf    smhd     </div><div class="line">00023871    00 00 00 00 00 00 24 64  69 6e 66 00 00 00 1c 64          $dinf    d</div><div class="line">00023872    72 65 66 00 00 00 00 00  00 00 01 00 00 00 0c 75    ref            u</div><div class="line">00023873    72 6c 20 00 00 00 01 00  00 05 7f 73 74 62 6c 00    rl         stbl </div><div class="line">00023874    00 00 67 73 74 73 64 00  00 00 00 00 00 00 01 00      gstsd         </div><div class="line">00023875    00 00 57 6d 70 34 61 00  00 00 00 00 00 00 01 00      Wmp4a         </div><div class="line">00023876    00 00 00 00 00 00 00 00  01 00 10 00 00 00 00 bb                    </div><div class="line">00023877    80 00 00 00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02 00 00  00 18 73 74 74 73 00 00              stts  </div><div class="line">00023881    00 00 00 00 00 01 00 00  01 05 00 00 04 00 00 00                    </div><div class="line">00023882    04 28 73 74 73 7a 00 00  00 00 00 00 00 00 00 00     (stsz          </div><div class="line">00023883    01 05 00 00 00 f7 00 00  00 db 00 00 00 e1 00 00                    </div><div class="line">00023884    00 e5 00 00 00 e9 00 00  00 e8 00 00 00 f0 00 00                    </div><div class="line">00023885    00 f1 00 00 00 ef 00 00  00 d8 00 00 00 e6 00 00                    </div><div class="line">00023886    00 e7 00 00 00 e9 00 00  00 eb 00 00 00 ea 00 00                    </div><div class="line">00023887    00 e8 00 00 00 e1 00 00  00 e7 00 00 00 d7 00 00                    </div><div class="line">00023888    00 da 00 00 00 d9 00 00  00 db 00 00 00 e9 00 00                    </div><div class="line">00023889    00 ee 00 00 00 e5 00 00  00 e1 00 00 00 e6 00 00                    </div><div class="line">00023890    00 e5 00 00 00 d8 00 00  00 dd 00 00 00 dd 00 00                    </div><div class="line">00023891    00 d5 00 00 00 ea 00 00  00 dd 00 00 00 d0 00 00                    </div><div class="line">00023892    00 d6 00 00 00 e9 00 00  00 bc 00 00 00 ab 00 00                    </div><div class="line">00023893    00 b3 00 00 00 b5 00 00  00 bc 00 00 00 ce 00 00                    </div><div class="line">00023894    00 b4 00 00 00 b6 00 00  00 b3 00 00 00 b6 00 00                    </div><div class="line">00023895    00 b7 00 00 00 bf 00 00  00 b7 00 00 00 cd 00 00                    </div><div class="line">00023896    00 c1 00 00 00 ba 00 00  00 a7 00 00 00 b4 00 00                    </div><div class="line">00023897    00 b1 00 00 00 be 00 00  00 d0 00 00 00 ba 00 00                    </div><div class="line">00023898    00 bc 00 00 00 c4 00 00  00 c6 00 00 00 cb 00 00                    </div><div class="line">00023899    00 c4 00 00 00 c3 00 00  00 c8 00 00 00 d2 00 00                    </div><div class="line">00023900    00 d2 00 00 00 d6 00 00  00 f5 00 00 00 fa 00 00                    </div><div class="line">00023901    00 f6 00 00 01 02 00 00  00 fc 00 00 00 fc 00 00                    </div><div class="line">00023902    00 ee 00 00 00 e6 00 00  00 ea 00 00 00 ea 00 00                    </div><div class="line">00023903    00 e8 00 00 00 de 00 00  00 df 00 00 00 e7 00 00                    </div><div class="line">00023904    00 f6 00 00 00 ff 00 00  01 03 00 00 00 f6 00 00                    </div><div class="line">00023905    01 08 00 00 01 03 00 00  00 fd 00 00 01 05 00 00                    </div><div class="line">00023906    01 02 00 00 01 00 00 00  01 14 00 00 01 18 00 00                    </div><div class="line">00023907    00 fd 00 00 00 fb 00 00  01 11 00 00 01 05 00 00                    </div><div class="line">00023908    01 05 00 00 01 0a 00 00  01 01 00 00 00 f3 00 00                    </div><div class="line">00023909    00 f7 00 00 00 f7 00 00  01 01 00 00 01 02 00 00                    </div><div class="line">00023910    00 f8 00 00 00 f8 00 00  00 ef 00 00 00 ed 00 00                    </div><div class="line">00023911    00 e3 00 00 00 ec 00 00  00 e2 00 00 00 e8 00 00                    </div><div class="line">00023912    00 dc 00 00 00 e0 00 00  00 f3 00 00 00 df 00 00                    </div><div class="line">00023913    00 e1 00 00 00 cf 00 00  00 ce 00 00 00 d8 00 00                    </div><div class="line">00023914    00 ce 00 00 00 c7 00 00  00 cd 00 00 00 b7 00 00                    </div><div class="line">00023915    00 af 00 00 00 c8 00 00  00 d7 00 00 00 e5 00 00                    </div><div class="line">00023916    00 e4 00 00 00 c6 00 00  00 d1 00 00 00 d5 00 00                    </div><div class="line">00023917    00 e5 00 00 00 d8 00 00  00 c8 00 00 00 be 00 00                    </div><div class="line">00023918    00 bf 00 00 00 cb 00 00  00 d2 00 00 00 c8 00 00                    </div><div class="line">00023919    00 ca 00 00 00 b1 00 00  00 a3 00 00 00 c7 00 00                    </div><div class="line">00023920    00 dc 00 00 00 d9 00 00  00 dd 00 00 00 d1 00 00                    </div><div class="line">00023921    00 d2 00 00 00 c2 00 00  00 bc 00 00 00 b1 00 00                    </div><div class="line">00023922    00 9b 00 00 00 89 00 00  00 a2 00 00 00 9f 00 00                    </div><div class="line">00023923    00 b5 00 00 00 a6 00 00  00 b2 00 00 00 b5 00 00                    </div><div class="line">00023924    00 ae 00 00 00 b4 00 00  00 b0 00 00 00 c6 00 00                    </div><div class="line">00023925    00 c3 00 00 00 d5 00 00  00 e4 00 00 00 f6 00 00                    </div><div class="line">00023926    00 d6 00 00 00 db 00 00  00 cc 00 00 00 e7 00 00                    </div><div class="line">00023927    00 f9 00 00 00 cb 00 00  00 d8 00 00 00 d6 00 00                    </div><div class="line">00023928    00 e4 00 00 00 f1 00 00  00 e4 00 00 00 e6 00 00                    </div><div class="line">00023929    00 df 00 00 00 ee 00 00  00 d7 00 00 00 c7 00 00                    </div><div class="line">00023930    00 e7 00 00 00 f9 00 00  00 ed 00 00 00 cf 00 00                    </div><div class="line">00023931    00 f1 00 00 00 e6 00 00  00 dc 00 00 00 e4 00 00                    </div><div class="line">00023932    00 ef 00 00 00 e5 00 00  00 f1 00 00 00 e3 00 00                    </div><div class="line">00023933    00 ec 00 00 00 ec 00 00  00 f3 00 00 00 f5 00 00                    </div><div class="line">00023934    00 fd 00 00 01 0b 00 00  01 10 00 00 01 11 00 00                    </div><div class="line">00023935    01 03 00 00 01 01 00 00  00 fb 00 00 00 fa 00 00                    </div><div class="line">00023936    00 e7 00 00 00 e5 00 00  00 f0 00 00 00 d2 00 00                    </div><div class="line">00023937    00 e5 00 00 00 f3 00 00  00 f1 00 00 00 f2 00 00                    </div><div class="line">00023938    00 ff 00 00 00 f7 00 00  00 ee 00 00 00 d5 00 00                    </div><div class="line">00023939    00 d9 00 00 00 ea 00 00  00 e3 00 00 00 df 00 00                    </div><div class="line">00023940    00 f7 00 00 00 ff 00 00  00 f8 00 00 00 fa 00 00                    </div><div class="line">00023941    00 fd 00 00 00 f7 00 00  00 f9 00 00 00 fb 00 00                    </div><div class="line">00023942    00 f8 00 00 00 f6 00 00  00 f0 00 00 00 fe 00 00                    </div><div class="line">00023943    01 02 00 00 00 e9 00 00  00 ec 00 00 00 ec 00 00                    </div><div class="line">00023944    00 e7 00 00 00 ea 00 00  00 de 00 00 00 e2 00 00                    </div><div class="line">00023945    00 c9 00 00 00 d4 00 00  00 d4 00 00 00 c7 00 00                    </div><div class="line">00023946    00 c9 00 00 00 c8 00 00  00 c1 00 00 00 c0 00 00                    </div><div class="line">00023947    00 bd 00 00 00 de 00 00  00 cb 00 00 00 cd 00 00                    </div><div class="line">00023948    00 d4 00 00 00 6d 00 00  00 28 73 74 73 63 00 00         m   (stsc  </div><div class="line">00023949    00 00 00 00 00 02 00 00  00 01 00 00 00 07 00 00                    </div><div class="line">00023950    00 01 00 00 00 26 00 00  00 02 00 00 00 01 00 00         &amp;          </div><div class="line">00023951    00 a8 73 74 63 6f 00 00  00 00 00 00 00 26 00 00      stco       &amp;  </div><div class="line">00023952    6d 8d 00 00 85 9b 00 00  9d e4 00 00 b1 21 00 00    m            !  </div><div class="line">00023953    c2 a7 00 00 d2 8e 00 00  df 8e 00 00 f3 54 00 00                 T  </div><div class="line">00023954    fe e8 00 01 1a 05 00 01  4a c7 00 01 7e 28 00 01            J   ~(  </div><div class="line">00023955    c5 a1 00 01 fc 89 00 02  35 5c 00 02 83 6a 00 02            5\   j  </div><div class="line">00023956    ae 62 00 02 e1 ae 00 03  1d 6d 00 03 58 04 00 03     b       m  X   </div><div class="line">00023957    99 4d 00 03 e4 b1 00 04  21 99 00 04 39 67 00 04     M      !   9g  </div><div class="line">00023958    5d c6 00 04 78 18 00 04  92 6a 00 04 a7 67 00 04    ]   x    j   g  </div><div class="line">00023959    b8 7e 00 04 d0 6c 00 04  e7 0c 00 05 07 c6 00 05     ~   l          </div><div class="line">00023960    53 5c 00 05 74 bc 00 05  8e 99 00 05 ae 19 00 05    S\  t           </div><div class="line">00023961    c0 eb 00 05 cb 47 00 00  00 16 75 64 74 61 00 00         G    udta  </div><div class="line">00023962    00 0e 6e 61 6d 65 53 74  65 72 65 6f 00 00 00 6f      nameStereo   o</div><div class="line">00023963    75 64 74 61 00 00 00 67  6d 65 74 61 00 00 00 00    udta   gmeta    </div><div class="line">00023964    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023965    6d 64 69 72 00 00 00 00  00 00 00 00 00 00 00 00    mdir            </div><div class="line">00023966    00 00 00 00 3a 69 6c 73  74 00 00 00 32 a9 74 6f        :ilst   2 to</div><div class="line">00023967    6f 00 00 00 2a 64 61 74  61 00 00 00 01 00 00 00    o   *data       </div><div class="line">00023968    00 48 61 6e 64 42 72 61  6b 65 20 30 2e 39 2e 34     HandBrake 0.9.4</div><div class="line">00023969    20 32 30 30 39 31 31 32  33 30 30                    2009112300</div></pre></td></tr></table></figure><h3 id="mvhd"><a href="#mvhd" class="headerlink" title="mvhd"></a><strong>mvhd</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">00023754    00 00 00 6c 6d 76 68 64  00 00 00 00 c7 ca ee a7       lmvhd        </div><div class="line">00023755    c7 ca ee a8 00 01 5f 90  00 07 a5 80 00 01 00 00          _         </div><div class="line">00023756    01 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023757    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023758    00 00 00 00 00 00 00 00  00 00 00 00 40 00 00 00                @   </div><div class="line">00023759    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023760    00 00 00 00 00 00 00 00  00 00 00 03</div></pre></td></tr></table></figure><h3 id="iods"><a href="#iods" class="headerlink" title="iods"></a><strong>iods</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023760                                         00 00 00 18                    </div><div class="line">00023761    69 6f 64 73 00 00 00 00  10 80 80 80 07 00 4f ff    iods          O </div><div class="line">00023762    ff 0f 7f ff</div></pre></td></tr></table></figure><h3 id="trak"><a href="#trak" class="headerlink" title="trak"></a><strong>trak</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line">00023762                00 00 06 0a  74 72 61 6b 00 00 00 5c            trak   \</div><div class="line">00023763    74 6b 68 64 00 00 00 01  c7 ca ee a7 c7 ca ee a8    tkhd            </div><div class="line">00023764    00 00 00 01 00 00 00 00  00 07 99 50 00 00 00 00               P    </div><div class="line">00023765    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023766    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023767    00 00 00 00 00 00 00 00  00 00 00 00 40 00 00 00                @   </div><div class="line">00023768    02 30 00 00 01 40 00 00  00 00 05 a6 6d 64 69 61     0   @      mdia</div><div class="line">00023769    00 00 00 20 6d 64 68 64  00 00 00 00 c7 ca ee a7        mdhd        </div><div class="line">00023770    c7 ca ee a8 00 01 5f 90  00 07 99 50 55 c4 00 00          _    PU   </div><div class="line">00023771    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023772    76 69 64 65 00 00 00 00  00 00 00 00 00 00 00 00    vide            </div><div class="line">00023773    00 00 00 05 5d 6d 69 6e  66 00 00 00 14 76 6d 68        ]minf    vmh</div><div class="line">00023774    64 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00    d               </div><div class="line">00023775    24 64 69 6e 66 00 00 00  1c 64 72 65 66 00 00 00    $dinf    dref   </div><div class="line">00023776    00 00 00 00 01 00 00 00  0c 75 72 6c 20 00 00 00             url    </div><div class="line">00023777    01 00 00 05 1d 73 74 62  6c 00 00 00 ab 73 74 73         stbl    sts</div><div class="line">00023778    64 00 00 00 00 00 00 00  01 00 00 00 9b 61 76 63    d            avc</div><div class="line">00023779    31 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00    1               </div><div class="line">00023780    00 00 00 00 00 00 00 00  00 02 30 01 40 00 48 00              0 @ H </div><div class="line">00023781    00 00 48 00 00 00 00 00  00 00 01 0e 4a 56 54 2f      H         JVT/</div><div class="line">00023782    41 56 43 20 43 6f 64 69  6e 67 00 00 00 00 00 00    AVC Coding      </div><div class="line">00023783    00 00 00 00 00 00 00 00  00 00 00 00 18 ff ff 00                    </div><div class="line">00023784    00 00 33 61 76 63 43 01  42 c0 1e ff e1 00 1b 67      3avcC B      g</div><div class="line">00023785    42 c0 1e 9e 21 81 18 53  4d 40 40 40 50 00 00 03    B   !  SM@@@P   </div><div class="line">00023786    00 10 00 00 03 03 c8 f1  62 ee 01 00 05 68 ce 06            b    h  </div><div class="line">00023787    cb 20 00 00 00 12 63 6f  6c 72 6e 63 6c 63 00 01          colrnclc  </div><div class="line">00023788    00 01 00 01 00 00 00 18  73 74 74 73 00 00 00 00            stts    </div><div class="line">00023789    00 00 00 01 00 00 00 a6  00 00 0b b8 00 00 02 ac                    </div><div class="line">00023790    73 74 73 7a 00 00 00 00  00 00 00 00 00 00 00 a6    stsz            </div><div class="line">00023791    00 00 56 27 00 00 0b 20  00 00 05 bc 00 00 05 e2      V'            </div><div class="line">00023792    00 00 05 c1 00 00 04 37  00 00 04 07 00 00 03 b6           7        </div><div class="line">00023793    00 00 06 45 00 00 03 73  00 00 05 12 00 00 03 26       E   s       &amp;</div><div class="line">00023794    00 00 02 e9 00 00 03 7b  00 00 03 4a 00 00 03 6b           &#123;   J   k</div><div class="line">00023795    00 00 02 b6 00 00 03 4c  00 00 02 7a 00 00 02 c7           L   z    </div><div class="line">00023796    00 00 02 2e 00 00 03 16  00 00 02 26 00 00 02 7f       .       &amp;    </div><div class="line">00023797    00 00 01 ec 00 00 01 ea  00 00 01 f5 00 00 01 eb                    </div><div class="line">00023798    00 00 01 fa 00 00 01 e7  00 00 01 fc 00 00 01 dd                    </div><div class="line">00023799    00 00 01 c6 00 00 01 ae  00 00 01 c8 00 00 01 b9                    </div><div class="line">00023800    00 00 01 90 00 00 01 93  00 00 01 8c 00 00 01 da                    </div><div class="line">00023801    00 00 01 c2 00 00 05 d0  00 00 07 b8 00 00 06 7a                   z</div><div class="line">00023802    00 00 09 a9 00 00 0a 2c  00 00 0a 7c 00 00 0c b3           ,   |    </div><div class="line">00023803    00 00 09 8c 00 00 09 52  00 00 0c 04 00 00 0d c1           R        </div><div class="line">00023804    00 00 0f 74 00 00 10 48  00 00 11 06 00 00 10 61       t   H       a</div><div class="line">00023805    00 00 0c 63 00 00 0c 31  00 00 0b 42 00 00 0c 0d       c   1   B    </div><div class="line">00023806    00 00 0f 32 00 00 0a 7b  00 00 0d 0f 00 00 0a e0       2   &#123;        </div><div class="line">00023807    00 00 0a 0e 00 00 0b 6b  00 00 08 74 00 00 0c 36           k   t   6</div><div class="line">00023808    00 00 09 e6 00 00 06 8d  00 00 04 f8 00 00 07 8a                    </div><div class="line">00023809    00 00 07 c1 00 00 09 f3  00 00 07 c7 00 00 0a cb                    </div><div class="line">00023810    00 00 0a d2 00 00 0b 74  00 00 0c 28 00 00 0a 9a           t   (    </div><div class="line">00023811    00 00 0c 60 00 00 0d 6d  00 00 0c 3e 00 00 0f fc       `   m   &gt;    </div><div class="line">00023812    00 00 0e 82 00 00 0b 79  00 00 0d e4 00 00 0d 24           y       $</div><div class="line">00023813    00 00 0a 17 00 00 11 aa  00 00 12 65 00 00 0d 7b               e   &#123;</div><div class="line">00023814    00 00 12 a0 00 00 13 d8  00 00 11 49 00 00 0e 59               I   Y</div><div class="line">00023815    00 00 10 15 00 00 16 81  00 00 09 b4 00 00 06 eb                    </div><div class="line">00023816    00 00 05 ef 00 00 05 8a  00 00 03 d7 00 00 04 0d                    </div><div class="line">00023817    00 00 03 bb 00 00 04 6b  00 00 03 40 00 00 03 30           k   @   0</div><div class="line">00023818    00 00 02 de 00 00 03 ae  00 00 05 cf 00 00 04 6c                   l</div><div class="line">00023819    00 00 05 69 00 00 05 00  00 00 06 a1 00 00 03 35       i           5</div><div class="line">00023820    00 00 04 1a 00 00 03 fa  00 00 06 3d 00 00 05 d6               =    </div><div class="line">00023821    00 00 04 68 00 00 02 d6  00 00 04 b5 00 00 02 d9       h            </div><div class="line">00023822    00 00 02 7f 00 00 02 4d  00 00 02 7d 00 00 03 8c           M   &#125;    </div><div class="line">00023823    00 00 02 06 00 00 02 01  00 00 07 7f 00 00 05 ef                    </div><div class="line">00023824    00 00 05 b8 00 00 04 0a  00 00 02 99 00 00 03 1d                    </div><div class="line">00023825    00 00 07 c5 00 00 05 ac  00 00 04 78 00 00 08 71               x   q</div><div class="line">00023826    00 00 08 99 00 00 08 e9  00 00 08 99 00 00 05 73                   s</div><div class="line">00023827    00 00 07 c7 00 00 08 3d  00 00 0b 59 00 00 0a 36           =   Y   6</div><div class="line">00023828    00 00 06 ba 00 00 05 f9  00 00 07 2e 00 00 06 eb               .    </div><div class="line">00023829    00 00 04 c6 00 00 04 ba  00 00 05 66 00 00 04 31               f   1</div><div class="line">00023830    00 00 06 8a 00 00 06 cf  00 00 06 fe 00 00 04 97                    </div><div class="line">00023831    00 00 02 43 00 00 03 e2  00 00 04 06 00 00 02 e6       C            </div><div class="line">00023832    00 00 02 6b 00 00 02 75  00 00 00 28 73 74 73 63       k   u   (stsc</div><div class="line">00023833    00 00 00 00 00 00 00 02  00 00 00 01 00 00 00 04                    </div><div class="line">00023834    00 00 00 01 00 00 00 2a  00 00 00 02 00 00 00 01           *        </div><div class="line">00023835    00 00 00 b8 73 74 63 6f  00 00 00 00 00 00 00 2a        stco       *</div><div class="line">00023836    00 00 00 a8 00 00 73 e6  00 00 8b f4 00 00 a4 08          s         </div><div class="line">00023837    00 00 b7 64 00 00 c8 a5  00 00 d7 d8 00 00 e4 a5       d            </div><div class="line">00023838    00 00 ec 5f 00 00 f8 5f  00 01 04 41 00 01 1f c3       _   _   A    </div><div class="line">00023839    00 01 51 85 00 01 84 7e  00 01 cc a6 00 02 03 c0      Q    ~        </div><div class="line">00023840    00 02 3c 52 00 02 66 75  00 02 8a 1c 00 02 b4 a6      &lt;R  fu        </div><div class="line">00023841    00 02 e7 66 00 03 23 01  00 03 5d ac 00 03 9e 97       f  #   ]     </div><div class="line">00023842    00 03 ea 64 00 04 26 0a  00 04 3e 69 00 04 4c ff       d  &amp;   &gt;i  L </div><div class="line">00023843    00 04 63 d9 00 04 7e 43  00 04 98 9b 00 04 ad a9      c   ~C        </div><div class="line">00023844    00 04 be f7 00 04 d7 94  00 04 ed 6c 00 05 0e 3b               l   ;</div><div class="line">00023845    00 05 2d c9 00 05 59 f0  00 05 7b 82 00 05 95 2b      -   Y   &#123;    +</div><div class="line">00023846    00 05 b3 da 00 05 c6 67  00 00 00 14 73 74 73 73           g    stss</div><div class="line">00023847    00 00 00 00 00 00 00 01  00 00 00 01 00 00 00 b2                    </div><div class="line">00023848    73 64 74 70 00 00 00 00  04 44 44 44 44 44 44 44    sdtp     DDDDDDD</div><div class="line">00023849    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023850    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023851    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023852    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023853    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023854    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023855    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023856    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023857    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023858    44 44 44 44 44 44 44 44  44 44 44 44 44 44          DDDDDDDDDDDDDD</div></pre></td></tr></table></figure><h4 id="tkhd"><a href="#tkhd" class="headerlink" title="tkhd"></a><strong>tkhd</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">00023762                                         00 00 00 5c                   \</div><div class="line">00023763    74 6b 68 64 00 00 00 01  c7 ca ee a7 c7 ca ee a8    tkhd            </div><div class="line">00023764    00 00 00 01 00 00 00 00  00 07 99 50 00 00 00 00               P    </div><div class="line">00023765    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023766    00 00 00 00 00 00 00 00  00 00 00 00 00 01 00 00                    </div><div class="line">00023767    00 00 00 00 00 00 00 00  00 00 00 00 40 00 00 00                @   </div><div class="line">00023768    02 30 00 00 01 40 00 00                              0   @</div></pre></td></tr></table></figure><h4 id="mdia"><a href="#mdia" class="headerlink" title="mdia"></a><strong>mdia</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line">00023768                             00 00 05 a6 6d 64 69 61                mdia</div><div class="line">00023769    00 00 00 20 6d 64 68 64  00 00 00 00 c7 ca ee a7        mdhd        </div><div class="line">00023770    c7 ca ee a8 00 01 5f 90  00 07 99 50 55 c4 00 00          _    PU   </div><div class="line">00023771    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023772    76 69 64 65 00 00 00 00  00 00 00 00 00 00 00 00    vide            </div><div class="line">00023773    00 00 00 05 5d 6d 69 6e  66 00 00 00 14 76 6d 68        ]minf    vmh</div><div class="line">00023774    64 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00    d               </div><div class="line">00023775    24 64 69 6e 66 00 00 00  1c 64 72 65 66 00 00 00    $dinf    dref   </div><div class="line">00023776    00 00 00 00 01 00 00 00  0c 75 72 6c 20 00 00 00             url    </div><div class="line">00023777    01 00 00 05 1d 73 74 62  6c 00 00 00 ab 73 74 73         stbl    sts</div><div class="line">00023778    64 00 00 00 00 00 00 00  01 00 00 00 9b 61 76 63    d            avc</div><div class="line">00023779    31 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00    1               </div><div class="line">00023780    00 00 00 00 00 00 00 00  00 02 30 01 40 00 48 00              0 @ H </div><div class="line">00023781    00 00 48 00 00 00 00 00  00 00 01 0e 4a 56 54 2f      H         JVT/</div><div class="line">00023782    41 56 43 20 43 6f 64 69  6e 67 00 00 00 00 00 00    AVC Coding      </div><div class="line">00023783    00 00 00 00 00 00 00 00  00 00 00 00 18 ff ff 00                    </div><div class="line">00023784    00 00 33 61 76 63 43 01  42 c0 1e ff e1 00 1b 67      3avcC B      g</div><div class="line">00023785    42 c0 1e 9e 21 81 18 53  4d 40 40 40 50 00 00 03    B   !  SM@@@P   </div><div class="line">00023786    00 10 00 00 03 03 c8 f1  62 ee 01 00 05 68 ce 06            b    h  </div><div class="line">00023787    cb 20 00 00 00 12 63 6f  6c 72 6e 63 6c 63 00 01          colrnclc  </div><div class="line">00023788    00 01 00 01 00 00 00 18  73 74 74 73 00 00 00 00            stts    </div><div class="line">00023789    00 00 00 01 00 00 00 a6  00 00 0b b8 00 00 02 ac                    </div><div class="line">00023790    73 74 73 7a 00 00 00 00  00 00 00 00 00 00 00 a6    stsz            </div><div class="line">00023791    00 00 56 27 00 00 0b 20  00 00 05 bc 00 00 05 e2      V'            </div><div class="line">00023792    00 00 05 c1 00 00 04 37  00 00 04 07 00 00 03 b6           7        </div><div class="line">00023793    00 00 06 45 00 00 03 73  00 00 05 12 00 00 03 26       E   s       &amp;</div><div class="line">00023794    00 00 02 e9 00 00 03 7b  00 00 03 4a 00 00 03 6b           &#123;   J   k</div><div class="line">00023795    00 00 02 b6 00 00 03 4c  00 00 02 7a 00 00 02 c7           L   z    </div><div class="line">00023796    00 00 02 2e 00 00 03 16  00 00 02 26 00 00 02 7f       .       &amp;    </div><div class="line">00023797    00 00 01 ec 00 00 01 ea  00 00 01 f5 00 00 01 eb                    </div><div class="line">00023798    00 00 01 fa 00 00 01 e7  00 00 01 fc 00 00 01 dd                    </div><div class="line">00023799    00 00 01 c6 00 00 01 ae  00 00 01 c8 00 00 01 b9                    </div><div class="line">00023800    00 00 01 90 00 00 01 93  00 00 01 8c 00 00 01 da                    </div><div class="line">00023801    00 00 01 c2 00 00 05 d0  00 00 07 b8 00 00 06 7a                   z</div><div class="line">00023802    00 00 09 a9 00 00 0a 2c  00 00 0a 7c 00 00 0c b3           ,   |    </div><div class="line">00023803    00 00 09 8c 00 00 09 52  00 00 0c 04 00 00 0d c1           R        </div><div class="line">00023804    00 00 0f 74 00 00 10 48  00 00 11 06 00 00 10 61       t   H       a</div><div class="line">00023805    00 00 0c 63 00 00 0c 31  00 00 0b 42 00 00 0c 0d       c   1   B    </div><div class="line">00023806    00 00 0f 32 00 00 0a 7b  00 00 0d 0f 00 00 0a e0       2   &#123;        </div><div class="line">00023807    00 00 0a 0e 00 00 0b 6b  00 00 08 74 00 00 0c 36           k   t   6</div><div class="line">00023808    00 00 09 e6 00 00 06 8d  00 00 04 f8 00 00 07 8a                    </div><div class="line">00023809    00 00 07 c1 00 00 09 f3  00 00 07 c7 00 00 0a cb                    </div><div class="line">00023810    00 00 0a d2 00 00 0b 74  00 00 0c 28 00 00 0a 9a           t   (    </div><div class="line">00023811    00 00 0c 60 00 00 0d 6d  00 00 0c 3e 00 00 0f fc       `   m   &gt;    </div><div class="line">00023812    00 00 0e 82 00 00 0b 79  00 00 0d e4 00 00 0d 24           y       $</div><div class="line">00023813    00 00 0a 17 00 00 11 aa  00 00 12 65 00 00 0d 7b               e   &#123;</div><div class="line">00023814    00 00 12 a0 00 00 13 d8  00 00 11 49 00 00 0e 59               I   Y</div><div class="line">00023815    00 00 10 15 00 00 16 81  00 00 09 b4 00 00 06 eb                    </div><div class="line">00023816    00 00 05 ef 00 00 05 8a  00 00 03 d7 00 00 04 0d                    </div><div class="line">00023817    00 00 03 bb 00 00 04 6b  00 00 03 40 00 00 03 30           k   @   0</div><div class="line">00023818    00 00 02 de 00 00 03 ae  00 00 05 cf 00 00 04 6c                   l</div><div class="line">00023819    00 00 05 69 00 00 05 00  00 00 06 a1 00 00 03 35       i           5</div><div class="line">00023820    00 00 04 1a 00 00 03 fa  00 00 06 3d 00 00 05 d6               =    </div><div class="line">00023821    00 00 04 68 00 00 02 d6  00 00 04 b5 00 00 02 d9       h            </div><div class="line">00023822    00 00 02 7f 00 00 02 4d  00 00 02 7d 00 00 03 8c           M   &#125;    </div><div class="line">00023823    00 00 02 06 00 00 02 01  00 00 07 7f 00 00 05 ef                    </div><div class="line">00023824    00 00 05 b8 00 00 04 0a  00 00 02 99 00 00 03 1d                    </div><div class="line">00023825    00 00 07 c5 00 00 05 ac  00 00 04 78 00 00 08 71               x   q</div><div class="line">00023826    00 00 08 99 00 00 08 e9  00 00 08 99 00 00 05 73                   s</div><div class="line">00023827    00 00 07 c7 00 00 08 3d  00 00 0b 59 00 00 0a 36           =   Y   6</div><div class="line">00023828    00 00 06 ba 00 00 05 f9  00 00 07 2e 00 00 06 eb               .    </div><div class="line">00023829    00 00 04 c6 00 00 04 ba  00 00 05 66 00 00 04 31               f   1</div><div class="line">00023830    00 00 06 8a 00 00 06 cf  00 00 06 fe 00 00 04 97                    </div><div class="line">00023831    00 00 02 43 00 00 03 e2  00 00 04 06 00 00 02 e6       C            </div><div class="line">00023832    00 00 02 6b 00 00 02 75  00 00 00 28 73 74 73 63       k   u   (stsc</div><div class="line">00023833    00 00 00 00 00 00 00 02  00 00 00 01 00 00 00 04                    </div><div class="line">00023834    00 00 00 01 00 00 00 2a  00 00 00 02 00 00 00 01           *        </div><div class="line">00023835    00 00 00 b8 73 74 63 6f  00 00 00 00 00 00 00 2a        stco       *</div><div class="line">00023836    00 00 00 a8 00 00 73 e6  00 00 8b f4 00 00 a4 08          s         </div><div class="line">00023837    00 00 b7 64 00 00 c8 a5  00 00 d7 d8 00 00 e4 a5       d            </div><div class="line">00023838    00 00 ec 5f 00 00 f8 5f  00 01 04 41 00 01 1f c3       _   _   A    </div><div class="line">00023839    00 01 51 85 00 01 84 7e  00 01 cc a6 00 02 03 c0      Q    ~        </div><div class="line">00023840    00 02 3c 52 00 02 66 75  00 02 8a 1c 00 02 b4 a6      &lt;R  fu        </div><div class="line">00023841    00 02 e7 66 00 03 23 01  00 03 5d ac 00 03 9e 97       f  #   ]     </div><div class="line">00023842    00 03 ea 64 00 04 26 0a  00 04 3e 69 00 04 4c ff       d  &amp;   &gt;i  L </div><div class="line">00023843    00 04 63 d9 00 04 7e 43  00 04 98 9b 00 04 ad a9      c   ~C        </div><div class="line">00023844    00 04 be f7 00 04 d7 94  00 04 ed 6c 00 05 0e 3b               l   ;</div><div class="line">00023845    00 05 2d c9 00 05 59 f0  00 05 7b 82 00 05 95 2b      -   Y   &#123;    +</div><div class="line">00023846    00 05 b3 da 00 05 c6 67  00 00 00 14 73 74 73 73           g    stss</div><div class="line">00023847    00 00 00 00 00 00 00 01  00 00 00 01 00 00 00 b2</div></pre></td></tr></table></figure><h5 id="mdhd"><a href="#mdhd" class="headerlink" title="mdhd"></a><strong>mdhd</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00023769    00 00 00 20 6d 64 68 64  00 00 00 00 c7 ca ee a7        mdhd        </div><div class="line">00023770    c7 ca ee a8 00 01 5f 90  00 07 99 50 55 c4 00 00          _    PU   </div></pre></td></tr></table></figure><h5 id="hdlr"><a href="#hdlr" class="headerlink" title="hdlr"></a><strong>hdlr</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023771    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023772    76 69 64 65 00 00 00 00  00 00 00 00 00 00 00 00    vide            </div><div class="line">00</div></pre></td></tr></table></figure><h5 id="minf"><a href="#minf" class="headerlink" title="minf"></a><strong>minf</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">00023773       00 00 05 5d 6d 69 6e  66 00 00 00 14 76 6d 68        ]minf    vmh</div><div class="line">00023774    64 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00    d               </div><div class="line">00023775    24 64 69 6e 66 00 00 00  1c 64 72 65 66 00 00 00    $dinf    dref   </div><div class="line">00023776    00 00 00 00 01 00 00 00  0c 75 72 6c 20 00 00 00             url    </div><div class="line">00023777    01 00 00 05 1d 73 74 62  6c 00 00 00 ab 73 74 73         stbl    sts</div><div class="line">00023778    64 00 00 00 00 00 00 00  01 00 00 00 9b 61 76 63    d            avc</div><div class="line">00023779    31 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00    1               </div><div class="line">00023780    00 00 00 00 00 00 00 00  00 02 30 01 40 00 48 00              0 @ H </div><div class="line">00023781    00 00 48 00 00 00 00 00  00 00 01 0e 4a 56 54 2f      H         JVT/</div><div class="line">00023782    41 56 43 20 43 6f 64 69  6e 67 00 00 00 00 00 00    AVC Coding      </div><div class="line">00023783    00 00 00 00 00 00 00 00  00 00 00 00 18 ff ff 00                    </div><div class="line">00023784    00 00 33 61 76 63 43 01  42 c0 1e ff e1 00 1b 67      3avcC B      g</div><div class="line">00023785    42 c0 1e 9e 21 81 18 53  4d 40 40 40 50 00 00 03    B   !  SM@@@P   </div><div class="line">00023786    00 10 00 00 03 03 c8 f1  62 ee 01 00 05 68 ce 06            b    h  </div><div class="line">00023787    cb 20 00 00 00 12 63 6f  6c 72 6e 63 6c 63 00 01          colrnclc  </div><div class="line">00023788    00 01 00 01 00 00 00 18  73 74 74 73 00 00 00 00            stts    </div><div class="line">00023789    00 00 00 01 00 00 00 a6  00 00 0b b8 00 00 02 ac                    </div><div class="line">00023790    73 74 73 7a 00 00 00 00  00 00 00 00 00 00 00 a6    stsz            </div><div class="line">00023791    00 00 56 27 00 00 0b 20  00 00 05 bc 00 00 05 e2      V'            </div><div class="line">00023792    00 00 05 c1 00 00 04 37  00 00 04 07 00 00 03 b6           7        </div><div class="line">00023793    00 00 06 45 00 00 03 73  00 00 05 12 00 00 03 26       E   s       &amp;</div><div class="line">00023794    00 00 02 e9 00 00 03 7b  00 00 03 4a 00 00 03 6b           &#123;   J   k</div><div class="line">00023795    00 00 02 b6 00 00 03 4c  00 00 02 7a 00 00 02 c7           L   z    </div><div class="line">00023796    00 00 02 2e 00 00 03 16  00 00 02 26 00 00 02 7f       .       &amp;    </div><div class="line">00023797    00 00 01 ec 00 00 01 ea  00 00 01 f5 00 00 01 eb                    </div><div class="line">00023798    00 00 01 fa 00 00 01 e7  00 00 01 fc 00 00 01 dd                    </div><div class="line">00023799    00 00 01 c6 00 00 01 ae  00 00 01 c8 00 00 01 b9                    </div><div class="line">00023800    00 00 01 90 00 00 01 93  00 00 01 8c 00 00 01 da                    </div><div class="line">00023801    00 00 01 c2 00 00 05 d0  00 00 07 b8 00 00 06 7a                   z</div><div class="line">00023802    00 00 09 a9 00 00 0a 2c  00 00 0a 7c 00 00 0c b3           ,   |    </div><div class="line">00023803    00 00 09 8c 00 00 09 52  00 00 0c 04 00 00 0d c1           R        </div><div class="line">00023804    00 00 0f 74 00 00 10 48  00 00 11 06 00 00 10 61       t   H       a</div><div class="line">00023805    00 00 0c 63 00 00 0c 31  00 00 0b 42 00 00 0c 0d       c   1   B    </div><div class="line">00023806    00 00 0f 32 00 00 0a 7b  00 00 0d 0f 00 00 0a e0       2   &#123;        </div><div class="line">00023807    00 00 0a 0e 00 00 0b 6b  00 00 08 74 00 00 0c 36           k   t   6</div><div class="line">00023808    00 00 09 e6 00 00 06 8d  00 00 04 f8 00 00 07 8a                    </div><div class="line">00023809    00 00 07 c1 00 00 09 f3  00 00 07 c7 00 00 0a cb                    </div><div class="line">00023810    00 00 0a d2 00 00 0b 74  00 00 0c 28 00 00 0a 9a           t   (    </div><div class="line">00023811    00 00 0c 60 00 00 0d 6d  00 00 0c 3e 00 00 0f fc       `   m   &gt;    </div><div class="line">00023812    00 00 0e 82 00 00 0b 79  00 00 0d e4 00 00 0d 24           y       $</div><div class="line">00023813    00 00 0a 17 00 00 11 aa  00 00 12 65 00 00 0d 7b               e   &#123;</div><div class="line">00023814    00 00 12 a0 00 00 13 d8  00 00 11 49 00 00 0e 59               I   Y</div><div class="line">00023815    00 00 10 15 00 00 16 81  00 00 09 b4 00 00 06 eb                    </div><div class="line">00023816    00 00 05 ef 00 00 05 8a  00 00 03 d7 00 00 04 0d                    </div><div class="line">00023817    00 00 03 bb 00 00 04 6b  00 00 03 40 00 00 03 30           k   @   0</div><div class="line">00023818    00 00 02 de 00 00 03 ae  00 00 05 cf 00 00 04 6c                   l</div><div class="line">00023819    00 00 05 69 00 00 05 00  00 00 06 a1 00 00 03 35       i           5</div><div class="line">00023820    00 00 04 1a 00 00 03 fa  00 00 06 3d 00 00 05 d6               =    </div><div class="line">00023821    00 00 04 68 00 00 02 d6  00 00 04 b5 00 00 02 d9       h            </div><div class="line">00023822    00 00 02 7f 00 00 02 4d  00 00 02 7d 00 00 03 8c           M   &#125;    </div><div class="line">00023823    00 00 02 06 00 00 02 01  00 00 07 7f 00 00 05 ef                    </div><div class="line">00023824    00 00 05 b8 00 00 04 0a  00 00 02 99 00 00 03 1d                    </div><div class="line">00023825    00 00 07 c5 00 00 05 ac  00 00 04 78 00 00 08 71               x   q</div><div class="line">00023826    00 00 08 99 00 00 08 e9  00 00 08 99 00 00 05 73                   s</div><div class="line">00023827    00 00 07 c7 00 00 08 3d  00 00 0b 59 00 00 0a 36           =   Y   6</div><div class="line">00023828    00 00 06 ba 00 00 05 f9  00 00 07 2e 00 00 06 eb               .    </div><div class="line">00023829    00 00 04 c6 00 00 04 ba  00 00 05 66 00 00 04 31               f   1</div><div class="line">00023830    00 00 06 8a 00 00 06 cf  00 00 06 fe 00 00 04 97                    </div><div class="line">00023831    00 00 02 43 00 00 03 e2  00 00 04 06 00 00 02 e6       C            </div><div class="line">00023832    00 00 02 6b 00 00 02 75  00 00 00 28 73 74 73 63       k   u   (stsc</div><div class="line">00023833    00 00 00 00 00 00 00 02  00 00 00 01 00 00 00 04                    </div><div class="line">00023834    00 00 00 01 00 00 00 2a  00 00 00 02 00 00 00 01           *        </div><div class="line">00023835    00 00 00 b8 73 74 63 6f  00 00 00 00 00 00 00 2a        stco       *</div><div class="line">00023836    00 00 00 a8 00 00 73 e6  00 00 8b f4 00 00 a4 08          s         </div><div class="line">00023837    00 00 b7 64 00 00 c8 a5  00 00 d7 d8 00 00 e4 a5       d            </div><div class="line">00023838    00 00 ec 5f 00 00 f8 5f  00 01 04 41 00 01 1f c3       _   _   A    </div><div class="line">00023839    00 01 51 85 00 01 84 7e  00 01 cc a6 00 02 03 c0      Q    ~        </div><div class="line">00023840    00 02 3c 52 00 02 66 75  00 02 8a 1c 00 02 b4 a6      &lt;R  fu        </div><div class="line">00023841    00 02 e7 66 00 03 23 01  00 03 5d ac 00 03 9e 97       f  #   ]     </div><div class="line">00023842    00 03 ea 64 00 04 26 0a  00 04 3e 69 00 04 4c ff       d  &amp;   &gt;i  L </div><div class="line">00023843    00 04 63 d9 00 04 7e 43  00 04 98 9b 00 04 ad a9      c   ~C        </div><div class="line">00023844    00 04 be f7 00 04 d7 94  00 04 ed 6c 00 05 0e 3b               l   ;</div><div class="line">00023845    00 05 2d c9 00 05 59 f0  00 05 7b 82 00 05 95 2b      -   Y   &#123;    +</div><div class="line">00023846    00 05 b3 da 00 05 c6 67  00 00 00 14 73 74 73 73           g    stss</div><div class="line">00023847    00 00 00 00 00 00 00 01  00 00 00 01 00 00 00 b2                    </div></pre></td></tr></table></figure><h6 id="vmhd"><a href="#vmhd" class="headerlink" title="vmhd"></a><strong>vmhd</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00023773                                00 00 00 14 76 6d 68        ]minf    vmh</div><div class="line">00023774    64 00 00 00 01 00 00 00  00 00 00 00 00             d</div></pre></td></tr></table></figure><h6 id="dinf"><a href="#dinf" class="headerlink" title="dinf"></a><strong>dinf</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">00023774                                            00 00 00                   </div><div class="line">00023775    24 64 69 6e 66 00 00 00  1c 64 72 65 66 00 00 00    $dinf    dref   </div><div class="line">00023776    00 00 00 00 01 00 00 00  0c 75 72 6c 20 00 00 00             url    </div><div class="line">00023777    01</div></pre></td></tr></table></figure><p>####### <strong>dref</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023775                   00 00 00  1c 64 72 65 66 00 00 00             dref   </div><div class="line">00023776    00 00 00 00 01 00 00 00  0c 75 72 6c 20 00 00 00             url    </div><div class="line">00023777    01</div></pre></td></tr></table></figure><h6 id="stbl"><a href="#stbl" class="headerlink" title="stbl"></a><strong>stbl</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div></pre></td><td class="code"><pre><div class="line">00023777       00 00 05 1d 73 74 62  6c 00 00 00 ab 73 74 73         stbl    sts</div><div class="line">00023778    64 00 00 00 00 00 00 00  01 00 00 00 9b 61 76 63    d            avc</div><div class="line">00023779    31 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00    1               </div><div class="line">00023780    00 00 00 00 00 00 00 00  00 02 30 01 40 00 48 00              0 @ H </div><div class="line">00023781    00 00 48 00 00 00 00 00  00 00 01 0e 4a 56 54 2f      H         JVT/</div><div class="line">00023782    41 56 43 20 43 6f 64 69  6e 67 00 00 00 00 00 00    AVC Coding      </div><div class="line">00023783    00 00 00 00 00 00 00 00  00 00 00 00 18 ff ff 00                    </div><div class="line">00023784    00 00 33 61 76 63 43 01  42 c0 1e ff e1 00 1b 67      3avcC B      g</div><div class="line">00023785    42 c0 1e 9e 21 81 18 53  4d 40 40 40 50 00 00 03    B   !  SM@@@P   </div><div class="line">00023786    00 10 00 00 03 03 c8 f1  62 ee 01 00 05 68 ce 06            b    h  </div><div class="line">00023787    cb 20 00 00 00 12 63 6f  6c 72 6e 63 6c 63 00 01          colrnclc  </div><div class="line">00023788    00 01 00 01 00 00 00 18  73 74 74 73 00 00 00 00            stts    </div><div class="line">00023789    00 00 00 01 00 00 00 a6  00 00 0b b8 00 00 02 ac                    </div><div class="line">00023790    73 74 73 7a 00 00 00 00  00 00 00 00 00 00 00 a6    stsz            </div><div class="line">00023791    00 00 56 27 00 00 0b 20  00 00 05 bc 00 00 05 e2      V'            </div><div class="line">00023792    00 00 05 c1 00 00 04 37  00 00 04 07 00 00 03 b6           7        </div><div class="line">00023793    00 00 06 45 00 00 03 73  00 00 05 12 00 00 03 26       E   s       &amp;</div><div class="line">00023794    00 00 02 e9 00 00 03 7b  00 00 03 4a 00 00 03 6b           &#123;   J   k</div><div class="line">00023795    00 00 02 b6 00 00 03 4c  00 00 02 7a 00 00 02 c7           L   z    </div><div class="line">00023796    00 00 02 2e 00 00 03 16  00 00 02 26 00 00 02 7f       .       &amp;    </div><div class="line">00023797    00 00 01 ec 00 00 01 ea  00 00 01 f5 00 00 01 eb                    </div><div class="line">00023798    00 00 01 fa 00 00 01 e7  00 00 01 fc 00 00 01 dd                    </div><div class="line">00023799    00 00 01 c6 00 00 01 ae  00 00 01 c8 00 00 01 b9                    </div><div class="line">00023800    00 00 01 90 00 00 01 93  00 00 01 8c 00 00 01 da                    </div><div class="line">00023801    00 00 01 c2 00 00 05 d0  00 00 07 b8 00 00 06 7a                   z</div><div class="line">00023802    00 00 09 a9 00 00 0a 2c  00 00 0a 7c 00 00 0c b3           ,   |    </div><div class="line">00023803    00 00 09 8c 00 00 09 52  00 00 0c 04 00 00 0d c1           R        </div><div class="line">00023804    00 00 0f 74 00 00 10 48  00 00 11 06 00 00 10 61       t   H       a</div><div class="line">00023805    00 00 0c 63 00 00 0c 31  00 00 0b 42 00 00 0c 0d       c   1   B    </div><div class="line">00023806    00 00 0f 32 00 00 0a 7b  00 00 0d 0f 00 00 0a e0       2   &#123;        </div><div class="line">00023807    00 00 0a 0e 00 00 0b 6b  00 00 08 74 00 00 0c 36           k   t   6</div><div class="line">00023808    00 00 09 e6 00 00 06 8d  00 00 04 f8 00 00 07 8a                    </div><div class="line">00023809    00 00 07 c1 00 00 09 f3  00 00 07 c7 00 00 0a cb                    </div><div class="line">00023810    00 00 0a d2 00 00 0b 74  00 00 0c 28 00 00 0a 9a           t   (    </div><div class="line">00023811    00 00 0c 60 00 00 0d 6d  00 00 0c 3e 00 00 0f fc       `   m   &gt;    </div><div class="line">00023812    00 00 0e 82 00 00 0b 79  00 00 0d e4 00 00 0d 24           y       $</div><div class="line">00023813    00 00 0a 17 00 00 11 aa  00 00 12 65 00 00 0d 7b               e   &#123;</div><div class="line">00023814    00 00 12 a0 00 00 13 d8  00 00 11 49 00 00 0e 59               I   Y</div><div class="line">00023815    00 00 10 15 00 00 16 81  00 00 09 b4 00 00 06 eb                    </div><div class="line">00023816    00 00 05 ef 00 00 05 8a  00 00 03 d7 00 00 04 0d                    </div><div class="line">00023817    00 00 03 bb 00 00 04 6b  00 00 03 40 00 00 03 30           k   @   0</div><div class="line">00023818    00 00 02 de 00 00 03 ae  00 00 05 cf 00 00 04 6c                   l</div><div class="line">00023819    00 00 05 69 00 00 05 00  00 00 06 a1 00 00 03 35       i           5</div><div class="line">00023820    00 00 04 1a 00 00 03 fa  00 00 06 3d 00 00 05 d6               =    </div><div class="line">00023821    00 00 04 68 00 00 02 d6  00 00 04 b5 00 00 02 d9       h            </div><div class="line">00023822    00 00 02 7f 00 00 02 4d  00 00 02 7d 00 00 03 8c           M   &#125;    </div><div class="line">00023823    00 00 02 06 00 00 02 01  00 00 07 7f 00 00 05 ef                    </div><div class="line">00023824    00 00 05 b8 00 00 04 0a  00 00 02 99 00 00 03 1d                    </div><div class="line">00023825    00 00 07 c5 00 00 05 ac  00 00 04 78 00 00 08 71               x   q</div><div class="line">00023826    00 00 08 99 00 00 08 e9  00 00 08 99 00 00 05 73                   s</div><div class="line">00023827    00 00 07 c7 00 00 08 3d  00 00 0b 59 00 00 0a 36           =   Y   6</div><div class="line">00023828    00 00 06 ba 00 00 05 f9  00 00 07 2e 00 00 06 eb               .    </div><div class="line">00023829    00 00 04 c6 00 00 04 ba  00 00 05 66 00 00 04 31               f   1</div><div class="line">00023830    00 00 06 8a 00 00 06 cf  00 00 06 fe 00 00 04 97                    </div><div class="line">00023831    00 00 02 43 00 00 03 e2  00 00 04 06 00 00 02 e6       C            </div><div class="line">00023832    00 00 02 6b 00 00 02 75  00 00 00 28 73 74 73 63       k   u   (stsc</div><div class="line">00023833    00 00 00 00 00 00 00 02  00 00 00 01 00 00 00 04                    </div><div class="line">00023834    00 00 00 01 00 00 00 2a  00 00 00 02 00 00 00 01           *        </div><div class="line">00023835    00 00 00 b8 73 74 63 6f  00 00 00 00 00 00 00 2a        stco       *</div><div class="line">00023836    00 00 00 a8 00 00 73 e6  00 00 8b f4 00 00 a4 08          s         </div><div class="line">00023837    00 00 b7 64 00 00 c8 a5  00 00 d7 d8 00 00 e4 a5       d            </div><div class="line">00023838    00 00 ec 5f 00 00 f8 5f  00 01 04 41 00 01 1f c3       _   _   A    </div><div class="line">00023839    00 01 51 85 00 01 84 7e  00 01 cc a6 00 02 03 c0      Q    ~        </div><div class="line">00023840    00 02 3c 52 00 02 66 75  00 02 8a 1c 00 02 b4 a6      &lt;R  fu        </div><div class="line">00023841    00 02 e7 66 00 03 23 01  00 03 5d ac 00 03 9e 97       f  #   ]     </div><div class="line">00023842    00 03 ea 64 00 04 26 0a  00 04 3e 69 00 04 4c ff       d  &amp;   &gt;i  L </div><div class="line">00023843    00 04 63 d9 00 04 7e 43  00 04 98 9b 00 04 ad a9      c   ~C        </div><div class="line">00023844    00 04 be f7 00 04 d7 94  00 04 ed 6c 00 05 0e 3b               l   ;</div><div class="line">00023845    00 05 2d c9 00 05 59 f0  00 05 7b 82 00 05 95 2b      -   Y   &#123;    +</div><div class="line">00023846    00 05 b3 da 00 05 c6 67  00 00 00 14 73 74 73 73           g    stss</div><div class="line">00023847    00 00 00 00 00 00 00 01  00 00 00 01 00 00 00 b2                    </div><div class="line">00023848    73 64 74 70 00 00 00 00  04 44 44 44 44 44 44 44    sdtp     DDDDDDD</div><div class="line">00023849    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023850    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023851    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023852    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023853    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023854    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023855    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023856    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023857    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023858    44 44 44 44 44 44 44 44  44 44 44 44 44 44 00 00    DDDDDDDDDDDDDD  </div><div class="line">00023859    06 7e 74 72 61 6b 00 00  00 5c 74 6b 68 64 00 00     ~trak   \tkhd  </div><div class="line">00023860    00 03 c7 ca ee a7 c7 ca  ee a8 00 00 00 02 00 00                    </div><div class="line">00023861    00 00 00 07 a5 80 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023862    00 00 01 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023863    00 00 00 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023864    00 00 00 00 00 00 40 00  00 00 00 00 00 00 00 00          @         </div><div class="line">00023865    00 00 00 00 06 04 6d 64  69 61 00 00 00 20 6d 64          mdia    md</div><div class="line">00023866    68 64 00 00 00 00 c7 ca  ee a7 c7 ca ee a8 00 00    hd              </div><div class="line">00023867    bb 80 00 04 14 00 15 c7  00 00 00 00 00 21 68 64                 !hd</div><div class="line">00023868    6c 72 00 00 00 00 00 00  00 00 73 6f 75 6e 00 00    lr        soun  </div><div class="line">00023869    00 00 00 00 00 00 00 00  00 00 00 00 00 05 bb 6d                   m</div><div class="line">00023870    69 6e 66 00 00 00 10 73  6d 68 64 00 00 00 00 00    inf    smhd     </div><div class="line">00023871    00 00 00 00 00 00 24 64  69 6e 66 00 00 00 1c 64          $dinf    d</div><div class="line">00023872    72 65 66 00 00 00 00 00  00 00 01 00 00 00 0c 75    ref            u</div><div class="line">00023873    72 6c 20 00 00 00 01 00  00 05 7f 73 74 62 6c 00    rl         stbl </div><div class="line">00023874    00 00 67 73 74 73 64 00  00 00 00 00 00 00 01 00      gstsd         </div><div class="line">00023875    00 00 57 6d 70 34 61 00  00 00 00 00 00 00 01 00      Wmp4a         </div><div class="line">00023876    00 00 00 00 00 00 00 00  01 00 10 00 00 00 00 bb                    </div><div class="line">00023877    80 00 00 00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02 00 00  00 18 73 74 74 73 00 00              stts  </div><div class="line">00023881    00 00 00 00 00 01 00 00  01 05 00 00 04 00 00 00                    </div><div class="line">00023882    04 28 73 74 73 7a 00 00  00 00 00 00 00 00 00 00     (stsz          </div><div class="line">00023883    01 05 00 00 00 f7 00 00  00 db 00 00 00 e1 00 00                    </div><div class="line">00023884    00 e5 00 00 00 e9 00 00  00 e8 00 00 00 f0 00 00                    </div><div class="line">00023885    00 f1 00 00 00 ef 00 00  00 d8 00 00 00 e6 00 00                    </div><div class="line">00023886    00 e7 00 00 00 e9 00 00  00 eb 00 00 00 ea 00 00                    </div><div class="line">00023887    00 e8 00 00 00 e1 00 00  00 e7 00 00 00 d7 00 00                    </div><div class="line">00023888    00 da 00 00 00 d9 00 00  00 db 00 00 00 e9 00 00                    </div><div class="line">00023889    00 ee 00 00 00 e5 00 00  00 e1 00 00 00 e6 00 00                    </div><div class="line">00023890    00 e5 00 00 00 d8 00 00  00 dd 00 00 00 dd 00 00                    </div><div class="line">00023891    00 d5 00 00 00 ea 00 00  00 dd 00 00 00 d0 00 00                    </div><div class="line">00023892    00 d6 00 00 00 e9 00 00  00 bc 00 00 00 ab 00 00                    </div><div class="line">00023893    00 b3 00 00 00 b5 00 00  00 bc 00 00 00 ce 00 00                    </div><div class="line">00023894    00 b4 00 00 00 b6 00 00  00 b3 00 00 00 b6 00 00                    </div><div class="line">00023895    00 b7 00 00 00 bf 00 00  00 b7 00 00 00 cd 00 00                    </div><div class="line">00023896    00 c1 00 00 00 ba 00 00  00 a7 00 00 00 b4 00 00                    </div><div class="line">00023897    00 b1 00 00 00 be 00 00  00 d0 00 00 00 ba 00 00                    </div><div class="line">00023898    00 bc 00 00 00 c4 00 00  00 c6 00 00 00 cb 00 00                    </div><div class="line">00023899    00 c4 00 00 00 c3 00 00  00 c8 00 00 00 d2 00 00                    </div><div class="line">00023900    00 d2 00 00 00 d6 00 00  00 f5 00 00 00 fa 00 00                    </div><div class="line">00023901    00 f6 00 00 01 02 00 00  00 fc 00 00 00 fc 00 00                    </div><div class="line">00023902    00 ee 00 00 00 e6 00 00  00 ea 00 00 00 ea 00 00                    </div><div class="line">00023903    00 e8 00 00 00 de 00 00  00 df 00 00 00 e7 00 00                    </div><div class="line">00023904    00 f6 00 00 00 ff 00 00  01 03 00 00 00 f6 00 00                    </div><div class="line">00023905    01 08 00 00 01 03 00 00  00 fd 00 00 01 05 00 00                    </div><div class="line">00023906    01 02 00 00 01 00 00 00  01 14 00 00 01 18 00 00                    </div><div class="line">00023907    00 fd 00 00 00 fb 00 00  01 11 00 00 01 05 00 00                    </div><div class="line">00023908    01 05 00 00 01 0a 00 00  01 01 00 00 00 f3 00 00                    </div><div class="line">00023909    00 f7 00 00 00 f7 00 00  01 01 00 00 01 02 00 00                    </div><div class="line">00023910    00 f8 00 00 00 f8 00 00  00 ef 00 00 00 ed 00 00                    </div><div class="line">00023911    00 e3 00 00 00 ec 00 00  00 e2 00 00 00 e8 00 00                    </div><div class="line">00023912    00 dc 00 00 00 e0 00 00  00 f3 00 00 00 df 00 00                    </div><div class="line">00023913    00 e1 00 00 00 cf 00 00  00 ce 00 00 00 d8 00 00                    </div><div class="line">00023914    00 ce 00 00 00 c7 00 00  00 cd 00 00 00 b7 00 00                    </div><div class="line">00023915    00 af 00 00 00 c8 00 00  00 d7 00 00 00 e5 00 00                    </div><div class="line">00023916    00 e4 00 00 00 c6 00 00  00 d1 00 00 00 d5 00 00                    </div><div class="line">00023917    00 e5 00 00 00 d8 00 00  00 c8 00 00 00 be 00 00                    </div><div class="line">00023918    00 bf 00 00 00 cb 00 00  00 d2 00 00 00 c8 00 00                    </div><div class="line">00023919    00 ca 00 00 00 b1 00 00  00 a3 00 00 00 c7 00 00                    </div><div class="line">00023920    00 dc 00 00 00 d9 00 00  00 dd 00 00 00 d1 00 00                    </div><div class="line">00023921    00 d2 00 00 00 c2 00 00  00 bc 00 00 00 b1 00 00                    </div><div class="line">00023922    00 9b 00 00 00 89 00 00  00 a2 00 00 00 9f 00 00                    </div><div class="line">00023923    00 b5 00 00 00 a6 00 00  00 b2 00 00 00 b5 00 00                    </div><div class="line">00023924    00 ae 00 00 00 b4 00 00  00 b0 00 00 00 c6 00 00                    </div><div class="line">00023925    00 c3 00 00 00 d5 00 00  00 e4 00 00 00 f6 00 00                    </div><div class="line">00023926    00 d6 00 00 00 db 00 00  00 cc 00 00 00 e7 00 00                    </div><div class="line">00023927    00 f9 00 00 00 cb 00 00  00 d8 00 00 00 d6 00 00                    </div><div class="line">00023928    00 e4 00 00 00 f1 00 00  00 e4 00 00 00 e6 00 00                    </div><div class="line">00023929    00 df 00 00 00 ee 00 00  00 d7 00 00 00 c7 00 00                    </div><div class="line">00023930    00 e7 00 00 00 f9 00 00  00 ed 00 00 00 cf 00 00                    </div><div class="line">00023931    00 f1 00 00 00 e6 00 00  00 dc 00 00 00 e4 00 00                    </div><div class="line">00023932    00 ef 00 00 00 e5 00 00  00 f1 00 00 00 e3 00 00                    </div><div class="line">00023933    00 ec 00 00 00 ec 00 00  00 f3 00 00 00 f5 00 00                    </div><div class="line">00023934    00 fd 00 00 01 0b 00 00  01 10 00 00 01 11 00 00                    </div><div class="line">00023935    01 03 00 00 01 01 00 00  00 fb 00 00 00 fa 00 00                    </div><div class="line">00023936    00 e7 00 00 00 e5 00 00  00 f0 00 00 00 d2 00 00                    </div><div class="line">00023937    00 e5 00 00 00 f3 00 00  00 f1 00 00 00 f2 00 00                    </div><div class="line">00023938    00 ff 00 00 00 f7 00 00  00 ee 00 00 00 d5 00 00                    </div><div class="line">00023939    00 d9 00 00 00 ea 00 00  00 e3 00 00 00 df 00 00                    </div><div class="line">00023940    00 f7 00 00 00 ff 00 00  00 f8 00 00 00 fa 00 00                    </div><div class="line">00023941    00 fd 00 00 00 f7 00 00  00 f9 00 00 00 fb 00 00                    </div><div class="line">00023942    00 f8 00 00 00 f6 00 00  00 f0 00 00 00 fe 00 00                    </div><div class="line">00023943    01 02 00 00 00 e9 00 00  00 ec 00 00 00 ec 00 00                    </div><div class="line">00023944    00 e7 00 00 00 ea 00 00  00 de 00 00 00 e2 00 00                    </div><div class="line">00023945    00 c9 00 00 00 d4 00 00  00 d4 00 00 00 c7 00 00                    </div><div class="line">00023946    00 c9 00 00 00 c8 00 00  00 c1 00 00 00 c0 00 00                    </div><div class="line">00023947    00 bd 00 00 00 de 00 00  00 cb 00 00 00 cd 00 00                    </div><div class="line">00023948    00 d4 00 00 00 6d 00 00  00 28 73 74 73 63 00 00         m   (stsc  </div><div class="line">00023949    00 00 00 00 00 02 00 00  00 01 00 00 00 07 00 00                    </div><div class="line">00023950    00 01 00 00 00 26 00 00  00 02 00 00 00 01 00 00         &amp;          </div><div class="line">00023951    00 a8 73 74 63 6f 00 00  00 00 00 00 00 26 00 00      stco       &amp;  </div><div class="line">00023952    6d 8d 00 00 85 9b 00 00  9d e4 00 00 b1 21 00 00    m            !  </div><div class="line">00023953    c2 a7 00 00 d2 8e 00 00  df 8e 00 00 f3 54 00 00                 T  </div><div class="line">00023954    fe e8 00 01 1a 05 00 01  4a c7 00 01 7e 28 00 01            J   ~(  </div><div class="line">00023955    c5 a1 00 01 fc 89 00 02  35 5c 00 02 83 6a 00 02            5\   j  </div><div class="line">00023956    ae 62 00 02 e1 ae 00 03  1d 6d 00 03 58 04 00 03     b       m  X   </div><div class="line">00023957    99 4d 00 03 e4 b1 00 04  21 99 00 04 39 67 00 04     M      !   9g  </div><div class="line">00023958    5d c6 00 04 78 18 00 04  92 6a 00 04 a7 67 00 04    ]   x    j   g  </div><div class="line">00023959    b8 7e 00 04 d0 6c 00 04  e7 0c 00 05 07 c6 00 05     ~   l          </div><div class="line">00023960    53 5c 00 05 74 bc 00 05  8e 99 00 05 ae 19 00 05    S\  t           </div><div class="line">00023961    c0 eb 00 05 cb 47 00 00  00 16 75 64 74 61 00 00         G    udta  </div><div class="line">00023962    00 0e 6e 61 6d 65 53 74  65 72 65 6f 00 00 00 6f      nameStereo   o</div><div class="line">00023963    75 64 74 61 00 00 00 67  6d 65 74 61 00 00 00 00    udta   gmeta    </div><div class="line">00023964    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023965    6d 64 69 72 00 00 00 00  00 00 00 00 00 00 00 00    mdir            </div><div class="line">00023966    00 00 00 00 3a 69 6c 73  74 00 00 00 32 a9 74 6f        :ilst   2 to</div><div class="line">00023967    6f 00 00 00 2a 64 61 74  61 00 00 00 01 00 00 00    o   *data       </div><div class="line">00023968    00 48 61 6e 64 42 72 61  6b 65 20 30 2e 39 2e 34     HandBrake 0.9.4</div><div class="line">00023969    20 32 30 30 39 31 31 32  33 30 30                    2009112300</div></pre></td></tr></table></figure><p>####### <strong>stsd</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">00023777                                00 00 00 ab 73 74 73                 sts</div><div class="line">00023778    64 00 00 00 00 00 00 00  01 00 00 00 9b 61 76 63    d            avc</div><div class="line">00023779    31 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00    1               </div><div class="line">00023780    00 00 00 00 00 00 00 00  00 02 30 01 40 00 48 00              0 @ H </div><div class="line">00023781    00 00 48 00 00 00 00 00  00 00 01 0e 4a 56 54 2f      H         JVT/</div><div class="line">00023782    41 56 43 20 43 6f 64 69  6e 67 00 00 00 00 00 00    AVC Coding      </div><div class="line">00023783    00 00 00 00 00 00 00 00  00 00 00 00 18 ff ff 00                    </div><div class="line">00023784    00 00 33 61 76 63 43 01  42 c0 1e ff e1 00 1b 67      3avcC B      g</div><div class="line">00023785    42 c0 1e 9e 21 81 18 53  4d 40 40 40 50 00 00 03    B   !  SM@@@P   </div><div class="line">00023786    00 10 00 00 03 03 c8 f1  62 ee 01 00 05 68 ce 06            b    h  </div><div class="line">00023787    cb 20 00 00 00 12 63 6f  6c 72 6e 63 6c 63 00 01          colrnclc  </div><div class="line">00023788    00 01 00 01</div></pre></td></tr></table></figure><p>####### <strong>stts</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00023788                00 00 00 18  73 74 74 73 00 00 00 00            stts    </div><div class="line">00023789    00 00 00 01 00 00 00 a6  00 00 0b b8 </div></pre></td></tr></table></figure><p>####### <strong>stsz</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">00023789                                         00 00 02 ac                    </div><div class="line">00023790    73 74 73 7a 00 00 00 00  00 00 00 00 00 00 00 a6    stsz            </div><div class="line">00023791    00 00 56 27 00 00 0b 20  00 00 05 bc 00 00 05 e2      V'            </div><div class="line">00023792    00 00 05 c1 00 00 04 37  00 00 04 07 00 00 03 b6           7        </div><div class="line">00023793    00 00 06 45 00 00 03 73  00 00 05 12 00 00 03 26       E   s       &amp;</div><div class="line">00023794    00 00 02 e9 00 00 03 7b  00 00 03 4a 00 00 03 6b           &#123;   J   k</div><div class="line">00023795    00 00 02 b6 00 00 03 4c  00 00 02 7a 00 00 02 c7           L   z    </div><div class="line">00023796    00 00 02 2e 00 00 03 16  00 00 02 26 00 00 02 7f       .       &amp;    </div><div class="line">00023797    00 00 01 ec 00 00 01 ea  00 00 01 f5 00 00 01 eb                    </div><div class="line">00023798    00 00 01 fa 00 00 01 e7  00 00 01 fc 00 00 01 dd                    </div><div class="line">00023799    00 00 01 c6 00 00 01 ae  00 00 01 c8 00 00 01 b9                    </div><div class="line">00023800    00 00 01 90 00 00 01 93  00 00 01 8c 00 00 01 da                    </div><div class="line">00023801    00 00 01 c2 00 00 05 d0  00 00 07 b8 00 00 06 7a                   z</div><div class="line">00023802    00 00 09 a9 00 00 0a 2c  00 00 0a 7c 00 00 0c b3           ,   |    </div><div class="line">00023803    00 00 09 8c 00 00 09 52  00 00 0c 04 00 00 0d c1           R        </div><div class="line">00023804    00 00 0f 74 00 00 10 48  00 00 11 06 00 00 10 61       t   H       a</div><div class="line">00023805    00 00 0c 63 00 00 0c 31  00 00 0b 42 00 00 0c 0d       c   1   B    </div><div class="line">00023806    00 00 0f 32 00 00 0a 7b  00 00 0d 0f 00 00 0a e0       2   &#123;        </div><div class="line">00023807    00 00 0a 0e 00 00 0b 6b  00 00 08 74 00 00 0c 36           k   t   6</div><div class="line">00023808    00 00 09 e6 00 00 06 8d  00 00 04 f8 00 00 07 8a                    </div><div class="line">00023809    00 00 07 c1 00 00 09 f3  00 00 07 c7 00 00 0a cb                    </div><div class="line">00023810    00 00 0a d2 00 00 0b 74  00 00 0c 28 00 00 0a 9a           t   (    </div><div class="line">00023811    00 00 0c 60 00 00 0d 6d  00 00 0c 3e 00 00 0f fc       `   m   &gt;    </div><div class="line">00023812    00 00 0e 82 00 00 0b 79  00 00 0d e4 00 00 0d 24           y       $</div><div class="line">00023813    00 00 0a 17 00 00 11 aa  00 00 12 65 00 00 0d 7b               e   &#123;</div><div class="line">00023814    00 00 12 a0 00 00 13 d8  00 00 11 49 00 00 0e 59               I   Y</div><div class="line">00023815    00 00 10 15 00 00 16 81  00 00 09 b4 00 00 06 eb                    </div><div class="line">00023816    00 00 05 ef 00 00 05 8a  00 00 03 d7 00 00 04 0d                    </div><div class="line">00023817    00 00 03 bb 00 00 04 6b  00 00 03 40 00 00 03 30           k   @   0</div><div class="line">00023818    00 00 02 de 00 00 03 ae  00 00 05 cf 00 00 04 6c                   l</div><div class="line">00023819    00 00 05 69 00 00 05 00  00 00 06 a1 00 00 03 35       i           5</div><div class="line">00023820    00 00 04 1a 00 00 03 fa  00 00 06 3d 00 00 05 d6               =    </div><div class="line">00023821    00 00 04 68 00 00 02 d6  00 00 04 b5 00 00 02 d9       h            </div><div class="line">00023822    00 00 02 7f 00 00 02 4d  00 00 02 7d 00 00 03 8c           M   &#125;    </div><div class="line">00023823    00 00 02 06 00 00 02 01  00 00 07 7f 00 00 05 ef                    </div><div class="line">00023824    00 00 05 b8 00 00 04 0a  00 00 02 99 00 00 03 1d                    </div><div class="line">00023825    00 00 07 c5 00 00 05 ac  00 00 04 78 00 00 08 71               x   q</div><div class="line">00023826    00 00 08 99 00 00 08 e9  00 00 08 99 00 00 05 73                   s</div><div class="line">00023827    00 00 07 c7 00 00 08 3d  00 00 0b 59 00 00 0a 36           =   Y   6</div><div class="line">00023828    00 00 06 ba 00 00 05 f9  00 00 07 2e 00 00 06 eb               .    </div><div class="line">00023829    00 00 04 c6 00 00 04 ba  00 00 05 66 00 00 04 31               f   1</div><div class="line">00023830    00 00 06 8a 00 00 06 cf  00 00 06 fe 00 00 04 97                    </div><div class="line">00023831    00 00 02 43 00 00 03 e2  00 00 04 06 00 00 02 e6       C            </div><div class="line">00023832    00 00 02 6b 00 00 02 75                                k   u</div></pre></td></tr></table></figure><p>####### <strong>stsc</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023832                             00 00 00 28 73 74 73 63               (stsc</div><div class="line">00023833    00 00 00 00 00 00 00 02  00 00 00 01 00 00 00 04                    </div><div class="line">00023834    00 00 00 01 00 00 00 2a  00 00 00 02 00 00 00 01           *        </div></pre></td></tr></table></figure><p>####### <strong>stco</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">00023835    00 00 00 b8 73 74 63 6f  00 00 00 00 00 00 00 2a        stco       *</div><div class="line">00023836    00 00 00 a8 00 00 73 e6  00 00 8b f4 00 00 a4 08          s         </div><div class="line">00023837    00 00 b7 64 00 00 c8 a5  00 00 d7 d8 00 00 e4 a5       d            </div><div class="line">00023838    00 00 ec 5f 00 00 f8 5f  00 01 04 41 00 01 1f c3       _   _   A    </div><div class="line">00023839    00 01 51 85 00 01 84 7e  00 01 cc a6 00 02 03 c0      Q    ~        </div><div class="line">00023840    00 02 3c 52 00 02 66 75  00 02 8a 1c 00 02 b4 a6      &lt;R  fu        </div><div class="line">00023841    00 02 e7 66 00 03 23 01  00 03 5d ac 00 03 9e 97       f  #   ]     </div><div class="line">00023842    00 03 ea 64 00 04 26 0a  00 04 3e 69 00 04 4c ff       d  &amp;   &gt;i  L </div><div class="line">00023843    00 04 63 d9 00 04 7e 43  00 04 98 9b 00 04 ad a9      c   ~C        </div><div class="line">00023844    00 04 be f7 00 04 d7 94  00 04 ed 6c 00 05 0e 3b               l   ;</div><div class="line">00023845    00 05 2d c9 00 05 59 f0  00 05 7b 82 00 05 95 2b      -   Y   &#123;    +</div><div class="line">00023846    00 05 b3 da 00 05 c6 67                                    g</div></pre></td></tr></table></figure><p>####### <strong>stss</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00023846                             00 00 00 14 73 74 73 73                stss</div><div class="line">00023847    00 00 00 00 00 00 00 01  00 00 00 01</div></pre></td></tr></table></figure><p>####### <strong>sdtp</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">00023847                                         00 00 00 b2                    </div><div class="line">00023848    73 64 74 70 00 00 00 00  04 44 44 44 44 44 44 44    sdtp     DDDDDDD</div><div class="line">00023849    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023850    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023851    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023852    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023853    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023854    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023855    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023856    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023857    44 44 44 44 44 44 44 44  44 44 44 44 44 44 44 44    DDDDDDDDDDDDDDDD</div><div class="line">00023858    44 44 44 44 44 44 44 44  44 44 44 44 44 44          DDDDDDDDDDDDDD</div></pre></td></tr></table></figure><h3 id="trak-1"><a href="#trak-1" class="headerlink" title="trak"></a><strong>trak</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line">00023858                                               00 00    </div><div class="line">00023859    06 7e 74 72 61 6b 00 00  00 5c 74 6b 68 64 00 00     ~trak   \tkhd  </div><div class="line">00023860    00 03 c7 ca ee a7 c7 ca  ee a8 00 00 00 02 00 00                    </div><div class="line">00023861    00 00 00 07 a5 80 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023862    00 00 01 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023863    00 00 00 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023864    00 00 00 00 00 00 40 00  00 00 00 00 00 00 00 00          @         </div><div class="line">00023865    00 00 00 00 06 04 6d 64  69 61 00 00 00 20 6d 64          mdia    md</div><div class="line">00023866    68 64 00 00 00 00 c7 ca  ee a7 c7 ca ee a8 00 00    hd              </div><div class="line">00023867    bb 80 00 04 14 00 15 c7  00 00 00 00 00 21 68 64                 !hd</div><div class="line">00023868    6c 72 00 00 00 00 00 00  00 00 73 6f 75 6e 00 00    lr        soun  </div><div class="line">00023869    00 00 00 00 00 00 00 00  00 00 00 00 00 05 bb 6d                   m</div><div class="line">00023870    69 6e 66 00 00 00 10 73  6d 68 64 00 00 00 00 00    inf    smhd     </div><div class="line">00023871    00 00 00 00 00 00 24 64  69 6e 66 00 00 00 1c 64          $dinf    d</div><div class="line">00023872    72 65 66 00 00 00 00 00  00 00 01 00 00 00 0c 75    ref            u</div><div class="line">00023873    72 6c 20 00 00 00 01 00  00 05 7f 73 74 62 6c 00    rl         stbl </div><div class="line">00023874    00 00 67 73 74 73 64 00  00 00 00 00 00 00 01 00      gstsd         </div><div class="line">00023875    00 00 57 6d 70 34 61 00  00 00 00 00 00 00 01 00      Wmp4a         </div><div class="line">00023876    00 00 00 00 00 00 00 00  01 00 10 00 00 00 00 bb                    </div><div class="line">00023877    80 00 00 00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02 00 00  00 18 73 74 74 73 00 00              stts  </div><div class="line">00023881    00 00 00 00 00 01 00 00  01 05 00 00 04 00 00 00                    </div><div class="line">00023882    04 28 73 74 73 7a 00 00  00 00 00 00 00 00 00 00     (stsz          </div><div class="line">00023883    01 05 00 00 00 f7 00 00  00 db 00 00 00 e1 00 00                    </div><div class="line">00023884    00 e5 00 00 00 e9 00 00  00 e8 00 00 00 f0 00 00                    </div><div class="line">00023885    00 f1 00 00 00 ef 00 00  00 d8 00 00 00 e6 00 00                    </div><div class="line">00023886    00 e7 00 00 00 e9 00 00  00 eb 00 00 00 ea 00 00                    </div><div class="line">00023887    00 e8 00 00 00 e1 00 00  00 e7 00 00 00 d7 00 00                    </div><div class="line">00023888    00 da 00 00 00 d9 00 00  00 db 00 00 00 e9 00 00                    </div><div class="line">00023889    00 ee 00 00 00 e5 00 00  00 e1 00 00 00 e6 00 00                    </div><div class="line">00023890    00 e5 00 00 00 d8 00 00  00 dd 00 00 00 dd 00 00                    </div><div class="line">00023891    00 d5 00 00 00 ea 00 00  00 dd 00 00 00 d0 00 00                    </div><div class="line">00023892    00 d6 00 00 00 e9 00 00  00 bc 00 00 00 ab 00 00                    </div><div class="line">00023893    00 b3 00 00 00 b5 00 00  00 bc 00 00 00 ce 00 00                    </div><div class="line">00023894    00 b4 00 00 00 b6 00 00  00 b3 00 00 00 b6 00 00                    </div><div class="line">00023895    00 b7 00 00 00 bf 00 00  00 b7 00 00 00 cd 00 00                    </div><div class="line">00023896    00 c1 00 00 00 ba 00 00  00 a7 00 00 00 b4 00 00                    </div><div class="line">00023897    00 b1 00 00 00 be 00 00  00 d0 00 00 00 ba 00 00                    </div><div class="line">00023898    00 bc 00 00 00 c4 00 00  00 c6 00 00 00 cb 00 00                    </div><div class="line">00023899    00 c4 00 00 00 c3 00 00  00 c8 00 00 00 d2 00 00                    </div><div class="line">00023900    00 d2 00 00 00 d6 00 00  00 f5 00 00 00 fa 00 00                    </div><div class="line">00023901    00 f6 00 00 01 02 00 00  00 fc 00 00 00 fc 00 00                    </div><div class="line">00023902    00 ee 00 00 00 e6 00 00  00 ea 00 00 00 ea 00 00                    </div><div class="line">00023903    00 e8 00 00 00 de 00 00  00 df 00 00 00 e7 00 00                    </div><div class="line">00023904    00 f6 00 00 00 ff 00 00  01 03 00 00 00 f6 00 00                    </div><div class="line">00023905    01 08 00 00 01 03 00 00  00 fd 00 00 01 05 00 00                    </div><div class="line">00023906    01 02 00 00 01 00 00 00  01 14 00 00 01 18 00 00                    </div><div class="line">00023907    00 fd 00 00 00 fb 00 00  01 11 00 00 01 05 00 00                    </div><div class="line">00023908    01 05 00 00 01 0a 00 00  01 01 00 00 00 f3 00 00                    </div><div class="line">00023909    00 f7 00 00 00 f7 00 00  01 01 00 00 01 02 00 00                    </div><div class="line">00023910    00 f8 00 00 00 f8 00 00  00 ef 00 00 00 ed 00 00                    </div><div class="line">00023911    00 e3 00 00 00 ec 00 00  00 e2 00 00 00 e8 00 00                    </div><div class="line">00023912    00 dc 00 00 00 e0 00 00  00 f3 00 00 00 df 00 00                    </div><div class="line">00023913    00 e1 00 00 00 cf 00 00  00 ce 00 00 00 d8 00 00                    </div><div class="line">00023914    00 ce 00 00 00 c7 00 00  00 cd 00 00 00 b7 00 00                    </div><div class="line">00023915    00 af 00 00 00 c8 00 00  00 d7 00 00 00 e5 00 00                    </div><div class="line">00023916    00 e4 00 00 00 c6 00 00  00 d1 00 00 00 d5 00 00                    </div><div class="line">00023917    00 e5 00 00 00 d8 00 00  00 c8 00 00 00 be 00 00                    </div><div class="line">00023918    00 bf 00 00 00 cb 00 00  00 d2 00 00 00 c8 00 00                    </div><div class="line">00023919    00 ca 00 00 00 b1 00 00  00 a3 00 00 00 c7 00 00                    </div><div class="line">00023920    00 dc 00 00 00 d9 00 00  00 dd 00 00 00 d1 00 00                    </div><div class="line">00023921    00 d2 00 00 00 c2 00 00  00 bc 00 00 00 b1 00 00                    </div><div class="line">00023922    00 9b 00 00 00 89 00 00  00 a2 00 00 00 9f 00 00                    </div><div class="line">00023923    00 b5 00 00 00 a6 00 00  00 b2 00 00 00 b5 00 00                    </div><div class="line">00023924    00 ae 00 00 00 b4 00 00  00 b0 00 00 00 c6 00 00                    </div><div class="line">00023925    00 c3 00 00 00 d5 00 00  00 e4 00 00 00 f6 00 00                    </div><div class="line">00023926    00 d6 00 00 00 db 00 00  00 cc 00 00 00 e7 00 00                    </div><div class="line">00023927    00 f9 00 00 00 cb 00 00  00 d8 00 00 00 d6 00 00                    </div><div class="line">00023928    00 e4 00 00 00 f1 00 00  00 e4 00 00 00 e6 00 00                    </div><div class="line">00023929    00 df 00 00 00 ee 00 00  00 d7 00 00 00 c7 00 00                    </div><div class="line">00023930    00 e7 00 00 00 f9 00 00  00 ed 00 00 00 cf 00 00                    </div><div class="line">00023931    00 f1 00 00 00 e6 00 00  00 dc 00 00 00 e4 00 00                    </div><div class="line">00023932    00 ef 00 00 00 e5 00 00  00 f1 00 00 00 e3 00 00                    </div><div class="line">00023933    00 ec 00 00 00 ec 00 00  00 f3 00 00 00 f5 00 00                    </div><div class="line">00023934    00 fd 00 00 01 0b 00 00  01 10 00 00 01 11 00 00                    </div><div class="line">00023935    01 03 00 00 01 01 00 00  00 fb 00 00 00 fa 00 00                    </div><div class="line">00023936    00 e7 00 00 00 e5 00 00  00 f0 00 00 00 d2 00 00                    </div><div class="line">00023937    00 e5 00 00 00 f3 00 00  00 f1 00 00 00 f2 00 00                    </div><div class="line">00023938    00 ff 00 00 00 f7 00 00  00 ee 00 00 00 d5 00 00                    </div><div class="line">00023939    00 d9 00 00 00 ea 00 00  00 e3 00 00 00 df 00 00                    </div><div class="line">00023940    00 f7 00 00 00 ff 00 00  00 f8 00 00 00 fa 00 00                    </div><div class="line">00023941    00 fd 00 00 00 f7 00 00  00 f9 00 00 00 fb 00 00                    </div><div class="line">00023942    00 f8 00 00 00 f6 00 00  00 f0 00 00 00 fe 00 00                    </div><div class="line">00023943    01 02 00 00 00 e9 00 00  00 ec 00 00 00 ec 00 00                    </div><div class="line">00023944    00 e7 00 00 00 ea 00 00  00 de 00 00 00 e2 00 00                    </div><div class="line">00023945    00 c9 00 00 00 d4 00 00  00 d4 00 00 00 c7 00 00                    </div><div class="line">00023946    00 c9 00 00 00 c8 00 00  00 c1 00 00 00 c0 00 00                    </div><div class="line">00023947    00 bd 00 00 00 de 00 00  00 cb 00 00 00 cd 00 00                    </div><div class="line">00023948    00 d4 00 00 00 6d 00 00  00 28 73 74 73 63 00 00         m   (stsc  </div><div class="line">00023949    00 00 00 00 00 02 00 00  00 01 00 00 00 07 00 00                    </div><div class="line">00023950    00 01 00 00 00 26 00 00  00 02 00 00 00 01 00 00         &amp;          </div><div class="line">00023951    00 a8 73 74 63 6f 00 00  00 00 00 00 00 26 00 00      stco       &amp;  </div><div class="line">00023952    6d 8d 00 00 85 9b 00 00  9d e4 00 00 b1 21 00 00    m            !  </div><div class="line">00023953    c2 a7 00 00 d2 8e 00 00  df 8e 00 00 f3 54 00 00                 T  </div><div class="line">00023954    fe e8 00 01 1a 05 00 01  4a c7 00 01 7e 28 00 01            J   ~(  </div><div class="line">00023955    c5 a1 00 01 fc 89 00 02  35 5c 00 02 83 6a 00 02            5\   j  </div><div class="line">00023956    ae 62 00 02 e1 ae 00 03  1d 6d 00 03 58 04 00 03     b       m  X   </div><div class="line">00023957    99 4d 00 03 e4 b1 00 04  21 99 00 04 39 67 00 04     M      !   9g  </div><div class="line">00023958    5d c6 00 04 78 18 00 04  92 6a 00 04 a7 67 00 04    ]   x    j   g  </div><div class="line">00023959    b8 7e 00 04 d0 6c 00 04  e7 0c 00 05 07 c6 00 05     ~   l          </div><div class="line">00023960    53 5c 00 05 74 bc 00 05  8e 99 00 05 ae 19 00 05    S\  t           </div><div class="line">00023961    c0 eb 00 05 cb 47                                        G</div></pre></td></tr></table></figure><h4 id="tkhd-1"><a href="#tkhd-1" class="headerlink" title="tkhd"></a><strong>tkhd</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">00023859                      00 00  00 5c 74 6b 68 64 00 00             \tkhd  </div><div class="line">00023860    00 03 c7 ca ee a7 c7 ca  ee a8 00 00 00 02 00 00                    </div><div class="line">00023861    00 00 00 07 a5 80 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023862    00 00 01 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023863    00 00 00 00 00 00 00 01  00 00 00 00 00 00 00 00                    </div><div class="line">00023864    00 00 00 00 00 00 40 00  00 00 00 00 00 00 00 00          @         </div><div class="line">00023865    00 00</div></pre></td></tr></table></figure><h4 id="mdia-1"><a href="#mdia-1" class="headerlink" title="mdia"></a><strong>mdia</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line">00023865          00 00 06 04 6d 64  69 61 00 00 00 20 6d 64          mdia    md</div><div class="line">00023866    68 64 00 00 00 00 c7 ca  ee a7 c7 ca ee a8 00 00    hd              </div><div class="line">00023867    bb 80 00 04 14 00 15 c7  00 00 00 00 00 21 68 64                 !hd</div><div class="line">00023868    6c 72 00 00 00 00 00 00  00 00 73 6f 75 6e 00 00    lr        soun  </div><div class="line">00023869    00 00 00 00 00 00 00 00  00 00 00 00 00 05 bb 6d                   m</div><div class="line">00023870    69 6e 66 00 00 00 10 73  6d 68 64 00 00 00 00 00    inf    smhd     </div><div class="line">00023871    00 00 00 00 00 00 24 64  69 6e 66 00 00 00 1c 64          $dinf    d</div><div class="line">00023872    72 65 66 00 00 00 00 00  00 00 01 00 00 00 0c 75    ref            u</div><div class="line">00023873    72 6c 20 00 00 00 01 00  00 05 7f 73 74 62 6c 00    rl         stbl </div><div class="line">00023874    00 00 67 73 74 73 64 00  00 00 00 00 00 00 01 00      gstsd         </div><div class="line">00023875    00 00 57 6d 70 34 61 00  00 00 00 00 00 00 01 00      Wmp4a         </div><div class="line">00023876    00 00 00 00 00 00 00 00  01 00 10 00 00 00 00 bb                    </div><div class="line">00023877    80 00 00 00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02 00 00  00 18 73 74 74 73 00 00              stts  </div><div class="line">00023881    00 00 00 00 00 01 00 00  01 05 00 00 04 00 00 00                    </div><div class="line">00023882    04 28 73 74 73 7a 00 00  00 00 00 00 00 00 00 00     (stsz          </div><div class="line">00023883    01 05 00 00 00 f7 00 00  00 db 00 00 00 e1 00 00                    </div><div class="line">00023884    00 e5 00 00 00 e9 00 00  00 e8 00 00 00 f0 00 00                    </div><div class="line">00023885    00 f1 00 00 00 ef 00 00  00 d8 00 00 00 e6 00 00                    </div><div class="line">00023886    00 e7 00 00 00 e9 00 00  00 eb 00 00 00 ea 00 00                    </div><div class="line">00023887    00 e8 00 00 00 e1 00 00  00 e7 00 00 00 d7 00 00                    </div><div class="line">00023888    00 da 00 00 00 d9 00 00  00 db 00 00 00 e9 00 00                    </div><div class="line">00023889    00 ee 00 00 00 e5 00 00  00 e1 00 00 00 e6 00 00                    </div><div class="line">00023890    00 e5 00 00 00 d8 00 00  00 dd 00 00 00 dd 00 00                    </div><div class="line">00023891    00 d5 00 00 00 ea 00 00  00 dd 00 00 00 d0 00 00                    </div><div class="line">00023892    00 d6 00 00 00 e9 00 00  00 bc 00 00 00 ab 00 00                    </div><div class="line">00023893    00 b3 00 00 00 b5 00 00  00 bc 00 00 00 ce 00 00                    </div><div class="line">00023894    00 b4 00 00 00 b6 00 00  00 b3 00 00 00 b6 00 00                    </div><div class="line">00023895    00 b7 00 00 00 bf 00 00  00 b7 00 00 00 cd 00 00                    </div><div class="line">00023896    00 c1 00 00 00 ba 00 00  00 a7 00 00 00 b4 00 00                    </div><div class="line">00023897    00 b1 00 00 00 be 00 00  00 d0 00 00 00 ba 00 00                    </div><div class="line">00023898    00 bc 00 00 00 c4 00 00  00 c6 00 00 00 cb 00 00                    </div><div class="line">00023899    00 c4 00 00 00 c3 00 00  00 c8 00 00 00 d2 00 00                    </div><div class="line">00023900    00 d2 00 00 00 d6 00 00  00 f5 00 00 00 fa 00 00                    </div><div class="line">00023901    00 f6 00 00 01 02 00 00  00 fc 00 00 00 fc 00 00                    </div><div class="line">00023902    00 ee 00 00 00 e6 00 00  00 ea 00 00 00 ea 00 00                    </div><div class="line">00023903    00 e8 00 00 00 de 00 00  00 df 00 00 00 e7 00 00                    </div><div class="line">00023904    00 f6 00 00 00 ff 00 00  01 03 00 00 00 f6 00 00                    </div><div class="line">00023905    01 08 00 00 01 03 00 00  00 fd 00 00 01 05 00 00                    </div><div class="line">00023906    01 02 00 00 01 00 00 00  01 14 00 00 01 18 00 00                    </div><div class="line">00023907    00 fd 00 00 00 fb 00 00  01 11 00 00 01 05 00 00                    </div><div class="line">00023908    01 05 00 00 01 0a 00 00  01 01 00 00 00 f3 00 00                    </div><div class="line">00023909    00 f7 00 00 00 f7 00 00  01 01 00 00 01 02 00 00                    </div><div class="line">00023910    00 f8 00 00 00 f8 00 00  00 ef 00 00 00 ed 00 00                    </div><div class="line">00023911    00 e3 00 00 00 ec 00 00  00 e2 00 00 00 e8 00 00                    </div><div class="line">00023912    00 dc 00 00 00 e0 00 00  00 f3 00 00 00 df 00 00                    </div><div class="line">00023913    00 e1 00 00 00 cf 00 00  00 ce 00 00 00 d8 00 00                    </div><div class="line">00023914    00 ce 00 00 00 c7 00 00  00 cd 00 00 00 b7 00 00                    </div><div class="line">00023915    00 af 00 00 00 c8 00 00  00 d7 00 00 00 e5 00 00                    </div><div class="line">00023916    00 e4 00 00 00 c6 00 00  00 d1 00 00 00 d5 00 00                    </div><div class="line">00023917    00 e5 00 00 00 d8 00 00  00 c8 00 00 00 be 00 00                    </div><div class="line">00023918    00 bf 00 00 00 cb 00 00  00 d2 00 00 00 c8 00 00                    </div><div class="line">00023919    00 ca 00 00 00 b1 00 00  00 a3 00 00 00 c7 00 00                    </div><div class="line">00023920    00 dc 00 00 00 d9 00 00  00 dd 00 00 00 d1 00 00                    </div><div class="line">00023921    00 d2 00 00 00 c2 00 00  00 bc 00 00 00 b1 00 00                    </div><div class="line">00023922    00 9b 00 00 00 89 00 00  00 a2 00 00 00 9f 00 00                    </div><div class="line">00023923    00 b5 00 00 00 a6 00 00  00 b2 00 00 00 b5 00 00                    </div><div class="line">00023924    00 ae 00 00 00 b4 00 00  00 b0 00 00 00 c6 00 00                    </div><div class="line">00023925    00 c3 00 00 00 d5 00 00  00 e4 00 00 00 f6 00 00                    </div><div class="line">00023926    00 d6 00 00 00 db 00 00  00 cc 00 00 00 e7 00 00                    </div><div class="line">00023927    00 f9 00 00 00 cb 00 00  00 d8 00 00 00 d6 00 00                    </div><div class="line">00023928    00 e4 00 00 00 f1 00 00  00 e4 00 00 00 e6 00 00                    </div><div class="line">00023929    00 df 00 00 00 ee 00 00  00 d7 00 00 00 c7 00 00                    </div><div class="line">00023930    00 e7 00 00 00 f9 00 00  00 ed 00 00 00 cf 00 00                    </div><div class="line">00023931    00 f1 00 00 00 e6 00 00  00 dc 00 00 00 e4 00 00                    </div><div class="line">00023932    00 ef 00 00 00 e5 00 00  00 f1 00 00 00 e3 00 00                    </div><div class="line">00023933    00 ec 00 00 00 ec 00 00  00 f3 00 00 00 f5 00 00                    </div><div class="line">00023934    00 fd 00 00 01 0b 00 00  01 10 00 00 01 11 00 00                    </div><div class="line">00023935    01 03 00 00 01 01 00 00  00 fb 00 00 00 fa 00 00                    </div><div class="line">00023936    00 e7 00 00 00 e5 00 00  00 f0 00 00 00 d2 00 00                    </div><div class="line">00023937    00 e5 00 00 00 f3 00 00  00 f1 00 00 00 f2 00 00                    </div><div class="line">00023938    00 ff 00 00 00 f7 00 00  00 ee 00 00 00 d5 00 00                    </div><div class="line">00023939    00 d9 00 00 00 ea 00 00  00 e3 00 00 00 df 00 00                    </div><div class="line">00023940    00 f7 00 00 00 ff 00 00  00 f8 00 00 00 fa 00 00                    </div><div class="line">00023941    00 fd 00 00 00 f7 00 00  00 f9 00 00 00 fb 00 00                    </div><div class="line">00023942    00 f8 00 00 00 f6 00 00  00 f0 00 00 00 fe 00 00                    </div><div class="line">00023943    01 02 00 00 00 e9 00 00  00 ec 00 00 00 ec 00 00                    </div><div class="line">00023944    00 e7 00 00 00 ea 00 00  00 de 00 00 00 e2 00 00                    </div><div class="line">00023945    00 c9 00 00 00 d4 00 00  00 d4 00 00 00 c7 00 00                    </div><div class="line">00023946    00 c9 00 00 00 c8 00 00  00 c1 00 00 00 c0 00 00                    </div><div class="line">00023947    00 bd 00 00 00 de 00 00  00 cb 00 00 00 cd 00 00                    </div><div class="line">00023948    00 d4 00 00 00 6d 00 00  00 28 73 74 73 63 00 00         m   (stsc  </div><div class="line">00023949    00 00 00 00 00 02 00 00  00 01 00 00 00 07 00 00                    </div><div class="line">00023950    00 01 00 00 00 26 00 00  00 02 00 00 00 01 00 00         &amp;          </div><div class="line">00023951    00 a8 73 74 63 6f 00 00  00 00 00 00 00 26 00 00      stco       &amp;  </div><div class="line">00023952    6d 8d 00 00 85 9b 00 00  9d e4 00 00 b1 21 00 00    m            !  </div><div class="line">00023953    c2 a7 00 00 d2 8e 00 00  df 8e 00 00 f3 54 00 00                 T  </div><div class="line">00023954    fe e8 00 01 1a 05 00 01  4a c7 00 01 7e 28 00 01            J   ~(  </div><div class="line">00023955    c5 a1 00 01 fc 89 00 02  35 5c 00 02 83 6a 00 02            5\   j  </div><div class="line">00023956    ae 62 00 02 e1 ae 00 03  1d 6d 00 03 58 04 00 03     b       m  X   </div><div class="line">00023957    99 4d 00 03 e4 b1 00 04  21 99 00 04 39 67 00 04     M      !   9g  </div><div class="line">00023958    5d c6 00 04 78 18 00 04  92 6a 00 04 a7 67 00 04    ]   x    j   g  </div><div class="line">00023959    b8 7e 00 04 d0 6c 00 04  e7 0c 00 05 07 c6 00 05     ~   l          </div><div class="line">00023960    53 5c 00 05 74 bc 00 05  8e 99 00 05 ae 19 00 05    S\  t           </div><div class="line">00023961    c0 eb 00 05 cb 47                                        G</div></pre></td></tr></table></figure><h5 id="mdhd-1"><a href="#mdhd-1" class="headerlink" title="mdhd"></a><strong>mdhd</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023865                                   00 00 00 20 6d 64                  md</div><div class="line">00023866    68 64 00 00 00 00 c7 ca  ee a7 c7 ca ee a8 00 00    hd              </div><div class="line">00023867    bb 80 00 04 14 00 15 c7  00 00</div></pre></td></tr></table></figure><h5 id="hdlr-1"><a href="#hdlr-1" class="headerlink" title="hdlr"></a><strong>hdlr</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023867                                   00 00 00 21 68 64                 !hd</div><div class="line">00023868    6c 72 00 00 00 00 00 00  00 00 73 6f 75 6e 00 00    lr        soun  </div><div class="line">00023869    00 00 00 00 00 00 00 00  00 00 00</div></pre></td></tr></table></figure><h5 id="minf-1"><a href="#minf-1" class="headerlink" title="minf"></a><strong>minf</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line">00023869                                      00 00 05 bb 6d                   m</div><div class="line">00023870    69 6e 66 00 00 00 10 73  6d 68 64 00 00 00 00 00    inf    smhd     </div><div class="line">00023871    00 00 00 00 00 00 24 64  69 6e 66 00 00 00 1c 64          $dinf    d</div><div class="line">00023872    72 65 66 00 00 00 00 00  00 00 01 00 00 00 0c 75    ref            u</div><div class="line">00023873    72 6c 20 00 00 00 01 00  00 05 7f 73 74 62 6c 00    rl         stbl </div><div class="line">00023874    00 00 67 73 74 73 64 00  00 00 00 00 00 00 01 00      gstsd         </div><div class="line">00023875    00 00 57 6d 70 34 61 00  00 00 00 00 00 00 01 00      Wmp4a         </div><div class="line">00023876    00 00 00 00 00 00 00 00  01 00 10 00 00 00 00 bb                    </div><div class="line">00023877    80 00 00 00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02 00 00  00 18 73 74 74 73 00 00              stts  </div><div class="line">00023881    00 00 00 00 00 01 00 00  01 05 00 00 04 00 00 00                    </div><div class="line">00023882    04 28 73 74 73 7a 00 00  00 00 00 00 00 00 00 00     (stsz          </div><div class="line">00023883    01 05 00 00 00 f7 00 00  00 db 00 00 00 e1 00 00                    </div><div class="line">00023884    00 e5 00 00 00 e9 00 00  00 e8 00 00 00 f0 00 00                    </div><div class="line">00023885    00 f1 00 00 00 ef 00 00  00 d8 00 00 00 e6 00 00                    </div><div class="line">00023886    00 e7 00 00 00 e9 00 00  00 eb 00 00 00 ea 00 00                    </div><div class="line">00023887    00 e8 00 00 00 e1 00 00  00 e7 00 00 00 d7 00 00                    </div><div class="line">00023888    00 da 00 00 00 d9 00 00  00 db 00 00 00 e9 00 00                    </div><div class="line">00023889    00 ee 00 00 00 e5 00 00  00 e1 00 00 00 e6 00 00                    </div><div class="line">00023890    00 e5 00 00 00 d8 00 00  00 dd 00 00 00 dd 00 00                    </div><div class="line">00023891    00 d5 00 00 00 ea 00 00  00 dd 00 00 00 d0 00 00                    </div><div class="line">00023892    00 d6 00 00 00 e9 00 00  00 bc 00 00 00 ab 00 00                    </div><div class="line">00023893    00 b3 00 00 00 b5 00 00  00 bc 00 00 00 ce 00 00                    </div><div class="line">00023894    00 b4 00 00 00 b6 00 00  00 b3 00 00 00 b6 00 00                    </div><div class="line">00023895    00 b7 00 00 00 bf 00 00  00 b7 00 00 00 cd 00 00                    </div><div class="line">00023896    00 c1 00 00 00 ba 00 00  00 a7 00 00 00 b4 00 00                    </div><div class="line">00023897    00 b1 00 00 00 be 00 00  00 d0 00 00 00 ba 00 00                    </div><div class="line">00023898    00 bc 00 00 00 c4 00 00  00 c6 00 00 00 cb 00 00                    </div><div class="line">00023899    00 c4 00 00 00 c3 00 00  00 c8 00 00 00 d2 00 00                    </div><div class="line">00023900    00 d2 00 00 00 d6 00 00  00 f5 00 00 00 fa 00 00                    </div><div class="line">00023901    00 f6 00 00 01 02 00 00  00 fc 00 00 00 fc 00 00                    </div><div class="line">00023902    00 ee 00 00 00 e6 00 00  00 ea 00 00 00 ea 00 00                    </div><div class="line">00023903    00 e8 00 00 00 de 00 00  00 df 00 00 00 e7 00 00                    </div><div class="line">00023904    00 f6 00 00 00 ff 00 00  01 03 00 00 00 f6 00 00                    </div><div class="line">00023905    01 08 00 00 01 03 00 00  00 fd 00 00 01 05 00 00                    </div><div class="line">00023906    01 02 00 00 01 00 00 00  01 14 00 00 01 18 00 00                    </div><div class="line">00023907    00 fd 00 00 00 fb 00 00  01 11 00 00 01 05 00 00                    </div><div class="line">00023908    01 05 00 00 01 0a 00 00  01 01 00 00 00 f3 00 00                    </div><div class="line">00023909    00 f7 00 00 00 f7 00 00  01 01 00 00 01 02 00 00                    </div><div class="line">00023910    00 f8 00 00 00 f8 00 00  00 ef 00 00 00 ed 00 00                    </div><div class="line">00023911    00 e3 00 00 00 ec 00 00  00 e2 00 00 00 e8 00 00                    </div><div class="line">00023912    00 dc 00 00 00 e0 00 00  00 f3 00 00 00 df 00 00                    </div><div class="line">00023913    00 e1 00 00 00 cf 00 00  00 ce 00 00 00 d8 00 00                    </div><div class="line">00023914    00 ce 00 00 00 c7 00 00  00 cd 00 00 00 b7 00 00                    </div><div class="line">00023915    00 af 00 00 00 c8 00 00  00 d7 00 00 00 e5 00 00                    </div><div class="line">00023916    00 e4 00 00 00 c6 00 00  00 d1 00 00 00 d5 00 00                    </div><div class="line">00023917    00 e5 00 00 00 d8 00 00  00 c8 00 00 00 be 00 00                    </div><div class="line">00023918    00 bf 00 00 00 cb 00 00  00 d2 00 00 00 c8 00 00                    </div><div class="line">00023919    00 ca 00 00 00 b1 00 00  00 a3 00 00 00 c7 00 00                    </div><div class="line">00023920    00 dc 00 00 00 d9 00 00  00 dd 00 00 00 d1 00 00                    </div><div class="line">00023921    00 d2 00 00 00 c2 00 00  00 bc 00 00 00 b1 00 00                    </div><div class="line">00023922    00 9b 00 00 00 89 00 00  00 a2 00 00 00 9f 00 00                    </div><div class="line">00023923    00 b5 00 00 00 a6 00 00  00 b2 00 00 00 b5 00 00                    </div><div class="line">00023924    00 ae 00 00 00 b4 00 00  00 b0 00 00 00 c6 00 00                    </div><div class="line">00023925    00 c3 00 00 00 d5 00 00  00 e4 00 00 00 f6 00 00                    </div><div class="line">00023926    00 d6 00 00 00 db 00 00  00 cc 00 00 00 e7 00 00                    </div><div class="line">00023927    00 f9 00 00 00 cb 00 00  00 d8 00 00 00 d6 00 00                    </div><div class="line">00023928    00 e4 00 00 00 f1 00 00  00 e4 00 00 00 e6 00 00                    </div><div class="line">00023929    00 df 00 00 00 ee 00 00  00 d7 00 00 00 c7 00 00                    </div><div class="line">00023930    00 e7 00 00 00 f9 00 00  00 ed 00 00 00 cf 00 00                    </div><div class="line">00023931    00 f1 00 00 00 e6 00 00  00 dc 00 00 00 e4 00 00                    </div><div class="line">00023932    00 ef 00 00 00 e5 00 00  00 f1 00 00 00 e3 00 00                    </div><div class="line">00023933    00 ec 00 00 00 ec 00 00  00 f3 00 00 00 f5 00 00                    </div><div class="line">00023934    00 fd 00 00 01 0b 00 00  01 10 00 00 01 11 00 00                    </div><div class="line">00023935    01 03 00 00 01 01 00 00  00 fb 00 00 00 fa 00 00                    </div><div class="line">00023936    00 e7 00 00 00 e5 00 00  00 f0 00 00 00 d2 00 00                    </div><div class="line">00023937    00 e5 00 00 00 f3 00 00  00 f1 00 00 00 f2 00 00                    </div><div class="line">00023938    00 ff 00 00 00 f7 00 00  00 ee 00 00 00 d5 00 00                    </div><div class="line">00023939    00 d9 00 00 00 ea 00 00  00 e3 00 00 00 df 00 00                    </div><div class="line">00023940    00 f7 00 00 00 ff 00 00  00 f8 00 00 00 fa 00 00                    </div><div class="line">00023941    00 fd 00 00 00 f7 00 00  00 f9 00 00 00 fb 00 00                    </div><div class="line">00023942    00 f8 00 00 00 f6 00 00  00 f0 00 00 00 fe 00 00                    </div><div class="line">00023943    01 02 00 00 00 e9 00 00  00 ec 00 00 00 ec 00 00                    </div><div class="line">00023944    00 e7 00 00 00 ea 00 00  00 de 00 00 00 e2 00 00                    </div><div class="line">00023945    00 c9 00 00 00 d4 00 00  00 d4 00 00 00 c7 00 00                    </div><div class="line">00023946    00 c9 00 00 00 c8 00 00  00 c1 00 00 00 c0 00 00                    </div><div class="line">00023947    00 bd 00 00 00 de 00 00  00 cb 00 00 00 cd 00 00                    </div><div class="line">00023948    00 d4 00 00 00 6d 00 00  00 28 73 74 73 63 00 00         m   (stsc  </div><div class="line">00023949    00 00 00 00 00 02 00 00  00 01 00 00 00 07 00 00                    </div><div class="line">00023950    00 01 00 00 00 26 00 00  00 02 00 00 00 01 00 00         &amp;          </div><div class="line">00023951    00 a8 73 74 63 6f 00 00  00 00 00 00 00 26 00 00      stco       &amp;  </div><div class="line">00023952    6d 8d 00 00 85 9b 00 00  9d e4 00 00 b1 21 00 00    m            !  </div><div class="line">00023953    c2 a7 00 00 d2 8e 00 00  df 8e 00 00 f3 54 00 00                 T  </div><div class="line">00023954    fe e8 00 01 1a 05 00 01  4a c7 00 01 7e 28 00 01            J   ~(  </div><div class="line">00023955    c5 a1 00 01 fc 89 00 02  35 5c 00 02 83 6a 00 02            5\   j  </div><div class="line">00023956    ae 62 00 02 e1 ae 00 03  1d 6d 00 03 58 04 00 03     b       m  X   </div><div class="line">00023957    99 4d 00 03 e4 b1 00 04  21 99 00 04 39 67 00 04     M      !   9g  </div><div class="line">00023958    5d c6 00 04 78 18 00 04  92 6a 00 04 a7 67 00 04    ]   x    j   g  </div><div class="line">00023959    b8 7e 00 04 d0 6c 00 04  e7 0c 00 05 07 c6 00 05     ~   l          </div><div class="line">00023960    53 5c 00 05 74 bc 00 05  8e 99 00 05 ae 19 00 05    S\  t           </div><div class="line">00023961    c0 eb 00 05 cb 47                                        G</div></pre></td></tr></table></figure><h6 id="smhd"><a href="#smhd" class="headerlink" title="smhd"></a><strong>smhd</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00023870             00 00 00 10 73  6d 68 64 00 00 00 00 00           smhd     </div><div class="line">00023871    00 00 00</div></pre></td></tr></table></figure><h6 id="dinf-1"><a href="#dinf-1" class="headerlink" title="dinf"></a><strong>dinf</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023871             00 00 00 24 64  69 6e 66 00 00 00 1c 64          $dinf    d</div><div class="line">00023872    72 65 66 00 00 00 00 00  00 00 01 00 00 00 0c 75    ref            u</div><div class="line">00023873    72 6c 20 00 00 00 01                                rl</div></pre></td></tr></table></figure><p>####### <strong>dref</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023871                                      00 00 00 1c 64                   d</div><div class="line">00023872    72 65 66 00 00 00 00 00  00 00 01 00 00 00 0c 75    ref            u</div><div class="line">00023873    72 6c 20 00 00 00 01                                rl</div></pre></td></tr></table></figure><h6 id="stbl-1"><a href="#stbl-1" class="headerlink" title="stbl"></a><strong>stbl</strong></h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">00023873                         00  00 05 7f 73 74 62 6c 00               stbl </div><div class="line">00023874    00 00 67 73 74 73 64 00  00 00 00 00 00 00 01 00      gstsd         </div><div class="line">00023875    00 00 57 6d 70 34 61 00  00 00 00 00 00 00 01 00      Wmp4a         </div><div class="line">00023876    00 00 00 00 00 00 00 00  01 00 10 00 00 00 00 bb                    </div><div class="line">00023877    80 00 00 00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02 00 00  00 18 73 74 74 73 00 00              stts  </div><div class="line">00023881    00 00 00 00 00 01 00 00  01 05 00 00 04 00 00 00                    </div><div class="line">00023882    04 28 73 74 73 7a 00 00  00 00 00 00 00 00 00 00     (stsz          </div><div class="line">00023883    01 05 00 00 00 f7 00 00  00 db 00 00 00 e1 00 00                    </div><div class="line">00023884    00 e5 00 00 00 e9 00 00  00 e8 00 00 00 f0 00 00                    </div><div class="line">00023885    00 f1 00 00 00 ef 00 00  00 d8 00 00 00 e6 00 00                    </div><div class="line">00023886    00 e7 00 00 00 e9 00 00  00 eb 00 00 00 ea 00 00                    </div><div class="line">00023887    00 e8 00 00 00 e1 00 00  00 e7 00 00 00 d7 00 00                    </div><div class="line">00023888    00 da 00 00 00 d9 00 00  00 db 00 00 00 e9 00 00                    </div><div class="line">00023889    00 ee 00 00 00 e5 00 00  00 e1 00 00 00 e6 00 00                    </div><div class="line">00023890    00 e5 00 00 00 d8 00 00  00 dd 00 00 00 dd 00 00                    </div><div class="line">00023891    00 d5 00 00 00 ea 00 00  00 dd 00 00 00 d0 00 00                    </div><div class="line">00023892    00 d6 00 00 00 e9 00 00  00 bc 00 00 00 ab 00 00                    </div><div class="line">00023893    00 b3 00 00 00 b5 00 00  00 bc 00 00 00 ce 00 00                    </div><div class="line">00023894    00 b4 00 00 00 b6 00 00  00 b3 00 00 00 b6 00 00                    </div><div class="line">00023895    00 b7 00 00 00 bf 00 00  00 b7 00 00 00 cd 00 00                    </div><div class="line">00023896    00 c1 00 00 00 ba 00 00  00 a7 00 00 00 b4 00 00                    </div><div class="line">00023897    00 b1 00 00 00 be 00 00  00 d0 00 00 00 ba 00 00                    </div><div class="line">00023898    00 bc 00 00 00 c4 00 00  00 c6 00 00 00 cb 00 00                    </div><div class="line">00023899    00 c4 00 00 00 c3 00 00  00 c8 00 00 00 d2 00 00                    </div><div class="line">00023900    00 d2 00 00 00 d6 00 00  00 f5 00 00 00 fa 00 00                    </div><div class="line">00023901    00 f6 00 00 01 02 00 00  00 fc 00 00 00 fc 00 00                    </div><div class="line">00023902    00 ee 00 00 00 e6 00 00  00 ea 00 00 00 ea 00 00                    </div><div class="line">00023903    00 e8 00 00 00 de 00 00  00 df 00 00 00 e7 00 00                    </div><div class="line">00023904    00 f6 00 00 00 ff 00 00  01 03 00 00 00 f6 00 00                    </div><div class="line">00023905    01 08 00 00 01 03 00 00  00 fd 00 00 01 05 00 00                    </div><div class="line">00023906    01 02 00 00 01 00 00 00  01 14 00 00 01 18 00 00                    </div><div class="line">00023907    00 fd 00 00 00 fb 00 00  01 11 00 00 01 05 00 00                    </div><div class="line">00023908    01 05 00 00 01 0a 00 00  01 01 00 00 00 f3 00 00                    </div><div class="line">00023909    00 f7 00 00 00 f7 00 00  01 01 00 00 01 02 00 00                    </div><div class="line">00023910    00 f8 00 00 00 f8 00 00  00 ef 00 00 00 ed 00 00                    </div><div class="line">00023911    00 e3 00 00 00 ec 00 00  00 e2 00 00 00 e8 00 00                    </div><div class="line">00023912    00 dc 00 00 00 e0 00 00  00 f3 00 00 00 df 00 00                    </div><div class="line">00023913    00 e1 00 00 00 cf 00 00  00 ce 00 00 00 d8 00 00                    </div><div class="line">00023914    00 ce 00 00 00 c7 00 00  00 cd 00 00 00 b7 00 00                    </div><div class="line">00023915    00 af 00 00 00 c8 00 00  00 d7 00 00 00 e5 00 00                    </div><div class="line">00023916    00 e4 00 00 00 c6 00 00  00 d1 00 00 00 d5 00 00                    </div><div class="line">00023917    00 e5 00 00 00 d8 00 00  00 c8 00 00 00 be 00 00                    </div><div class="line">00023918    00 bf 00 00 00 cb 00 00  00 d2 00 00 00 c8 00 00                    </div><div class="line">00023919    00 ca 00 00 00 b1 00 00  00 a3 00 00 00 c7 00 00                    </div><div class="line">00023920    00 dc 00 00 00 d9 00 00  00 dd 00 00 00 d1 00 00                    </div><div class="line">00023921    00 d2 00 00 00 c2 00 00  00 bc 00 00 00 b1 00 00                    </div><div class="line">00023922    00 9b 00 00 00 89 00 00  00 a2 00 00 00 9f 00 00                    </div><div class="line">00023923    00 b5 00 00 00 a6 00 00  00 b2 00 00 00 b5 00 00                    </div><div class="line">00023924    00 ae 00 00 00 b4 00 00  00 b0 00 00 00 c6 00 00                    </div><div class="line">00023925    00 c3 00 00 00 d5 00 00  00 e4 00 00 00 f6 00 00                    </div><div class="line">00023926    00 d6 00 00 00 db 00 00  00 cc 00 00 00 e7 00 00                    </div><div class="line">00023927    00 f9 00 00 00 cb 00 00  00 d8 00 00 00 d6 00 00                    </div><div class="line">00023928    00 e4 00 00 00 f1 00 00  00 e4 00 00 00 e6 00 00                    </div><div class="line">00023929    00 df 00 00 00 ee 00 00  00 d7 00 00 00 c7 00 00                    </div><div class="line">00023930    00 e7 00 00 00 f9 00 00  00 ed 00 00 00 cf 00 00                    </div><div class="line">00023931    00 f1 00 00 00 e6 00 00  00 dc 00 00 00 e4 00 00                    </div><div class="line">00023932    00 ef 00 00 00 e5 00 00  00 f1 00 00 00 e3 00 00                    </div><div class="line">00023933    00 ec 00 00 00 ec 00 00  00 f3 00 00 00 f5 00 00                    </div><div class="line">00023934    00 fd 00 00 01 0b 00 00  01 10 00 00 01 11 00 00                    </div><div class="line">00023935    01 03 00 00 01 01 00 00  00 fb 00 00 00 fa 00 00                    </div><div class="line">00023936    00 e7 00 00 00 e5 00 00  00 f0 00 00 00 d2 00 00                    </div><div class="line">00023937    00 e5 00 00 00 f3 00 00  00 f1 00 00 00 f2 00 00                    </div><div class="line">00023938    00 ff 00 00 00 f7 00 00  00 ee 00 00 00 d5 00 00                    </div><div class="line">00023939    00 d9 00 00 00 ea 00 00  00 e3 00 00 00 df 00 00                    </div><div class="line">00023940    00 f7 00 00 00 ff 00 00  00 f8 00 00 00 fa 00 00                    </div><div class="line">00023941    00 fd 00 00 00 f7 00 00  00 f9 00 00 00 fb 00 00                    </div><div class="line">00023942    00 f8 00 00 00 f6 00 00  00 f0 00 00 00 fe 00 00                    </div><div class="line">00023943    01 02 00 00 00 e9 00 00  00 ec 00 00 00 ec 00 00                    </div><div class="line">00023944    00 e7 00 00 00 ea 00 00  00 de 00 00 00 e2 00 00                    </div><div class="line">00023945    00 c9 00 00 00 d4 00 00  00 d4 00 00 00 c7 00 00                    </div><div class="line">00023946    00 c9 00 00 00 c8 00 00  00 c1 00 00 00 c0 00 00                    </div><div class="line">00023947    00 bd 00 00 00 de 00 00  00 cb 00 00 00 cd 00 00                    </div><div class="line">00023948    00 d4 00 00 00 6d 00 00  00 28 73 74 73 63 00 00         m   (stsc  </div><div class="line">00023949    00 00 00 00 00 02 00 00  00 01 00 00 00 07 00 00                    </div><div class="line">00023950    00 01 00 00 00 26 00 00  00 02 00 00 00 01 00 00         &amp;          </div><div class="line">00023951    00 a8 73 74 63 6f 00 00  00 00 00 00 00 26 00 00      stco       &amp;  </div><div class="line">00023952    6d 8d 00 00 85 9b 00 00  9d e4 00 00 b1 21 00 00    m            !  </div><div class="line">00023953    c2 a7 00 00 d2 8e 00 00  df 8e 00 00 f3 54 00 00                 T  </div><div class="line">00023954    fe e8 00 01 1a 05 00 01  4a c7 00 01 7e 28 00 01            J   ~(  </div><div class="line">00023955    c5 a1 00 01 fc 89 00 02  35 5c 00 02 83 6a 00 02            5\   j  </div><div class="line">00023956    ae 62 00 02 e1 ae 00 03  1d 6d 00 03 58 04 00 03     b       m  X   </div><div class="line">00023957    99 4d 00 03 e4 b1 00 04  21 99 00 04 39 67 00 04     M      !   9g  </div><div class="line">00023958    5d c6 00 04 78 18 00 04  92 6a 00 04 a7 67 00 04    ]   x    j   g  </div><div class="line">00023959    b8 7e 00 04 d0 6c 00 04  e7 0c 00 05 07 c6 00 05     ~   l          </div><div class="line">00023960    53 5c 00 05 74 bc 00 05  8e 99 00 05 ae 19 00 05    S\  t           </div><div class="line">00023961    c0 eb 00 05 cb 47                                        G</div></pre></td></tr></table></figure><p>####### <strong>stsd</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">00023873                                                  00                </div><div class="line">00023874    00 00 67 73 74 73 64 00  00 00 00 00 00 00 01 00      gstsd         </div><div class="line">00023875    00 00 57 6d 70 34 61 00  00 00 00 00 00 00 01 00      Wmp4a         </div><div class="line">00023876    00 00 00 00 00 00 00 00  01 00 10 00 00 00 00 bb                    </div><div class="line">00023877    80 00 00 00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02</div></pre></td></tr></table></figure><p>######## <strong>esds</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">00023877             00 00 00 33 65  73 64 73 00 00 00 00 03          3esds     </div><div class="line">00023878    80 80 80 22 00 00 00 04  80 80 80 14 40 15 00 01       "        @   </div><div class="line">00023879    18 00 01 65 f0 00 01 44  6b 05 80 80 80 02 11 88       e   Dk       </div><div class="line">00023880    06 80 80 80 01 02</div></pre></td></tr></table></figure><p>####### <strong>stts</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00023880                      00 00  00 18 73 74 74 73 00 00              stts  </div><div class="line">00023881    00 00 00 00 00 01 00 00  01 05 00 00 04 00</div></pre></td></tr></table></figure><p>####### <strong>stsz</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">00023881                                               00 00                    </div><div class="line">00023882    04 28 73 74 73 7a 00 00  00 00 00 00 00 00 00 00     (stsz          </div><div class="line">00023883    01 05 00 00 00 f7 00 00  00 db 00 00 00 e1 00 00                    </div><div class="line">00023884    00 e5 00 00 00 e9 00 00  00 e8 00 00 00 f0 00 00                    </div><div class="line">00023885    00 f1 00 00 00 ef 00 00  00 d8 00 00 00 e6 00 00                    </div><div class="line">00023886    00 e7 00 00 00 e9 00 00  00 eb 00 00 00 ea 00 00                    </div><div class="line">00023887    00 e8 00 00 00 e1 00 00  00 e7 00 00 00 d7 00 00                    </div><div class="line">00023888    00 da 00 00 00 d9 00 00  00 db 00 00 00 e9 00 00                    </div><div class="line">00023889    00 ee 00 00 00 e5 00 00  00 e1 00 00 00 e6 00 00                    </div><div class="line">00023890    00 e5 00 00 00 d8 00 00  00 dd 00 00 00 dd 00 00                    </div><div class="line">00023891    00 d5 00 00 00 ea 00 00  00 dd 00 00 00 d0 00 00                    </div><div class="line">00023892    00 d6 00 00 00 e9 00 00  00 bc 00 00 00 ab 00 00                    </div><div class="line">00023893    00 b3 00 00 00 b5 00 00  00 bc 00 00 00 ce 00 00                    </div><div class="line">00023894    00 b4 00 00 00 b6 00 00  00 b3 00 00 00 b6 00 00                    </div><div class="line">00023895    00 b7 00 00 00 bf 00 00  00 b7 00 00 00 cd 00 00                    </div><div class="line">00023896    00 c1 00 00 00 ba 00 00  00 a7 00 00 00 b4 00 00                    </div><div class="line">00023897    00 b1 00 00 00 be 00 00  00 d0 00 00 00 ba 00 00                    </div><div class="line">00023898    00 bc 00 00 00 c4 00 00  00 c6 00 00 00 cb 00 00                    </div><div class="line">00023899    00 c4 00 00 00 c3 00 00  00 c8 00 00 00 d2 00 00                    </div><div class="line">00023900    00 d2 00 00 00 d6 00 00  00 f5 00 00 00 fa 00 00                    </div><div class="line">00023901    00 f6 00 00 01 02 00 00  00 fc 00 00 00 fc 00 00                    </div><div class="line">00023902    00 ee 00 00 00 e6 00 00  00 ea 00 00 00 ea 00 00                    </div><div class="line">00023903    00 e8 00 00 00 de 00 00  00 df 00 00 00 e7 00 00                    </div><div class="line">00023904    00 f6 00 00 00 ff 00 00  01 03 00 00 00 f6 00 00                    </div><div class="line">00023905    01 08 00 00 01 03 00 00  00 fd 00 00 01 05 00 00                    </div><div class="line">00023906    01 02 00 00 01 00 00 00  01 14 00 00 01 18 00 00                    </div><div class="line">00023907    00 fd 00 00 00 fb 00 00  01 11 00 00 01 05 00 00                    </div><div class="line">00023908    01 05 00 00 01 0a 00 00  01 01 00 00 00 f3 00 00                    </div><div class="line">00023909    00 f7 00 00 00 f7 00 00  01 01 00 00 01 02 00 00                    </div><div class="line">00023910    00 f8 00 00 00 f8 00 00  00 ef 00 00 00 ed 00 00                    </div><div class="line">00023911    00 e3 00 00 00 ec 00 00  00 e2 00 00 00 e8 00 00                    </div><div class="line">00023912    00 dc 00 00 00 e0 00 00  00 f3 00 00 00 df 00 00                    </div><div class="line">00023913    00 e1 00 00 00 cf 00 00  00 ce 00 00 00 d8 00 00                    </div><div class="line">00023914    00 ce 00 00 00 c7 00 00  00 cd 00 00 00 b7 00 00                    </div><div class="line">00023915    00 af 00 00 00 c8 00 00  00 d7 00 00 00 e5 00 00                    </div><div class="line">00023916    00 e4 00 00 00 c6 00 00  00 d1 00 00 00 d5 00 00                    </div><div class="line">00023917    00 e5 00 00 00 d8 00 00  00 c8 00 00 00 be 00 00                    </div><div class="line">00023918    00 bf 00 00 00 cb 00 00  00 d2 00 00 00 c8 00 00                    </div><div class="line">00023919    00 ca 00 00 00 b1 00 00  00 a3 00 00 00 c7 00 00                    </div><div class="line">00023920    00 dc 00 00 00 d9 00 00  00 dd 00 00 00 d1 00 00                    </div><div class="line">00023921    00 d2 00 00 00 c2 00 00  00 bc 00 00 00 b1 00 00                    </div><div class="line">00023922    00 9b 00 00 00 89 00 00  00 a2 00 00 00 9f 00 00                    </div><div class="line">00023923    00 b5 00 00 00 a6 00 00  00 b2 00 00 00 b5 00 00                    </div><div class="line">00023924    00 ae 00 00 00 b4 00 00  00 b0 00 00 00 c6 00 00                    </div><div class="line">00023925    00 c3 00 00 00 d5 00 00  00 e4 00 00 00 f6 00 00                    </div><div class="line">00023926    00 d6 00 00 00 db 00 00  00 cc 00 00 00 e7 00 00                    </div><div class="line">00023927    00 f9 00 00 00 cb 00 00  00 d8 00 00 00 d6 00 00                    </div><div class="line">00023928    00 e4 00 00 00 f1 00 00  00 e4 00 00 00 e6 00 00                    </div><div class="line">00023929    00 df 00 00 00 ee 00 00  00 d7 00 00 00 c7 00 00                    </div><div class="line">00023930    00 e7 00 00 00 f9 00 00  00 ed 00 00 00 cf 00 00                    </div><div class="line">00023931    00 f1 00 00 00 e6 00 00  00 dc 00 00 00 e4 00 00                    </div><div class="line">00023932    00 ef 00 00 00 e5 00 00  00 f1 00 00 00 e3 00 00                    </div><div class="line">00023933    00 ec 00 00 00 ec 00 00  00 f3 00 00 00 f5 00 00                    </div><div class="line">00023934    00 fd 00 00 01 0b 00 00  01 10 00 00 01 11 00 00                    </div><div class="line">00023935    01 03 00 00 01 01 00 00  00 fb 00 00 00 fa 00 00                    </div><div class="line">00023936    00 e7 00 00 00 e5 00 00  00 f0 00 00 00 d2 00 00                    </div><div class="line">00023937    00 e5 00 00 00 f3 00 00  00 f1 00 00 00 f2 00 00                    </div><div class="line">00023938    00 ff 00 00 00 f7 00 00  00 ee 00 00 00 d5 00 00                    </div><div class="line">00023939    00 d9 00 00 00 ea 00 00  00 e3 00 00 00 df 00 00                    </div><div class="line">00023940    00 f7 00 00 00 ff 00 00  00 f8 00 00 00 fa 00 00                    </div><div class="line">00023941    00 fd 00 00 00 f7 00 00  00 f9 00 00 00 fb 00 00                    </div><div class="line">00023942    00 f8 00 00 00 f6 00 00  00 f0 00 00 00 fe 00 00                    </div><div class="line">00023943    01 02 00 00 00 e9 00 00  00 ec 00 00 00 ec 00 00                    </div><div class="line">00023944    00 e7 00 00 00 ea 00 00  00 de 00 00 00 e2 00 00                    </div><div class="line">00023945    00 c9 00 00 00 d4 00 00  00 d4 00 00 00 c7 00 00                    </div><div class="line">00023946    00 c9 00 00 00 c8 00 00  00 c1 00 00 00 c0 00 00                    </div><div class="line">00023947    00 bd 00 00 00 de 00 00  00 cb 00 00 00 cd 00 00                    </div><div class="line">00023948    00 d4 00 00 00 6d                                        m</div></pre></td></tr></table></figure><p>####### <strong>stsc</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023948                      00 00  00 28 73 74 73 63 00 00             (stsc  </div><div class="line">00023949    00 00 00 00 00 02 00 00  00 01 00 00 00 07 00 00                    </div><div class="line">00023950    00 01 00 00 00 26 00 00  00 02 00 00 00 01               &amp;</div></pre></td></tr></table></figure><p>####### <strong>stco</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">00023950                                               00 00                    </div><div class="line">00023951    00 a8 73 74 63 6f 00 00  00 00 00 00 00 26 00 00      stco       &amp;  </div><div class="line">00023952    6d 8d 00 00 85 9b 00 00  9d e4 00 00 b1 21 00 00    m            !  </div><div class="line">00023953    c2 a7 00 00 d2 8e 00 00  df 8e 00 00 f3 54 00 00                 T  </div><div class="line">00023954    fe e8 00 01 1a 05 00 01  4a c7 00 01 7e 28 00 01            J   ~(  </div><div class="line">00023955    c5 a1 00 01 fc 89 00 02  35 5c 00 02 83 6a 00 02            5\   j  </div><div class="line">00023956    ae 62 00 02 e1 ae 00 03  1d 6d 00 03 58 04 00 03     b       m  X   </div><div class="line">00023957    99 4d 00 03 e4 b1 00 04  21 99 00 04 39 67 00 04     M      !   9g  </div><div class="line">00023958    5d c6 00 04 78 18 00 04  92 6a 00 04 a7 67 00 04    ]   x    j   g  </div><div class="line">00023959    b8 7e 00 04 d0 6c 00 04  e7 0c 00 05 07 c6 00 05     ~   l          </div><div class="line">00023960    53 5c 00 05 74 bc 00 05  8e 99 00 05 ae 19 00 05    S\  t           </div><div class="line">00023961    c0 eb 00 05 cb 47                                        G</div></pre></td></tr></table></figure><h3 id="udta"><a href="#udta" class="headerlink" title="udta"></a><strong>udta</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">00023961                      00 00  00 16 75 64 74 61 00 00              udta  </div><div class="line">00023962    00 0e 6e 61 6d 65 53 74  65 72 65 6f                  nameStereo</div></pre></td></tr></table></figure><h3 id="udta-1"><a href="#udta-1" class="headerlink" title="udta"></a><strong>udta</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">00023961                                         74 61 00 00              udta  </div><div class="line">00023962    00 0e 6e 61 6d 65 53 74  65 72 65 6f 00 00 00 6f      nameStereo   o</div><div class="line">00023963    75 64 74 61 00 00 00 67  6d 65 74 61 00 00 00 00    udta   gmeta    </div><div class="line">00023964    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023965    6d 64 69 72 00 00 00 00  00 00 00 00 00 00 00 00    mdir            </div><div class="line">00023966    00 00 00 00 3a 69 6c 73  74 00 00 00 32 a9 74 6f        :ilst   2 to</div><div class="line">00023967    6f 00 00 00 2a 64 61 74  61 00 00 00 01 00 00 00    o   *data       </div><div class="line">00023968    00 48 61 6e 64 42 72 61  6b 65 20 30 2e 39 2e 34     HandBrake 0.9.4</div></pre></td></tr></table></figure><h4 id="meta"><a href="#meta" class="headerlink" title="meta"></a><strong>meta</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">00023963                00 00 00 67  6d 65 74 61 00 00 00 00    udta   gmeta    </div><div class="line">00023964    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023965    6d 64 69 72 00 00 00 00  00 00 00 00 00 00 00 00    mdir            </div><div class="line">00023966    00 00 00 00 3a 69 6c 73  74 00 00 00 32 a9 74 6f        :ilst   2 to</div><div class="line">00023967    6f 00 00 00 2a 64 61 74  61 00 00 00 01 00 00 00    o   *data       </div><div class="line">00023968    00 48 61 6e 64 42 72 61  6b 65 20 30 2e 39 2e 34     HandBrake 0.9.4</div><div class="line">00023969    20 32 30 30 39 31 31 32  33 30 30                    2009112300</div></pre></td></tr></table></figure><h5 id="hdlr-2"><a href="#hdlr-2" class="headerlink" title="hdlr"></a><strong>hdlr</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">00023964    00 00 00 21 68 64 6c 72  00 00 00 00 00 00 00 00       !hdlr        </div><div class="line">00023965    6d 64 69 72 00 00 00 00  00 00 00 00 00 00 00 00    mdir            </div><div class="line">00023966    00</div></pre></td></tr></table></figure><h5 id="ilst"><a href="#ilst" class="headerlink" title="ilst"></a><strong>ilst</strong></h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">00023966       00 00 00 3a 69 6c 73  74 00 00 00 32 a9 74 6f        :ilst   2 to</div><div class="line">00023967    6f 00 00 00 2a 64 61 74  61 00 00 00 01 00 00 00    o   *data       </div><div class="line">00023968    00 48 61 6e 64 42 72 61  6b 65 20 30 2e 39 2e 34     HandBrake 0.9.4</div><div class="line">00023969    20 32 30 30 39 31 31 32  33 30 30                    2009112300</div></pre></td></tr></table></figure><h2 id="free-1"><a href="#free-1" class="headerlink" title="free"></a><strong>free</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">00023969                                      00 00 00 84 66                   f</div><div class="line">00023970    72 65 65 00 00 00 00 00  00 00 00 00 00 00 00 00    ree             </div><div class="line">00023971    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023972    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023973    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023974    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023975    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023976    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00                    </div><div class="line">00023977    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 03                    </div></pre></td></tr></table></figure><hr><h1 id="ffmpeg-解封装-MP4"><a href="#ffmpeg-解封装-MP4" class="headerlink" title="ffmpeg 解封装 MP4"></a><strong>ffmpeg 解封装 MP4</strong></h1><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>use_absolute_path</td><td>布尔</td><td>可以通过绝对路径加载外部的 track，可能会有安全因素的影响，默认不开启</td></tr><tr><td>seek_streams_individually</td><td>布尔</td><td>根据单独流进行 seek，默认开启</td></tr><tr><td>ignore_editlist</td><td>布尔</td><td>忽略 EditList 信息，默认不开启</td></tr><tr><td>ignore_chapters</td><td>布尔</td><td>忽略 Chapters 信息，默认不开启</td></tr><tr><td>enable_drefs</td><td>布尔</td><td>外部 track 支持，默认不开启</td></tr></tbody></table><hr><h1 id="ffmpeg-封装-MP4"><a href="#ffmpeg-封装-MP4" class="headerlink" title="ffmpeg 封装 MP4"></a><strong>ffmpeg 封装 MP4</strong></h1><table><tr><td>参数</td><td>值</td><td>说明</td></tr><tr><td rowspan="18">movflags</td></tr><tr><td></td><td>MP4 Muxer 标记</td></tr><tr><td>rtphint</td><td>增加 RTP 的 hint track</td></tr><tr><td>empty_moov</td><td>初始化空的 moov box</td></tr><tr><td>frag_keyframe</td><td>在视频关键帧处切片</td></tr><tr><td>separate_moof</td><td>每一个 track 写独立的 moof/mdat box</td></tr><tr><td>frag_custom</td><td>每一个 caller 请求时 flush 一个片段</td></tr><tr><td>isml</td><td>创建实时流媒体（创建一个直播流发布点）</td></tr><tr><td>faststart</td><td>将 moov box 移动到文件头部</td></tr><tr><td>omit_tfhd_offset</td><td>忽略 tfhd 容器中的基础数据偏移</td></tr><tr><td>disable_chpl</td><td>关闭 Nero Chapter 容器</td></tr><tr><td>default_base_moof</td><td>在 tfhd 容器中设置 default-base-is-moof 标记</td></tr><tr><td>dash</td><td>兼容 DASH 格式的 MP4 分片</td></tr><tr><td>frag_discont</td><td>分片不连续式设置 discontinuous 信号</td></tr><tr><td>delay_moov</td><td>延迟写入 moov 信息，直到第一个分片切出来，或者第一片被刷掉</td></tr><tr><td>global_sidx</td><td>在文件的开头设置公共的 sidx 索引</td></tr><tr><td>write_colr</td><td>写入 colr 容器</td></tr><tr><td>write_gama</td><td>写被弃用的 gama 容器</td></tr><tr><td>moov_size</td><td>正整数</td><td>设置 moov 容器大小的最大值</td></tr><tr><td rowspan="7">rtpflags</td></tr><tr><td></td><td>设置 RTP 传输相关的标记</td></tr><tr><td>latm</td><td>使用 MP4A-LATM 方式传输 AAC 音频</td></tr><tr><td>rfc2190</td><td>使用 RFC2190 传输 H264、H263</td></tr><tr><td>skip_rtcp</td><td>忽略使用 RTCP</td></tr><tr><td>h264_mode0</td><td>使用 RTP 传输 mode0 的 H264</td></tr><tr><td>send_bye</td><td>当传输结束时发送 RTCP 的 BYE 包</td></tr><tr><td>skip_iods</td><td>布尔型</td><td>不写入 idos 容器</td></tr><tr><td>iods_audio_profile</td><td>0～255</td><td>设置 idos 的音频 profile 容器</td></tr><tr><td>oids_video_profile</td><td>0～255</td><td>设置 idos 的视频 profile 容器</td></tr><tr><td>frag_duration</td><td>正整数</td><td>切片最大的 duration</td></tr><tr><td>min_frag_duration</td><td>正整数</td><td>切片最小的 duration</td></tr><tr><td>frag_size</td><td>正整数</td><td>切片最大的大小</td></tr><tr><td>ism_lookahead</td><td>正整数</td><td>预读取 ISM 文件的数量</td></tr><tr><td>video_track_timescale</td><td>正整数</td><td>设置所有视频的时间计算方式</td></tr><tr><td>brand</td><td>字符串</td><td>写 major brand</td></tr><tr><td>use_editlist</td><td>布尔型</td><td>使用 edit list</td></tr><tr><td>fragment_index</td><td>正整数</td><td>下一个分片编号</td></tr><tr><td>mov_gamma</td><td>0～10</td><td>Gamma 容器的 gama 值</td></tr><tr><td>frag_interleave</td><td>正整数</td><td>交错分片样本</td></tr><tr><td>encryption_scheme</td><td>字符串</td><td>配置加密的方案</td></tr><tr><td>encryption_key</td><td>二进制</td><td>密钥</td></tr><tr><td>encryption_kid</td><td>二进制</td><td>密钥标识符</td></tr></table><h2 id="将-moov-移动到-mdat-前面"><a href="#将-moov-移动到-mdat-前面" class="headerlink" title="将 moov 移动到 mdat 前面"></a><strong>将 moov 移动到 mdat 前面</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -c copy -f mp4 -movflags faststart sample_faststart.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/MP4-%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F3.png" alt=""></p><p>3、通过 mp4info 查看 box 树：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/MP4-%E5%B0%81%E8%A3%85%E6%A0%BC%E5%BC%8F4.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>M3U8 视频列表格式</title>
    <link href="http://www.weichao.io/2018/05/16/M3U8-%E8%A7%86%E9%A2%91%E5%88%97%E8%A1%A8%E6%A0%BC%E5%BC%8F/"/>
    <id>http://www.weichao.io/2018/05/16/M3U8-视频列表格式/</id>
    <published>2018-05-16T15:53:22.000Z</published>
    <updated>2018-05-16T15:55:30.094Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="常用标签"><a href="#常用标签" class="headerlink" title="常用标签"></a><strong>常用标签</strong></h1><table><thead><tr><th>标签</th><th>必要性</th><th>说明</th></tr></thead><tbody><tr><td>EXTM3U</td><td>是</td><td>必须在文件的第一行，所有的 M3U8 文件中必须包含这个标签</td></tr><tr><td>EXT-X-VERSION</td><td></td><td>M3U8 版本</td></tr><tr><td>EXT-X-TARGETDURATION</td><td></td><td>每一个分片都会有一个分片自己的 duration，这个标签是最大的那个分片的浮点数四舍五入后的整数值</td></tr><tr><td>EXT-X-MEDIA-SEQUENCE</td><td></td><td>1、直播时的直播切片序列，当播放打开 M3U8 时，以这个标签的值为参考，播放对应的序列号的切片；<br>2、分片必须是动态改变的，序列不能相同，并且序列必须是增序的；<br>3、当M3U8列表中没有出现 EXT-X-ENDLIST 标签时，无论这个 M3U8 列表中有多少片分片，播放分片都是从倒数第三片开始播放，如果不满三片则不应该播放。当然，如果有些播放器特别定制了的话，则可以不遵照这个原则；<br>4、如果播放列表在刷新之后与之前的列表相同，那么在播放当前分片 duration 一半的时间内会再刷新一次</td></tr><tr><td>EXT-X-DISCONTINUITY</td><td></td><td>解决因播放的前一片分片与后一片分片不连续而导致的报错</td></tr><tr><td>EXTINF</td><td></td><td>1、包含每一个分片的 duration 和可选的描述信息，主要为标注切片信息，使用逗号分隔开；<br>2、EXTINF 下面的信息为具体的分片信息，分片存储路径可以为相对路径，也可以为绝对路径，也可以为互联网的 URL 链接地址</td></tr><tr><td>EXT-X-ENDLIST</td><td></td><td>表明该 M3U8 文件不会再产生更多的切片，可以理解为该 M3U8 已停止更新，并且播放分片到这个标签后结束</td></tr><tr><td>EXT-X-STREAM-INF</td><td></td><td>主要是出现在多级 M3U8 文件中，例如 M3U8 中包含子 M3U8 列表，或者主 M3U8 中包含多码率 M3U8 时；该标签后需要跟一些属性</td></tr></tbody></table><p>示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>EXTM3U</div><div class="line"><span class="meta">#</span>EXT-X-VERSION：3</div><div class="line"><span class="meta">#</span>EXT-X-TARGETDURATION：4</div><div class="line"><span class="meta">#</span>EXT-X-MEDIA-SEQUENCE：0</div><div class="line"><span class="meta">#</span>EXTINF：3.760000，</div><div class="line">out0.ts</div><div class="line"><span class="meta">#</span>EXTINF：1.880000，</div><div class="line">out1.ts</div><div class="line"><span class="meta">#</span>EXTINF：1.760000，</div><div class="line">out2.ts</div><div class="line"><span class="meta">#</span>EXTINF：1.040000，</div><div class="line">out3.ts</div><div class="line"><span class="meta">#</span>EXTINF：1.560000，</div><div class="line">out4</div></pre></td></tr></table></figure><h2 id="EXT-X-STREAM-INF"><a href="#EXT-X-STREAM-INF" class="headerlink" title="EXT-X-STREAM-INF"></a><strong>EXT-X-STREAM-INF</strong></h2><table><thead><tr><th>属性名</th><th>必要性</th><th>说明</th></tr></thead><tbody><tr><td>BANDWIDTH</td><td>是</td><td>播放时占用的最大码率</td></tr><tr><td>AVERAGE-BANDWIDTH</td><td>否</td><td>播放时占用的平均码率</td></tr><tr><td>CODECS</td><td>应该</td><td>声明音频编码、视频编码的信息</td></tr><tr><td>RESOLUTION</td><td>否</td><td>视频的宽高信息</td></tr><tr><td>FRAME-RATE</td><td>否</td><td>视频帧率</td></tr></tbody></table><p>示例：使用4个 EXT-X-STREAM-INF 标签来标注子 M3U8 的属性——最高码率为 1.28M、平均码率为 1M 的 M3U8；最高码率为 2.56M、平均码率为 2M 的 M3U8；最高码率为 7.68M、平均码率为 6M 的 M3U8；以及只有 65K 的音频编码的 M3U8。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>EXTM3U</div><div class="line"><span class="meta">#</span>EXT-X-STREAM-INF：BANDWIDTH=1280000，AVERAGE-BANDWIDTH=1000000</div><div class="line">http://example.com/low.m3u8</div><div class="line"><span class="meta">#</span>EXT-X-STREAM-INF：BANDWIDTH=2560000，AVERAGE-BANDWIDTH=2000000</div><div class="line">http://example.com/mid.m3u8</div><div class="line"><span class="meta">#</span>EXT-X-STREAM-INF：BANDWIDTH=7680000，AVERAGE-BANDWIDTH=6000000</div><div class="line">http://example.com/hi.m3u8</div><div class="line"><span class="meta">#</span>EXT-X-STREAM-INF：BANDWIDTH=65000，CODECS="mp4a.40.5"</div><div class="line">http://example.com/audio-only.m3u8</div></pre></td></tr></table></figure><hr><h1 id="各版本区别"><a href="#各版本区别" class="headerlink" title="各版本区别"></a><strong>各版本区别</strong></h1><table><thead><tr><th>版本号</th><th>增加</th><th>删除</th></tr></thead><tbody><tr><td>2</td><td>EXT-X-KEY</td><td></td></tr><tr><td>3</td><td>浮点 EXTINF 的 duration</td><td></td></tr><tr><td>4</td><td>EXT-X-BYTERAGE<br>EXT-X-I-FRAMES-ONLY</td><td></td></tr><tr><td>5</td><td>EXT-X-KEY 的格式说明 KEYFORMAT<br>KEYFORMATVE-RSION<br>EXT-X-MAP</td><td></td></tr><tr><td>6</td><td>EXT-X-MAP 里面不包含 EXT-X-I-FRAMES-ONLY</td><td>EXT-X-STREAM-INF<br>EXT-X-I-FRAME-STREAM-INF</td></tr><tr><td>7</td><td></td><td>EXT-X-ALLOW-CACHE</td></tr></tbody></table><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ffplay 命令常用功能</title>
    <link href="http://www.weichao.io/2018/05/13/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD/"/>
    <id>http://www.weichao.io/2018/05/13/ffplay-命令常用功能/</id>
    <published>2018-05-13T05:13:29.000Z</published>
    <updated>2018-05-13T05:19:22.662Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="ffplay-命令参数"><a href="#ffplay-命令参数" class="headerlink" title="ffplay 命令参数"></a><strong>ffplay 命令参数</strong></h1><h2 id="查询-ffplay-命令支持的参数"><a href="#查询-ffplay-命令支持的参数" class="headerlink" title="查询 ffplay 命令支持的参数"></a><strong>查询 ffplay 命令支持的参数</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay --help</div></pre></td></tr></table></figure><p>如果出现：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD1.png" alt=""></p><p>需要确认 FFmpeg 文件夹中是否有可执行文件 ffplay：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD2.png" alt=""></p><p>如果没有，说明在编译 FFmpeg 源代码时，系统中不存在 SDL（旧版本 FFmpeg 需要 1.2，新版本 FFmpeg 需要 2.0），导致未自动编译出 ffplay，需要安装 SDL，且需要先删除掉已安装的 FFmpeg，再重新编译 FFmpeg 源代码并安装。</p><p>如果有，说明未配置 FFmpeg 环境变量，需要主动配置并重启 PC。</p><p>2、输出结果（只截取了部分）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD3.png" alt=""></p><h2 id="部分参数说明"><a href="#部分参数说明" class="headerlink" title="部分参数说明"></a><strong>部分参数说明</strong></h2><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>x</td><td>强制设置视频显示窗口的宽度</td></tr><tr><td>y</td><td>强制设置视频显示窗口的高度</td></tr><tr><td>s</td><td>设置视频显示的宽高</td></tr><tr><td>fs</td><td>强制全屏显示</td></tr><tr><td>an</td><td>屏蔽音频</td></tr><tr><td>vn</td><td>屏蔽视频</td></tr><tr><td>sn</td><td>屏蔽字幕</td></tr><tr><td>ss</td><td>根据设置的秒进行定位拖动</td></tr><tr><td>t</td><td>设置播放视频/音频的长度</td></tr><tr><td>bytes</td><td>设置定位拖动的策略，0 为不可拖动，1 为可拖动，-1 为自动</td></tr><tr><td>nodisp</td><td>关闭图形化显示窗口</td></tr><tr><td>f</td><td>强制使用设置的格式进行解析</td></tr><tr><td>window_title</td><td>设置显示窗口的标题</td></tr><tr><td>af</td><td>设置音频的滤镜</td></tr><tr><td>codec</td><td>强制使用设置的 codec 进行解码</td></tr><tr><td>autorotate</td><td>自动旋转视频</td></tr><tr><td>ast</td><td>设置将要播放的音频流</td></tr><tr><td>vst</td><td>设置将要播放的视频流</td></tr><tr><td>sst</td><td>设置将要播放的字幕流</td></tr><tr><td>stats</td><td>输出多媒体播放状态</td></tr><tr><td>fast</td><td>非标准化规范的多媒体兼容优化</td></tr><tr><td>sync</td><td>音视频同步设置可根据音频时间、视频时间或者外部扩展时间进行参考</td></tr><tr><td>autoexit</td><td>多媒体播放完毕之后自动退出 ffplay，ffplay 默认播放完毕之后不退出播放器</td></tr><tr><td>exitonkeydown</td><td>当有按键按下事件产生时退出 ffplay</td></tr><tr><td>exitonmousedown</td><td>当有鼠标按下事件产生时退出 ffplay</td></tr><tr><td>loop</td><td>设置多媒体文件循环播放的次数</td></tr><tr><td>framedrop</td><td>当 CPU 资源占用过高时，自动丢帧</td></tr><tr><td>infbuf</td><td>设置无极限的播放 buffer，这个选项常用于实时流媒体播放场景</td></tr><tr><td>vf</td><td>视频滤镜设置</td></tr><tr><td>acodec</td><td>强制使用设置的音频解码器</td></tr><tr><td>vcodec</td><td>强制使用设置的视频解码器</td></tr><tr><td>scodec</td><td>强制使用设置的字幕解码器</td></tr></tbody></table><hr><h1 id="ffplay-命令应用"><a href="#ffplay-命令应用" class="headerlink" title="ffplay 命令应用"></a><strong>ffplay 命令应用</strong></h1><h2 id="从视频的第-5-秒开始播放，播放-10-秒"><a href="#从视频的第-5-秒开始播放，播放-10-秒" class="headerlink" title="从视频的第 5 秒开始播放，播放 10 秒"></a><strong>从视频的第 5 秒开始播放，播放 10 秒</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay -ss 5 -t 10 sample.mp4</div></pre></td></tr></table></figure><h2 id="播放流媒体"><a href="#播放流媒体" class="headerlink" title="播放流媒体"></a><strong>播放流媒体</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay -window_title "播放测试" rtmp://live.hkstv.hk.lxdns.com/live/hks</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD4.png" alt=""></p><p>3、播放成功的截图：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD5.png" alt=""></p><h2 id="强制使用错误的解码器会导致解码失败"><a href="#强制使用错误的解码器会导致解码失败" class="headerlink" title="强制使用错误的解码器会导致解码失败"></a><strong>强制使用错误的解码器会导致解码失败</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay -vcodec mpeg4 sample.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD6.png" alt=""></p><h2 id="加载字幕"><a href="#加载字幕" class="headerlink" title="加载字幕"></a><strong>加载字幕</strong></h2><p>1、编辑字幕文件 sample.srt：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">00:00:01,001 --&gt; 00:00:02,000</div><div class="line">test 1</div><div class="line"></div><div class="line">2</div><div class="line">00:00:02,001 --&gt; 00:00:03,000</div><div class="line">test 2</div><div class="line"></div><div class="line">3</div><div class="line">00:00:03,001 --&gt; 00:00:04,000</div><div class="line">test 3</div><div class="line"></div><div class="line">3</div><div class="line">00:00:04,001 --&gt; 00:00:05,000</div><div class="line">test 4</div><div class="line"></div><div class="line">3</div><div class="line">00:00:05,001 --&gt; 00:00:06,000</div><div class="line">test 5</div></pre></td></tr></table></figure><p>2、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay -window_title "播放测试" -vf subtitles=sample.srt sample.mp4</div></pre></td></tr></table></figure><p>3、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD7.png" alt=""></p><p>4、加载字幕成功的截图：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD8.png" alt=""></p><h2 id="将音频数据以音频波形的形式显示"><a href="#将音频数据以音频波形的形式显示" class="headerlink" title="将音频数据以音频波形的形式显示"></a><strong>将音频数据以音频波形的形式显示</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay -showmode 1 sample.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD9.png" alt=""></p><p>3、显示成功的截图：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD10.png" alt=""></p><h2 id="显示解码宏块（新版本-FFmpeg-已失效）"><a href="#显示解码宏块（新版本-FFmpeg-已失效）" class="headerlink" title="显示解码宏块（新版本 FFmpeg 已失效）"></a><strong>显示解码宏块（新版本 FFmpeg 已失效）</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay -debug vis_mb_type sample.mp4</div></pre></td></tr></table></figure><h2 id="显示运动估计"><a href="#显示运动估计" class="headerlink" title="显示运动估计"></a><strong>显示运动估计</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffplay -flags2 +export_mvs sample.mp4 -vf codecview=mv=pf+bf+bb</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD11.png" alt=""></p><p>3、显示成功的截图：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffplay-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD12.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ffmpeg 命令常用功能</title>
    <link href="http://www.weichao.io/2018/05/12/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD/"/>
    <id>http://www.weichao.io/2018/05/12/ffmpeg-命令常用功能/</id>
    <published>2018-05-12T12:47:25.000Z</published>
    <updated>2018-05-22T16:02:37.341Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li></ul><hr><h1 id="ffmpeg-命令参数组成"><a href="#ffmpeg-命令参数组成" class="headerlink" title="ffmpeg 命令参数组成"></a><strong>ffmpeg 命令参数组成</strong></h1><h2 id="信息查询部分"><a href="#信息查询部分" class="headerlink" title="信息查询部分"></a><strong>信息查询部分</strong></h2><h3 id="查看支持的视频文件格式列表"><a href="#查看支持的视频文件格式列表" class="headerlink" title="查看支持的视频文件格式列表"></a><strong>查看支持的视频文件格式列表</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -formats</div></pre></td></tr></table></figure><p>2、输出结果（只截取了部分）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD1.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>列数</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包含 2 个字段：<br>（1）是否支持 Demuxing 多媒体文件封装格式<br>（2）是否支持 Muxing 多媒体文件封装格式</td></tr><tr><td>2</td><td>多媒体文件格式</td></tr><tr><td>3</td><td>文件格式的详细说明</td></tr></tbody></table><h3 id="查看支持的编码列表"><a href="#查看支持的编码列表" class="headerlink" title="查看支持的编码列表"></a><strong>查看支持的编码列表</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -encoders</div></pre></td></tr></table></figure><p>2、输出结果（只截取了部分）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD2.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>列数</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包含 6 个字段：<br>（1）编码类型是视频（V）、音频（A）、字幕（S）<br>（2）是否支持帧级别的多线程<br>（3）是否支持分片级别的多线程<br>（4）是否为实验版本<br>（5）是否支持 draw horiz band 模式<br>（6）是否支持直接渲染</td></tr><tr><td>2</td><td>编码格式</td></tr><tr><td>3</td><td>编码格式的说明</td></tr></tbody></table><h3 id="查看支持的解码列表"><a href="#查看支持的解码列表" class="headerlink" title="查看支持的解码列表"></a><strong>查看支持的解码列表</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -decoders</div></pre></td></tr></table></figure><p>2、输出结果（只截取了部分）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD3.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>列数</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包含 6 个字段：<br>（1）解码类型是视频（V）、音频（A）、字幕（S）<br>（2）是否支持帧级别的多线程<br>（3）是否支持分片级别的多线程<br>（4）是否为实验版本<br>（5）是否支持 draw horiz band 模式<br>（6）是否支持直接渲染</td></tr><tr><td>2</td><td>解码格式</td></tr><tr><td>3</td><td>解码格式的说明</td></tr></tbody></table><h3 id="查看支持的滤镜列表"><a href="#查看支持的滤镜列表" class="headerlink" title="查看支持的滤镜列表"></a><strong>查看支持的滤镜列表</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -filters</div></pre></td></tr></table></figure><p>2、输出结果（只截取了部分）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD4.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>列数</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包含 3 个字段：<br>（1）是否支持时间轴<br>（2）是否支持分片级别的多线程<br>（3）是否支持命令</td></tr><tr><td>2</td><td>滤镜名</td></tr><tr><td>3</td><td>转换方式：音频转音频（A-&gt;A）、视频转视频（V-&gt;V）等</td></tr><tr><td>4</td><td>滤镜作用说明</td></tr></tbody></table><h3 id="查看-FLV-封装支持的参数"><a href="#查看-FLV-封装支持的参数" class="headerlink" title="查看 FLV 封装支持的参数"></a><strong>查看 FLV 封装支持的参数</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -h muxer=flv</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD5.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>部分</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包括 4 个内容：<br>（1）扩展名<br>（2）MIME 类型<br>（3）默认的视频编码格式<br>（4）默认的音频编码格式</td></tr><tr><td>2</td><td>封装时支持的配置参数和说明</td></tr></tbody></table><h3 id="查看-FLV-解封装支持的参数"><a href="#查看-FLV-解封装支持的参数" class="headerlink" title="查看 FLV 解封装支持的参数"></a><strong>查看 FLV 解封装支持的参数</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -h demuxer=flv</div></pre></td></tr></table></figure><p>2、输出结果（只截取了部分）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD6.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>部分</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>扩展名</td></tr><tr><td>2</td><td>解封装时支持的配置参数和说明</td></tr></tbody></table><h3 id="查看-AVC-编码支持的参数"><a href="#查看-AVC-编码支持的参数" class="headerlink" title="查看 AVC 编码支持的参数"></a><strong>查看 AVC 编码支持的参数</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -h encoder=h264</div></pre></td></tr></table></figure><p>2、输出结果（只截取了部分）：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD7.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>部分</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包括 3 个内容：<br>（1）支持的基本编码方式<br>（2）支持的多线程编码方式<br>（3）支持的像素的色彩格式</td></tr><tr><td>2</td><td>编码时支持的配置参数和说明</td></tr></tbody></table><h3 id="查看-AVC-解码支持的参数"><a href="#查看-AVC-解码支持的参数" class="headerlink" title="查看 AVC 解码支持的参数"></a><strong>查看 AVC 解码支持的参数</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -h decoder=h264</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD8.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>部分</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包括 2 个内容：<br>（1）支持的基本解码方式<br>（2）支持的多线程解码方式</td></tr><tr><td>2</td><td>解码时支持的配置参数和说明</td></tr></tbody></table><h3 id="查看-colorkey-滤镜支持的参数"><a href="#查看-colorkey-滤镜支持的参数" class="headerlink" title="查看 colorkey 滤镜支持的参数"></a><strong>查看 colorkey 滤镜支持的参数</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -h filter=colorkey</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD9.png" alt=""></p><p>3、输出内容包括：</p><table><thead><tr><th>部分</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>包括 2 个内容：<br>（1）支持的色彩格式<br>（2）支持的多线程处理方式<br>（3）支持的输入和输出</td></tr><tr><td>2</td><td>支持的参数和说明</td></tr></tbody></table><h2 id="公共操作部分"><a href="#公共操作部分" class="headerlink" title="公共操作部分"></a><strong>公共操作部分</strong></h2><h2 id="文件操作部分"><a href="#文件操作部分" class="headerlink" title="文件操作部分"></a><strong>文件操作部分</strong></h2><h3 id="拆分出视频"><a href="#拆分出视频" class="headerlink" title="拆分出视频"></a><strong>拆分出视频</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -vcodec copy -vbsf h264_mp4toannexb -an output.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD21.png" alt=""></p><h3 id="拆分出音频"><a href="#拆分出音频" class="headerlink" title="拆分出音频"></a><strong>拆分出音频</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i sample.mp4 -acodec copy -vn output.aac</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD22.png" alt=""></p><h3 id="视频和音频合成"><a href="#视频和音频合成" class="headerlink" title="视频和音频合成"></a><strong>视频和音频合成</strong></h3><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i output.mp4 -i output.aac -vcodec copy -acodec copy -absf aac_adtstoasc test.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD23.png" alt=""></p><h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a><strong>切片</strong></h3><p>segment 参数：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>reference_stream</td><td>字符串</td><td>切片参考用的 stream</td></tr><tr><td>segment_format</td><td>字符串</td><td>切片文件格式</td></tr><tr><td>segment_format_options</td><td>字符串</td><td>切片格式的私有操作参数</td></tr><tr><td>segment_list</td><td>字符串</td><td>切片列表主文件名</td></tr><tr><td>segment_list_flags</td><td>标签</td><td>m3u8 切片的存在形式：<br>live<br>cache</td></tr><tr><td>segment_list_size</td><td>整数</td><td>列表文件的长度</td></tr><tr><td>segment_list_type</td><td>标签</td><td>列表类型：<br>flat<br>csv<br>ext<br>ffconcat<br>m3u8<br>hls</td></tr><tr><td>segment_atclocktime</td><td>布尔</td><td>时钟频率生效参数，启动定时切片间隔用</td></tr><tr><td>segment_clocktime_offset</td><td>时间值</td><td>切片时钟偏移</td></tr><tr><td>segment_clocktime_wrap_duration</td><td>时间值</td><td>切片时钟回滚 duration</td></tr><tr><td>segment_time</td><td>字符串</td><td>切片的 duration</td></tr><tr><td>segment_time_delta</td><td>时间值</td><td>用于设置切片变化时间值</td></tr><tr><td>segment_times</td><td>字符串</td><td>设置切片的时间点</td></tr><tr><td>segment_frames</td><td>字符串</td><td>设置切片的帧位置</td></tr><tr><td>segment_wrap</td><td>整数</td><td>列表回滚阈值</td></tr><tr><td>segment_list_entry_prefix</td><td>字符串</td><td>写文件列表时写入每个切片路径的前置路径</td></tr><tr><td>segment_start_number</td><td>整数</td><td>列表中切片的起始基数</td></tr><tr><td>strftime</td><td>布尔</td><td>设置切片名为生成切片的时间点</td></tr><tr><td>break_non_keyframes</td><td>布尔</td><td>忽略关键帧，按照时间切片</td></tr><tr><td>individual_header_trailer</td><td>布尔</td><td>默认在每个切片中都写入文件头和文件结束容器</td></tr><tr><td>write_header_trailer</td><td>布尔</td><td>只在第一个文件写入文件头以及在最后一个文件写入文件结束容器</td></tr><tr><td>reset_timestamps</td><td>布尔</td><td>每个切片都重新初始化时间戳</td></tr><tr><td>initial_offset</td><td>时间值</td><td>设置初始化时间戳偏移</td></tr></tbody></table><h4 id="segment-format"><a href="#segment-format" class="headerlink" title="segment_format"></a><strong>segment_format</strong></h4><p>HLS 切片格式是 MPEGTS，此处可以指定为其他格式，比如 MP4、FLV 等。<br>切割出来的 MP4 切片文件的时间戳与上一个 MP4 的结束时间戳是连续的。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.mp4 -c copy -f segment -segment_format mp4 test_output-%d.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD31.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD32.png" alt=""></p><p>3、生成的文件：</p><p>test_output-0.mp4～test_output-14.mp4</p><h4 id="segment-list-amp-amp-segment-list-type"><a href="#segment-list-amp-amp-segment-list-type" class="headerlink" title="segment_list &amp;&amp; segment_list_type"></a><strong>segment_list &amp;&amp; segment_list_type</strong></h4><h5 id="ffconcat"><a href="#ffconcat" class="headerlink" title="ffconcat"></a><strong>ffconcat</strong></h5><p>生成 ffconcat 格式的文件索引列表。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.mp4 -c copy -f segment -segment_format mp4 -segment_list_type ffconcat -segment_list output.lst test-output-%d.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD33.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD34.png" alt=""></p><p>3、生成的文件：</p><p>test_output-0.mp4～test_output-14.mp4<br>output.lst</p><p>4、output.lst 的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">ffconcat version 1.0</div><div class="line">file test-output-0.mp4</div><div class="line">file test-output-1.mp4</div><div class="line">file test-output-2.mp4</div><div class="line">file test-output-3.mp4</div><div class="line">file test-output-4.mp4</div><div class="line">file test-output-5.mp4</div><div class="line">file test-output-6.mp4</div><div class="line">file test-output-7.mp4</div><div class="line">file test-output-8.mp4</div><div class="line">file test-output-9.mp4</div><div class="line">file test-output-10.mp4</div><div class="line">file test-output-11.mp4</div><div class="line">file test-output-12.mp4</div><div class="line">file test-output-13.mp4</div><div class="line">file test-output-14.mp4</div></pre></td></tr></table></figure><h5 id="flat"><a href="#flat" class="headerlink" title="flat"></a><strong>flat</strong></h5><p>生成 FLAT 格式的文件索引列表。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.mp4 -c copy -f segment -segment_format mp4 -segment_list_type flat -segment_list output.txt test-output-%d.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD35.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD36.png" alt=""></p><p>3、生成的文件：</p><p>test_output-0.mp4～test_output-14.mp4<br>output.txt</p><p>4、output.txt 的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">test-output-0.mp4</div><div class="line">test-output-1.mp4</div><div class="line">test-output-2.mp4</div><div class="line">test-output-3.mp4</div><div class="line">test-output-4.mp4</div><div class="line">test-output-5.mp4</div><div class="line">test-output-6.mp4</div><div class="line">test-output-7.mp4</div><div class="line">test-output-8.mp4</div><div class="line">test-output-9.mp4</div><div class="line">test-output-10.mp4</div><div class="line">test-output-11.mp4</div><div class="line">test-output-12.mp4</div><div class="line">test-output-13.mp4</div><div class="line">test-output-14.mp4</div></pre></td></tr></table></figure><h5 id="csv"><a href="#csv" class="headerlink" title="csv"></a><strong>csv</strong></h5><p>生成 CSV 格式的文件索引列表。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.mp4 -c copy -f segment -segment_format mp4 -segment_list_type csv -segment_list output.csv test-output-%d.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD37.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD38.png" alt=""></p><p>3、生成的文件：</p><p>test_output-0.mp4～test_output-14.mp4<br>output.csv</p><p>4、output.csv 的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">test-output-0.mp4,0.000000,10.080000</div><div class="line">test-output-1.mp4,10.080000,16.680000</div><div class="line">test-output-2.mp4,16.680000,26.680000</div><div class="line">test-output-3.mp4,26.680000,36.680000</div><div class="line">test-output-4.mp4,36.680000,46.680000</div><div class="line">test-output-5.mp4,46.680000,56.680000</div><div class="line">test-output-6.mp4,56.680000,66.680000</div><div class="line">test-output-7.mp4,66.680000,71.200000</div><div class="line">test-output-8.mp4,71.200000,79.440000</div><div class="line">test-output-9.mp4,79.440000,89.440000</div><div class="line">test-output-10.mp4,89.440000,99.240000</div><div class="line">test-output-11.mp4,99.240000,109.240000</div><div class="line">test-output-12.mp4,109.240000,114.520000</div><div class="line">test-output-13.mp4,114.520000,124.520000</div><div class="line">test-output-14.mp4,124.520000,126.520000</div></pre></td></tr></table></figure><h5 id="m3u8"><a href="#m3u8" class="headerlink" title="m3u8"></a><strong>m3u8</strong></h5><p>生成 M3U8 格式的文件索引列表。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.mp4 -c copy -f segment -segment_format mp4 -segment_list_type m3u8 -segment_list output.m3u8 test-output-%d.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD39.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD40.png" alt=""></p><p>3、生成的文件：</p><p>test_output-0.mp4～test_output-14.mp4<br>output.m3u8</p><p>4、output.m3u8 的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">#EXTM3U</div><div class="line">#EXT-X-VERSION:3</div><div class="line">#EXT-X-MEDIA-SEQUENCE:0</div><div class="line">#EXT-X-ALLOW-CACHE:YES</div><div class="line">#EXT-X-TARGETDURATION:11</div><div class="line">#EXTINF:10.080000,</div><div class="line">test-output-0.mp4</div><div class="line">#EXTINF:6.600000,</div><div class="line">test-output-1.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-2.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-3.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-4.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-5.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-6.mp4</div><div class="line">#EXTINF:4.520000,</div><div class="line">test-output-7.mp4</div><div class="line">#EXTINF:8.240000,</div><div class="line">test-output-8.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-9.mp4</div><div class="line">#EXTINF:9.800000,</div><div class="line">test-output-10.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-11.mp4</div><div class="line">#EXTINF:5.280000,</div><div class="line">test-output-12.mp4</div><div class="line">#EXTINF:10.000000,</div><div class="line">test-output-13.mp4</div><div class="line">#EXTINF:2.000000,</div><div class="line">test-output-14.mp4</div><div class="line">#EXT-X-ENDLIST</div></pre></td></tr></table></figure><h4 id="reset-timestamps"><a href="#reset-timestamps" class="headerlink" title="reset_timestamps"></a><strong>reset_timestamps</strong></h4><p>使每一片切片的时间戳归 0。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f segment -segment_format mp4 -reset_timestamps 1 test_output-%d.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD41.png" alt=""><br><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD42.png" alt=""></p><p>3、生成的文件：</p><p>test_output-0.mp4～test_output-22.mp4</p><h4 id="segment-times"><a href="#segment-times" class="headerlink" title="segment_times"></a><strong>segment_times</strong></h4><p>按照指定的时间点切片，比如第 1 分钟、第 2 分钟、第 3 分钟。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -re -i guibu.flv -c copy -f segment -segment_format mp4 -segment_times 60,120,180 test_output-%d.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD43.png" alt=""></p><p>3、生成的文件：</p><p>test_output-0.mp4～test_output-2.mp4</p><h4 id="ss"><a href="#ss" class="headerlink" title="ss"></a><strong>ss</strong></h4><p>指定剪切开头部分。<br>比如从一个视频文件的第 10 秒钟开始截取内容。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -ss 10 -i guibu.flv -c copy output.ts</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD44.png" alt=""></p><h4 id="t"><a href="#t" class="headerlink" title="t"></a><strong>t</strong></h4><p>指定视频总长度。<br>比如只截取一个视频文件的前 10 秒。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.flv -c copy -t 10 -copyts output.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD45.png" alt=""></p><h4 id="output-ts-offset"><a href="#output-ts-offset" class="headerlink" title="output_ts_offset"></a><strong>output_ts_offset</strong></h4><p>指定输出文件的 start_time。<br>比如指定从第 120 秒开始，截取 10 秒的视频。</p><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i guibu.flv -c copy -t 10 -output_ts_offset 120 output.mp4</div></pre></td></tr></table></figure><p>2、输出结果：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD46.png" alt=""></p><h2 id="视频操作部分"><a href="#视频操作部分" class="headerlink" title="视频操作部分"></a><strong>视频操作部分</strong></h2><h2 id="音频操作部分"><a href="#音频操作部分" class="headerlink" title="音频操作部分"></a><strong>音频操作部分</strong></h2><h2 id="字幕操作部分"><a href="#字幕操作部分" class="headerlink" title="字幕操作部分"></a><strong>字幕操作部分</strong></h2><hr><h1 id="ffmpeg-封装转换和编码转换"><a href="#ffmpeg-封装转换和编码转换" class="headerlink" title="ffmpeg 封装转换和编码转换"></a><strong>ffmpeg 封装转换和编码转换</strong></h1><h2 id="封装转换"><a href="#封装转换" class="headerlink" title="封装转换"></a><strong>封装转换</strong></h2><p>AVFormatContext 部分参数：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>avioflags</td><td>标记<br>direct</td><td>format 的缓冲设置，默认为 0（有缓冲）<br>无缓冲</td></tr><tr><td>probesize</td><td>整数</td><td>在进行媒体数据处理前获得文件内容的大小</td></tr><tr><td>fflags</td><td>标记<br>flush_packets<br>genpts<br>nofillin<br>igndts<br>discadcorrupt<br>sortdts<br>keepside<br>fastseek<br>latm<br>nobuffer<br>bitexact</td><td><br>立即将 packets 数据写入文件中<br>输出时按照正常规则产生 pts<br>不填写可以精确计算缺失的值<br>忽略 dts<br>丢弃损坏的帧<br>尝试以 dts 的顺序为准输出<br>不合并数据<br>快速 seek 操作，但是不够精确<br>设置 RTP MP4_LATM 生效<br>直接读取或写出，不存入 buffer，用于在直播采集时降低延迟<br>不写入随机或者不稳定的数据</td></tr><tr><td>seek2any</td><td>整数</td><td>支持随意位置 seek，这个 seek 不以 keyframe 为参考</td></tr><tr><td>analyzeduration</td><td>整数</td><td>制定解析媒体所需要花销的时间，值越大解析越准确，直播时减小该值可降低延迟</td></tr><tr><td>codec_whitelist</td><td>列表</td><td>设置可解析的 codec 的白名单</td></tr><tr><td>format_whitelist</td><td>列表</td><td>设置可解析的 format 的白名单</td></tr><tr><td>output_ts_offset</td><td>整数</td><td>设置输出文件的起始时间</td></tr></tbody></table><h2 id="编码转换"><a href="#编码转换" class="headerlink" title="编码转换"></a><strong>编码转换</strong></h2><p>AVCodecContext 部分参数：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>b</td><td>整数</td><td>设置音频与视频码率，默认是 200 kb/s，可单独使用 b:v 设置视频码率，使用 b:a 设置音频码率</td></tr><tr><td>ab</td><td>整数</td><td>设置音频的码率，默认是 128 kb/s</td></tr><tr><td>g</td><td>整数</td><td>设置视频 GOP 大小，默认是 12 帧一个 GOP</td></tr><tr><td>ar</td><td>整数</td><td>设置音频采样率，默认为 0</td></tr><tr><td>ac</td><td>整数</td><td>设置音频通道数，默认为 0</td></tr><tr><td>bf</td><td>整数</td><td>设置连续编码为 B 帧的个数，默认为 0</td></tr><tr><td>maxrate</td><td>整数</td><td>最大码率设置，与 bufsize 一同使用，默认为 0</td></tr><tr><td>minrate</td><td>整数</td><td>最小码率设置，配合 maxrate 和 bufsize 可以设置为 CBR 模式，默认为 0</td></tr><tr><td>bufsize</td><td>整数</td><td>设置控制码率的 buffer 大小，默认为 0</td></tr><tr><td>keyint_min</td><td>整数</td><td>设置关键帧最小间隔，默认为 25</td></tr><tr><td>sc_threshold</td><td>整数</td><td>设置场景切换支持，默认为 0</td></tr><tr><td>me_threshold</td><td>整数</td><td>设置运动估计阈值，默认为 0</td></tr><tr><td>mb_threshold</td><td>整数</td><td>设置宏块阈值，默认为 0</td></tr><tr><td>profile</td><td>整数</td><td>设置音视频的 profile，默认为 -99</td></tr><tr><td>level</td><td>整数</td><td>设置音视频的 level，默认为 -99</td></tr><tr><td>timecode_frame_start</td><td>整数</td><td>设置 GOP 的开始时间，需要在 non-drop-frame 默认情况下使用</td></tr><tr><td>channel_layout</td><td>整数</td><td>设置音频通道的布局格式</td></tr><tr><td>threads</td><td>整数</td><td>设置编解码工作的线程数</td></tr></tbody></table><h2 id="一个封装转换-编码转换的例子"><a href="#一个封装转换-编码转换的例子" class="headerlink" title="一个封装转换+编码转换的例子"></a><strong>一个封装转换+编码转换的例子</strong></h2><p>1、输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -i ~/sample.mkv -vcodec mpeg4 -b:v 200k -r 15 -an output.mp4</div></pre></td></tr></table></figure><p>2、输出的信息：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/ffmpeg-%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD10.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg 简介</title>
    <link href="http://www.weichao.io/2018/05/11/FFmpeg-%E7%AE%80%E4%BB%8B/"/>
    <id>http://www.weichao.io/2018/05/11/FFmpeg-简介/</id>
    <published>2018-05-11T14:42:02.000Z</published>
    <updated>2018-05-13T05:07:36.984Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li>《FFmpeg 从入门到精通》</li><li><a href="https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu" title="https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu" target="_blank" rel="external">Compile FFmpeg for Ubuntu, Debian, or Mint</a></li><li><a href="https://www.linuxidc.com/Linux/2017-10/147769.htm" title="https://www.linuxidc.com/Linux/2017-10/147769.htm" target="_blank" rel="external">Ubuntu 16.04安装编译FFmpeg</a></li><li><a href="https://blog.csdn.net/ericbar/article/details/79382783" title="https://blog.csdn.net/ericbar/article/details/79382783" target="_blank" rel="external">在ubuntu16.04下测试ffplay程序</a></li></ul><hr><h1 id="基本组成"><a href="#基本组成" class="headerlink" title="基本组成"></a><strong>基本组成</strong></h1><ul><li>封装模块 AVFormat；</li><li>编解码模块 AVCodec；</li><li>滤镜模块 AVFilter；</li><li>输入输出设备模块 AVDevice；</li><li>工具模块 AVUtil；</li><li>视频图像转换计算模块 swscale；</li><li>音频转换计算模块 swresample。</li></ul><hr><h1 id="编解码工具-ffmpeg"><a href="#编解码工具-ffmpeg" class="headerlink" title="编解码工具 ffmpeg"></a><strong>编解码工具 ffmpeg</strong></h1><p>ffmpeg 是 FFmpeg 源代码编译后生成的一个可执行程序，其可以作为命令行工具使用。</p><p>ffmpeg 的主要工作流程是：<br>1、解封装；<br>2、解码；<br>3、编码；<br>4、封装。</p><hr><h1 id="播放器-ffplay"><a href="#播放器-ffplay" class="headerlink" title="播放器 ffplay"></a><strong>播放器 ffplay</strong></h1><p>ffplay 是 FFmpeg 源代码编译后生成的一个可执行程序，其提供了音视频显示和播放相关的图像信息、音频的波形信息等。</p><hr><h1 id="多媒体分析器-ffprobe"><a href="#多媒体分析器-ffprobe" class="headerlink" title="多媒体分析器 ffprobe"></a><strong>多媒体分析器 ffprobe</strong></h1><p>ffprobe 是 FFmpeg 源代码编译后生成的一个可执行程序，其可以从媒体文件或者媒体流中获得你想要了解的媒体信息，比如音频的参数、视频的参数、媒体容器的参数信息等。</p><hr><h1 id="编译源代码"><a href="#编译源代码" class="headerlink" title="编译源代码"></a><strong>编译源代码</strong></h1><h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a><strong>安装依赖</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div><div class="line">sudo apt-get -y install autoconf automake build-essential libass-dev libfreetype6-dev libsdl1.2-dev libtheora-dev libtool libva-dev libvdpau-dev libvorbis-dev libxcb1-dev libxcb-shm0-dev libxcb-xfixes0-dev pkg-config texinfo zlib1g-dev</div></pre></td></tr></table></figure><h2 id="创建文件夹"><a href="#创建文件夹" class="headerlink" title="创建文件夹"></a><strong>创建文件夹</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir ~/ffmpeg_sources</div></pre></td></tr></table></figure><h2 id="安装编译器（二选一）"><a href="#安装编译器（二选一）" class="headerlink" title="安装编译器（二选一）"></a><strong>安装编译器（二选一）</strong></h2><h3 id="NASM"><a href="#NASM" class="headerlink" title="NASM"></a><strong>NASM</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">cd ~/ffmpeg_sources</div><div class="line">wget https://www.nasm.us/pub/nasm/releasebuilds/2.13.03/nasm-2.13.03.tar.bz2</div><div class="line">tar xjvf nasm-2.13.03.tar.bz2</div><div class="line">cd nasm-2.13.03</div><div class="line">./autogen.sh</div><div class="line">PATH="$HOME/bin:$PATH" ./configure --prefix="$HOME/ffmpeg_build" --bindir="$HOME/bin"</div><div class="line">make</div><div class="line">make install</div></pre></td></tr></table></figure><h3 id="YASM"><a href="#YASM" class="headerlink" title="YASM"></a><strong>YASM</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install yasm</div></pre></td></tr></table></figure><h2 id="安装编解码库"><a href="#安装编解码库" class="headerlink" title="安装编解码库"></a><strong>安装编解码库</strong></h2><h3 id="libx264"><a href="#libx264" class="headerlink" title="libx264"></a><strong>libx264</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libx264-dev</div></pre></td></tr></table></figure><h3 id="libx265"><a href="#libx265" class="headerlink" title="libx265"></a><strong>libx265</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libx265-dev</div></pre></td></tr></table></figure><h3 id="libvpx"><a href="#libvpx" class="headerlink" title="libvpx"></a><strong>libvpx</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libvpx-dev</div></pre></td></tr></table></figure><h3 id="libfdk-aac"><a href="#libfdk-aac" class="headerlink" title="libfdk-aac"></a><strong>libfdk-aac</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libfdk-aac-dev</div></pre></td></tr></table></figure><h3 id="libmp3lame"><a href="#libmp3lame" class="headerlink" title="libmp3lame"></a><strong>libmp3lame</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libmp3lame-dev</div></pre></td></tr></table></figure><h3 id="libopus"><a href="#libopus" class="headerlink" title="libopus"></a><strong>libopus</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install libopus-dev</div></pre></td></tr></table></figure><h2 id="安装-SDL2"><a href="#安装-SDL2" class="headerlink" title="安装 SDL2"></a><strong>安装 SDL2</strong></h2><p>否则无法使用 ffplay 命令，使用时会报错：<code>The program &#39;ffplay&#39; is currently not installed.</code></p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E7%AE%80%E4%BB%8B1526187550322_2.png" alt=""></p><h3 id="下载-SDL2-源代码"><a href="#下载-SDL2-源代码" class="headerlink" title="下载 SDL2 源代码"></a><strong>下载 SDL2 源代码</strong></h3><p>在 <a href="https://www.libsdl.org/download-2.0.php" title="https://www.libsdl.org/download-2.0.php" target="_blank" rel="external">SDL 官网</a>下载 SDL2</p><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E7%AE%80%E4%BB%8B1526187551920_4.png" alt=""></p><h3 id="编译-SDL2"><a href="#编译-SDL2" class="headerlink" title="编译 SDL2"></a><strong>编译 SDL2</strong></h3><p>1、解压缩 SDL2-2.0.8.tar.gz</p><p>2、编译 SDL2</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd ~/Downloads/SDL2-2.0.8</div><div class="line">./configure</div><div class="line">make</div><div class="line">sudo make install</div></pre></td></tr></table></figure><h2 id="编译-FFmpeg"><a href="#编译-FFmpeg" class="headerlink" title="编译 FFmpeg"></a><strong>编译 FFmpeg</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cd ~/ffmpeg_sources</div><div class="line">wget -O ffmpeg-snapshot.tar.bz2 https://ffmpeg.org/releases/ffmpeg-snapshot.tar.bz2</div><div class="line">tar xjvf ffmpeg-snapshot.tar.bz2</div><div class="line">cd ffmpeg</div><div class="line">PATH="$HOME/bin:$PATH"</div><div class="line">PKG_CONFIG_PATH="$HOME/ffmpeg_build/lib/pkgconfig" </div><div class="line">./configure --prefix="$HOME/ffmpeg_build" --pkg-config-flags="--static" --extra-cflags="-I$HOME/ffmpeg_build/include" --extra-ldflags="-L$HOME/ffmpeg_build/lib" --extra-libs="-lpthread -lm" --bindir="$HOME/bin" --enable-gpl --enable-libass --enable-libfdk-aac --enable-libfreetype --enable-libmp3lame --enable-libopus --enable-libvorbis --enable-libvpx --enable-libx264 --enable-nonfree</div><div class="line">PATH="$HOME/bin:$PATH"</div><div class="line">make</div><div class="line">sudo make install</div><div class="line">hash -r</div></pre></td></tr></table></figure><h2 id="让-ffmpeg-命令立刻生效"><a href="#让-ffmpeg-命令立刻生效" class="headerlink" title="让 ffmpeg 命令立刻生效"></a><strong>让 ffmpeg 命令立刻生效</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source ~/.profile</div></pre></td></tr></table></figure><p><strong>注：ffplay 命令需要手动配置 FFmpeg 环境变量并重启 PC</strong></p><h2 id="查看-ffmpeg-版本"><a href="#查看-ffmpeg-版本" class="headerlink" title="查看 ffmpeg 版本"></a><strong>查看 ffmpeg 版本</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffmpeg -version</div></pre></td></tr></table></figure><p><img src="http://otkw6sse5.bkt.clouddn.com/FFmpeg-%E7%AE%80%E4%BB%8B1526045783703_2.png" alt=""></p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;《FFmpeg 从入门到精通》&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>使用 JIMU 框架实现组件化</title>
    <link href="http://www.weichao.io/2018/04/19/%E4%BD%BF%E7%94%A8-JIMU-%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0%E7%BB%84%E4%BB%B6%E5%8C%96/"/>
    <id>http://www.weichao.io/2018/04/19/使用-JIMU-框架实现组件化/</id>
    <published>2018-04-19T13:44:58.000Z</published>
    <updated>2018-05-11T14:26:41.459Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li><a href="https://www.jianshu.com/p/1b1d77f58e84" title="https://www.jianshu.com/p/1b1d77f58e84" target="_blank" rel="external">Android彻底组件化方案实践</a></li><li><a href="https://www.jianshu.com/p/5746e50ed572" title="https://www.jianshu.com/p/5746e50ed572" target="_blank" rel="external">全面组件化—DDComponentForAndroid分析(1)</a></li></ul><hr><h1 id="最后实现的效果"><a href="#最后实现的效果" class="headerlink" title="最后实现的效果"></a><strong>最后实现的效果</strong></h1><p>一个模块既可以作为 application 进行单独打包，也可以作为其他模块的 library 进行打包。</p><hr><h1 id="从零开始实现功能"><a href="#从零开始实现功能" class="headerlink" title="从零开始实现功能"></a><strong>从零开始实现功能</strong></h1><h2 id="下载-JIMU-项目"><a href="#下载-JIMU-项目" class="headerlink" title="下载 JIMU 项目"></a><strong>下载 JIMU 项目</strong></h2><p>JIMU 项目<a href="https://github.com/mqzhangw/JIMU/tree/master" title="https://github.com/mqzhangw/JIMU/tree/master" target="_blank" rel="external">下载地址</a>，后面需要用到其中的 module。</p><h2 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a><strong>新建项目</strong></h2><p>比如 component_demo。</p><h2 id="新建-module"><a href="#新建-module" class="headerlink" title="新建 module"></a><strong>新建 module</strong></h2><p>比如 component1。</p><h2 id="按照-JIMU-使用指南配置"><a href="#按照-JIMU-使用指南配置" class="headerlink" title="按照 JIMU 使用指南配置"></a><strong>按照<a href="https://github.com/mqzhangw/JIMU#%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97" title="https://github.com/mqzhangw/JIMU#%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97" target="_blank" rel="external"> JIMU 使用指南</a>配置</strong></h2><h3 id="主项目引用编译脚本"><a href="#主项目引用编译脚本" class="headerlink" title="主项目引用编译脚本"></a><strong>主项目引用编译脚本</strong></h3><p>1、修改<code>component_demo\gradle.properties</code>为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"># Project-wide Gradle settings.</div><div class="line"></div><div class="line"># IDE (e.g. Android Studio) users:</div><div class="line"># Gradle settings configured through the IDE *will override*</div><div class="line"># any settings specified in this file.</div><div class="line"></div><div class="line"># For more details on how to configure your build environment visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/build_environment.html</div><div class="line"></div><div class="line"># Specifies the JVM arguments used for the daemon process.</div><div class="line"># The setting is particularly useful for tweaking memory settings.</div><div class="line">org.gradle.jvmargs=-Xmx1536m</div><div class="line"></div><div class="line"># When configured, Gradle will run in incubating parallel mode.</div><div class="line"># This option should only be used with decoupled projects. More details, visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects</div><div class="line"># org.gradle.parallel=true</div><div class="line"></div><div class="line">mainmodulename=app</div></pre></td></tr></table></figure><p>2、修改<code>component_demo\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span></div><div class="line"></div><div class="line"><span class="keyword">buildscript</span> &#123;</div><div class="line">    <span class="keyword">repositories</span> &#123;</div><div class="line">        google()</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">dependencies</span> &#123;</div><div class="line">        <span class="keyword">classpath</span> <span class="string">'com.android.tools.build:gradle:3.1.1'</span></div><div class="line">        <span class="keyword">classpath</span> <span class="string">'com.luojilab.ddcomponent:build-gradle:1.2.0'</span></div><div class="line"></div><div class="line">        <span class="comment">// <span class="doctag">NOTE:</span> Do not place your application dependencies here; they belong</span></div><div class="line">        <span class="comment">// in the individual module build.gradle files</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">allprojects</span> &#123;</div><div class="line">    <span class="keyword">repositories</span> &#123;</div><div class="line">        google()</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">task</span> clean(type: <span class="keyword">Delete</span>) &#123;</div><div class="line">    <span class="keyword">delete</span> rootProject.buildDir</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="设置组件可独立打包"><a href="#设置组件可独立打包" class="headerlink" title="设置组件可独立打包"></a><strong>设置组件可独立打包</strong></h3><p>新建<code>component_demo\app\gradle.properties</code>和<code>component_demo\component1\gradle.properties</code>，并写入内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># Project-wide Gradle settings.</div><div class="line"></div><div class="line"># IDE (e.g. Android Studio) users:</div><div class="line"># Gradle settings configured through the IDE *will override*</div><div class="line"># any settings specified in this file.</div><div class="line"></div><div class="line"># For more details on how to configure your build environment visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/build_environment.html</div><div class="line"></div><div class="line"># Specifies the JVM arguments used for the daemon process.</div><div class="line"># The setting is particularly useful for tweaking memory settings.</div><div class="line">org.gradle.jvmargs=-Xmx1536m</div><div class="line"></div><div class="line"># When configured, Gradle will run in incubating parallel mode.</div><div class="line"># This option should only be used with decoupled projects. More details, visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects</div><div class="line"># org.gradle.parallel=true</div><div class="line"></div><div class="line">isRunAlone=true</div><div class="line">debugComponent=sharecomponent</div><div class="line">compileComponent=sharecomponent</div></pre></td></tr></table></figure><h3 id="应用组件化编译脚本"><a href="#应用组件化编译脚本" class="headerlink" title="应用组件化编译脚本"></a><strong>应用组件化编译脚本</strong></h3><p>1、修改<code>component_demo\app\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.dd.comgradle'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">27</span></div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId <span class="string">"io.weichao.component_demo"</span></div><div class="line">        minSdkVersion <span class="number">21</span></div><div class="line">        targetSdkVersion <span class="number">27</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    implementation <span class="string">'com.android.support:appcompat-v7:27.1.1'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">combuild &#123;</div><div class="line">    applicationName = <span class="string">'com.luojilab.reader.runalone.application.ReaderApplication'</span></div><div class="line">    isRegisterCompoAuto = <span class="keyword">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、修改<code>component_demo\component1\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.dd.comgradle'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">27</span></div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId <span class="string">"io.weichao.component1"</span></div><div class="line">        minSdkVersion <span class="number">21</span></div><div class="line">        targetSdkVersion <span class="number">27</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    implementation <span class="string">'com.android.support:appcompat-v7:27.1.1'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">combuild &#123;</div><div class="line">    applicationName = <span class="string">'com.luojilab.reader.runalone.application.ReaderApplication'</span></div><div class="line">    isRegisterCompoAuto = <span class="keyword">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="混淆"><a href="#混淆" class="headerlink" title="混淆"></a><strong>混淆</strong></h3><p>修改<code>component_demo\app\proguard-rules.pro</code>和<code>component_demo\component1\proguard-rules.pro</code>为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-keep interface * &#123;</div><div class="line">  &lt;methods&gt;;</div><div class="line">&#125;</div><div class="line">-keep class com.luojilab.component.componentlib.** &#123;*;&#125;</div><div class="line">-keep class com.luojilab.router.** &#123;*;&#125;</div><div class="line">-keep class * implements com.luojilab.component.componentlib.router.ISyringe &#123;*;&#125;</div><div class="line">-keep class * implements com.luojilab.component.componentlib.applicationlike.IApplicationLike &#123;*;&#125;</div></pre></td></tr></table></figure><h2 id="application-式打包（运行-component1）"><a href="#application-式打包（运行-component1）" class="headerlink" title="application 式打包（运行 component1）"></a><strong>application 式打包（运行 component1）</strong></h2><h3 id="报错：Project-with-path-‘-sharecomponent’-could-not-be-found-in-project-‘-xx’"><a href="#报错：Project-with-path-‘-sharecomponent’-could-not-be-found-in-project-‘-xx’" class="headerlink" title="报错：Project with path ‘:sharecomponent’ could not be found in project ‘:xx’."></a><strong>报错：Project with path ‘:sharecomponent’ could not be found in project ‘:xx’.</strong></h3><p>修改<code>component_demo\app\gradle.properties</code>和<code>component_demo\component1\gradle.properties</code>为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"># Project-wide Gradle settings.</div><div class="line"></div><div class="line"># IDE (e.g. Android Studio) users:</div><div class="line"># Gradle settings configured through the IDE *will override*</div><div class="line"># any settings specified in this file.</div><div class="line"></div><div class="line"># For more details on how to configure your build environment visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/build_environment.html</div><div class="line"></div><div class="line"># Specifies the JVM arguments used for the daemon process.</div><div class="line"># The setting is particularly useful for tweaking memory settings.</div><div class="line">org.gradle.jvmargs=-Xmx1536m</div><div class="line"></div><div class="line"># When configured, Gradle will run in incubating parallel mode.</div><div class="line"># This option should only be used with decoupled projects. More details, visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects</div><div class="line"># org.gradle.parallel=true</div><div class="line"></div><div class="line">isRunAlone=true</div></pre></td></tr></table></figure><h3 id="报错：Cannot-read-packageName-from-xx-src-main-runalone-AndroidManifest-xml"><a href="#报错：Cannot-read-packageName-from-xx-src-main-runalone-AndroidManifest-xml" class="headerlink" title="报错：Cannot read packageName from xx\src\main\runalone\AndroidManifest.xml"></a><strong>报错：Cannot read packageName from xx\src\main\runalone\AndroidManifest.xml</strong></h3><p>新建<code>component_demo\component1\src\main\runalone</code>，在该文件夹中新建<code>AndroidManifest.xml</code>并写入：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">"io.weichao.component1"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">application</span></span></div><div class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">"@mipmap/ic_launcher_round"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".MainActivity"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></div></pre></td></tr></table></figure><h3 id="运行成功"><a href="#运行成功" class="headerlink" title="运行成功"></a><strong>运行成功</strong></h3><p>为了便于展示，修改<code>component_demo\component1\src\main\res\layout\activity_main.xml</code>为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"component1"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="library-式打包（运行-app）"><a href="#library-式打包（运行-app）" class="headerlink" title="library 式打包（运行 app）"></a><strong>library 式打包（运行 app）</strong></h2><p>【非必须】修改<code>component_demo\component1\src\main\AndroidManifest.xml</code>为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">"io.weichao.component1"</span> /&gt;</span></div></pre></td></tr></table></figure><h3 id="app-集成-component1"><a href="#app-集成-component1" class="headerlink" title="app 集成 component1"></a><strong>app 集成 component1</strong></h3><p>修改<code>component_demo\app\gradle.properties</code>为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># Project-wide Gradle settings.</div><div class="line"></div><div class="line"># IDE (e.g. Android Studio) users:</div><div class="line"># Gradle settings configured through the IDE *will override*</div><div class="line"># any settings specified in this file.</div><div class="line"></div><div class="line"># For more details on how to configure your build environment visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/build_environment.html</div><div class="line"></div><div class="line"># Specifies the JVM arguments used for the daemon process.</div><div class="line"># The setting is particularly useful for tweaking memory settings.</div><div class="line">org.gradle.jvmargs=-Xmx1536m</div><div class="line"></div><div class="line"># When configured, Gradle will run in incubating parallel mode.</div><div class="line"># This option should only be used with decoupled projects. More details, visit</div><div class="line"># http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects</div><div class="line"># org.gradle.parallel=true</div><div class="line"></div><div class="line">isRunAlone=true</div><div class="line">debugComponent=component1</div><div class="line">compileComponent=component1</div></pre></td></tr></table></figure><h3 id="组件数据交互"><a href="#组件数据交互" class="headerlink" title="组件数据交互"></a><strong>组件数据交互</strong></h3><h4 id="新建专用于数据交互的-module"><a href="#新建专用于数据交互的-module" class="headerlink" title="新建专用于数据交互的 module"></a><strong>新建专用于数据交互的 module</strong></h4><p>新建<code>component_demo\component_service\src\main\java\io\weichao\component_service\Component1Service.java</code>用于其他 module 和 component1 的交互：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.component_service;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Component1Service</span> </span>&#123;</div><div class="line">    <span class="function">String <span class="title">getComponentStr</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="component1-引入-component-service"><a href="#component1-引入-component-service" class="headerlink" title="component1 引入 component_service"></a><strong>component1 引入 component_service</strong></h4><p>修改<code>component_demo\component1\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.dd.comgradle'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">27</span></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion <span class="number">21</span></div><div class="line">        targetSdkVersion <span class="number">27</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    <span class="keyword">compile</span> <span class="keyword">project</span>(<span class="string">':component_service'</span>)</div><div class="line">    implementation <span class="string">'com.android.support:appcompat-v7:27.1.1'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">combuild &#123;</div><div class="line">    applicationName = <span class="string">'com.luojilab.reader.runalone.application.ReaderApplication'</span></div><div class="line">    isRegisterCompoAuto = <span class="keyword">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="component1-实现-Component1Service-接口"><a href="#component1-实现-Component1Service-接口" class="headerlink" title="component1 实现 Component1Service 接口"></a><strong>component1 实现 Component1Service 接口</strong></h4><p>新建<code>component_demo\component1\src\main\java\io\weichao\component1\Component1ServiceImpl.java</code>，并写入内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.component1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> io.weichao.component_service.Component1Service;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Component1ServiceImpl</span> <span class="keyword">implements</span> <span class="title">Component1Service</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getComponentStr</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"component1"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="将-Component1ServiceImpl-注册到-Router-中"><a href="#将-Component1ServiceImpl-注册到-Router-中" class="headerlink" title="将 Component1ServiceImpl 注册到 Router 中"></a><strong>将 Component1ServiceImpl 注册到 Router 中</strong></h4><p>1、导入已下载的 JIMU 项目中的 componentlib。</p><h5 id="报错：Plugin-with-id-‘com-github-dcendents-android-maven’-not-found"><a href="#报错：Plugin-with-id-‘com-github-dcendents-android-maven’-not-found" class="headerlink" title="报错：Plugin with id ‘com.github.dcendents.android-maven’ not found."></a><strong>报错：Plugin with id ‘com.github.dcendents.android-maven’ not found.</strong></h5><p>修改<code>component_demo\componentlib\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.android.library'</span></div><div class="line"></div><div class="line"><span class="keyword">sourceCompatibility</span> = <span class="string">"1.7"</span></div><div class="line"><span class="keyword">targetCompatibility</span> = <span class="string">"1.7"</span></div><div class="line"></div><div class="line"></div><div class="line">ext &#123;</div><div class="line">    bintrayName = <span class="string">'componentlib'</span></div><div class="line">    artifact = bintrayName</div><div class="line">    libraryName = <span class="string">'component build lib '</span></div><div class="line">    libraryDescription = <span class="string">'component build lib '</span></div><div class="line">    libraryVersion = <span class="string">"1.3.1"</span></div><div class="line">    licenseName = <span class="string">'The Apache Software License, Version 2.0'</span></div><div class="line">    licenseUrl = <span class="string">'http://www.apache.org/licenses/LICENSE-2.0.txt'</span></div><div class="line">    allLicenses = [<span class="string">"Apache-2.0"</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">26</span></div><div class="line">    buildToolsVersion <span class="string">"26.0.0"</span></div><div class="line"></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion <span class="number">15</span></div><div class="line">        targetSdkVersion <span class="number">26</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line"></div><div class="line">        testInstrumentationRunner <span class="string">"android.support.test.runner.AndroidJUnitRunner"</span></div><div class="line"></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    <span class="keyword">compile</span> <span class="keyword">fileTree</span>(<span class="keyword">include</span>: [<span class="string">'*.jar'</span>], dir: <span class="string">'libs'</span>)</div><div class="line">    <span class="keyword">compile</span> <span class="string">'com.android.support:appcompat-v7:26.+'</span></div><div class="line">    androidTestCompile(<span class="string">'com.android.support.test.espresso:espresso-core:2.2.2'</span>, &#123;</div><div class="line">        <span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'com.android.support'</span>, module: <span class="string">'support-annotations'</span></div><div class="line">    &#125;)</div><div class="line">    testCompile <span class="string">'junit:junit:4.12'</span></div><div class="line"><span class="comment">//    compile project(':router-annotation')</span></div><div class="line">    <span class="keyword">compile</span> <span class="string">'com.github.jimu:router-annotation:1.0.1'</span></div><div class="line">    <span class="keyword">compile</span> <span class="string">'com.google.code.gson:gson:2.8.2'</span></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//apply from: 'https://raw.githubusercontent.com/nuuneoi/JCenter/master/installv1.gradle'</span></div><div class="line"><span class="comment">//apply from: 'https://raw.githubusercontent.com/nuuneoi/JCenter/master/bintrayv1.gradle'</span></div></pre></td></tr></table></figure><p>2、修改<code>component_demo\component_service\build.gradle</code>：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.android.library'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">27</span></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion <span class="number">21</span></div><div class="line">        targetSdkVersion <span class="number">27</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    implementation <span class="string">'com.android.support:appcompat-v7:27.1.1'</span></div><div class="line">    <span class="keyword">compile</span> <span class="keyword">project</span>(<span class="string">':componentlib'</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>3、新建<code>component_demo\component1\src\main\java\io\weichao\component1\Component1ApplicationLike.java</code>，并写入内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.component1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.applicationlike.IApplicationLike;</div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.router.Router;</div><div class="line"></div><div class="line"><span class="keyword">import</span> io.weichao.component_service.Component1Service;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Component1ApplicationLike</span> <span class="keyword">implements</span> <span class="title">IApplicationLike</span> </span>&#123;</div><div class="line">    Router router = Router.getInstance();</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">        router.addService(Component1Service.class.getSimpleName(), <span class="keyword">new</span> Component1ServiceImpl());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</div><div class="line">        router.removeService(Component1Service.class.getSimpleName());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="app-调用-Component1"><a href="#app-调用-Component1" class="headerlink" title="app 调用 Component1"></a><strong>app 调用 Component1</strong></h4><p>1、修改<code>component_demo\app\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.dd.comgradle'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">27</span></div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId <span class="string">"io.weichao.component_demo"</span></div><div class="line">        minSdkVersion <span class="number">21</span></div><div class="line">        targetSdkVersion <span class="number">27</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    <span class="keyword">compile</span> <span class="keyword">project</span>(<span class="string">':component_service'</span>)</div><div class="line">    implementation <span class="string">'com.android.support:appcompat-v7:27.1.1'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">combuild &#123;</div><div class="line">    applicationName = <span class="string">'io.weichao.component_demo.MainApplication'</span></div><div class="line">    isRegisterCompoAuto = <span class="keyword">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2、修改<code>component_demo\app\src\main\java\io\weichao\component_demo\MainActivity.java</code>为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.component_demo;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.widget.Toast;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.router.Router;</div><div class="line"></div><div class="line"><span class="keyword">import</span> io.weichao.component_service.Component1Service;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        Router router = Router.getInstance();</div><div class="line">        <span class="keyword">if</span> (router.getService(Component1Service.class.getSimpleName()) != <span class="keyword">null</span>) &#123;</div><div class="line">            Component1Service service = (Component1Service) router.getService(Component1Service.class.getSimpleName());</div><div class="line">            Toast.makeText(<span class="keyword">this</span>, service.getComponentStr(), Toast.LENGTH_LONG).show();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="报错：Library-projects-cannot-set-applicationId-applicationId-is-set-to-‘xx’-in-default-config"><a href="#报错：Library-projects-cannot-set-applicationId-applicationId-is-set-to-‘xx’-in-default-config" class="headerlink" title="报错：Library projects cannot set applicationId. applicationId is set to ‘xx’ in default config."></a><strong>报错：Library projects cannot set applicationId. applicationId is set to ‘xx’ in default config.</strong></h3><p>修改<code>component_demo\component1\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.dd.comgradle'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">27</span></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion <span class="number">21</span></div><div class="line">        targetSdkVersion <span class="number">27</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    implementation <span class="string">'com.android.support:appcompat-v7:27.1.1'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">combuild &#123;</div><div class="line">    applicationName = <span class="string">'com.luojilab.reader.runalone.application.ReaderApplication'</span></div><div class="line">    isRegisterCompoAuto = <span class="keyword">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="报错：Unable-to-find-source-java-class-‘xx’-because-it-does-not-belong-to-any-of-the-source-dirs-‘xx’"><a href="#报错：Unable-to-find-source-java-class-‘xx’-because-it-does-not-belong-to-any-of-the-source-dirs-‘xx’" class="headerlink" title="报错：Unable to find source java class: ‘xx’ because it does not belong to any of the source dirs: ‘xx’"></a><strong>报错：Unable to find source java class: ‘xx’ because it does not belong to any of the source dirs: ‘xx’</strong></h3><p>clean 项目。</p><h3 id="运行成功-1"><a href="#运行成功-1" class="headerlink" title="运行成功"></a><strong>运行成功</strong></h3><h2 id="UI-跳转"><a href="#UI-跳转" class="headerlink" title="UI 跳转"></a><strong>UI 跳转</strong></h2><h3 id="组件添加必要的依赖"><a href="#组件添加必要的依赖" class="headerlink" title="组件添加必要的依赖"></a><strong>组件添加必要的依赖</strong></h3><p>修改<code>component_demo\component1\build.gradle</code>为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.dd.comgradle'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">27</span></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion <span class="number">21</span></div><div class="line">        targetSdkVersion <span class="number">27</span></div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">        javaCompileOptions &#123;</div><div class="line">            annotationProcessorOptions &#123;</div><div class="line">                arguments = [host: <span class="string">"component1"</span>]</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="keyword">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">dependencies</span> &#123;</div><div class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</div><div class="line">    <span class="keyword">compile</span> <span class="keyword">project</span>(<span class="string">':component_service'</span>)</div><div class="line">    implementation <span class="string">'com.android.support:appcompat-v7:27.1.1'</span></div><div class="line">    annotationProcessor <span class="string">'com.github.jimu:router-anno-compiler:1.0.1'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">combuild &#123;</div><div class="line">    applicationName = <span class="string">'io.weichao.component1.MainApplication'</span></div><div class="line">    isRegisterCompoAuto = <span class="keyword">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="注册组件到-UIRouter-中"><a href="#注册组件到-UIRouter-中" class="headerlink" title="注册组件到 UIRouter 中"></a><strong>注册组件到 UIRouter 中</strong></h3><p>修改<code>component_demo\component1\src\main\java\io\weichao\component1\Component1ApplicationLike.java</code>为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.component1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.applicationlike.IApplicationLike;</div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.router.Router;</div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.router.ui.UIRouter;</div><div class="line"></div><div class="line"><span class="keyword">import</span> io.weichao.component_service.Component1Service;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Component1ApplicationLike</span> <span class="keyword">implements</span> <span class="title">IApplicationLike</span> </span>&#123;</div><div class="line">    Router router = Router.getInstance();</div><div class="line">    UIRouter uiRouter = UIRouter.getInstance();</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">        router.addService(Component1Service.class.getSimpleName(), <span class="keyword">new</span> Component1ServiceImpl());</div><div class="line">        uiRouter.registerUI(<span class="string">"component1"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</div><div class="line">        router.removeService(Component1Service.class.getSimpleName());</div><div class="line">        uiRouter.unregisterUI(<span class="string">"component1"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="目标页面添加注解"><a href="#目标页面添加注解" class="headerlink" title="目标页面添加注解"></a><strong>目标页面添加注解</strong></h3><p>修改<code>component_demo\component1\src\main\java\io\weichao\component1\MainActivity.java</code>为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.component1;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Intent;</div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.text.TextUtils;</div><div class="line"><span class="keyword">import</span> android.widget.TextView;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.service.AutowiredService;</div><div class="line"><span class="keyword">import</span> com.luojilab.router.facade.annotation.Autowired;</div><div class="line"><span class="keyword">import</span> com.luojilab.router.facade.annotation.RouteNode;</div><div class="line"></div><div class="line"><span class="meta">@RouteNode</span>(path = <span class="string">"/main"</span>, desc = <span class="string">"主页面"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    String arg;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.component1_activity_main);</div><div class="line">        TextView tv = findViewById(R.id.textview);</div><div class="line"></div><div class="line">        AutowiredService.Factory.getSingletonImpl().autowire(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (!TextUtils.isEmpty(arg)) &#123;</div><div class="line">            tv.setText(arg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Intent intent = <span class="keyword">new</span> Intent();</div><div class="line">        intent.putExtra(<span class="string">"callbackArg"</span>, <span class="string">"success"</span>);</div><div class="line">        setResult(RESULT_OK, intent);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="跳转"><a href="#跳转" class="headerlink" title="跳转"></a><strong>跳转</strong></h3><p>1、修改<code>component_demo\app\src\main\res\layout\activity_main.xml</code>为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></div><div class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_bundle"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Bundle 方式"</span> /&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_uri"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"URI 方式"</span> /&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_callback"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"有 callback 方式"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure><p>2、修改<code>component_demo\app\src\main\java\io\weichao\component_demo\MainActivity.java</code>为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.component_demo;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Intent;</div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.text.TextUtils;</div><div class="line"><span class="keyword">import</span> android.view.View;</div><div class="line"><span class="keyword">import</span> android.widget.Button;</div><div class="line"><span class="keyword">import</span> android.widget.Toast;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.router.Router;</div><div class="line"><span class="keyword">import</span> com.luojilab.component.componentlib.router.ui.UIRouter;</div><div class="line"></div><div class="line"><span class="keyword">import</span> io.weichao.component_service.Component1Service;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">        Button bundleBtn = findViewById(R.id.btn_bundle);</div><div class="line">        Button uriBtn = findViewById(R.id.btn_uri);</div><div class="line">        Button callbackBtn = findViewById(R.id.btn_callback);</div><div class="line">        bundleBtn.setOnClickListener(<span class="keyword">this</span>);</div><div class="line">        uriBtn.setOnClickListener(<span class="keyword">this</span>);</div><div class="line">        callbackBtn.setOnClickListener(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">        Router router = Router.getInstance();</div><div class="line">        <span class="keyword">if</span> (router.getService(Component1Service.class.getSimpleName()) != <span class="keyword">null</span>) &#123;</div><div class="line">            Component1Service service = (Component1Service) router.getService(Component1Service.class.getSimpleName());</div><div class="line">            Toast.makeText(<span class="keyword">this</span>, service.getComponentStr(), Toast.LENGTH_LONG).show();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">        String arg = <span class="string">"app arg"</span>;</div><div class="line"></div><div class="line">        Bundle bundle = <span class="keyword">new</span> Bundle();</div><div class="line">        bundle.putString(<span class="string">"arg"</span>, arg);</div><div class="line"></div><div class="line">        <span class="keyword">final</span> String URI_LEGAL = <span class="string">"DDComp://component1/main?arg="</span> + arg;</div><div class="line"></div><div class="line">        <span class="keyword">switch</span> (v.getId()) &#123;</div><div class="line">            <span class="keyword">case</span> R.id.btn_bundle:</div><div class="line">                UIRouter.getInstance().openUri(<span class="keyword">this</span>, <span class="string">"DDComp://component1/main"</span>, bundle);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> R.id.btn_uri:</div><div class="line">                UIRouter.getInstance().openUri(<span class="keyword">this</span>, URI_LEGAL, <span class="keyword">null</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> R.id.btn_callback:</div><div class="line">                UIRouter.getInstance().openUri(<span class="keyword">this</span>, URI_LEGAL, <span class="keyword">null</span>, <span class="number">7777</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent data)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, data);</div><div class="line">        <span class="keyword">if</span> (data != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (requestCode == <span class="number">7777</span> &amp;&amp; resultCode == RESULT_OK) &#123;</div><div class="line">                String callbackArg = data.getStringExtra(<span class="string">"callbackArg"</span>);</div><div class="line">                <span class="keyword">if</span> (!TextUtils.isEmpty(callbackArg)) &#123;</div><div class="line">                    Toast.makeText(<span class="keyword">this</span>, callbackArg, Toast.LENGTH_LONG).show();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="报错：android-content-ActivityNotFoundException-Unable-to-find-explicit-activity-class-xxActivity-have-you-declared-this-activity-in-your-AndroidManifest-xml"><a href="#报错：android-content-ActivityNotFoundException-Unable-to-find-explicit-activity-class-xxActivity-have-you-declared-this-activity-in-your-AndroidManifest-xml" class="headerlink" title="报错：android.content.ActivityNotFoundException: Unable to find explicit activity class {xxActivity}; have you declared this activity in your AndroidManifest.xml?"></a><strong>报错：android.content.ActivityNotFoundException: Unable to find explicit activity class {xxActivity}; have you declared this activity in your AndroidManifest.xml?</strong></h4><p>修改<code>component_demo\component1\src\main\AndroidManifest.xml</code>为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">"io.weichao.component1"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">application</span></span></div><div class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">"@mipmap/ic_launcher_round"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".MainActivity"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></div></pre></td></tr></table></figure><h4 id="报错：java-lang-NoSuchFieldError-No-field-xx-in-class-Lxx-R-id-or-its-superclasses-declaration-of-‘xx-R-id’-appears-in-data-app-xx-base-apk"><a href="#报错：java-lang-NoSuchFieldError-No-field-xx-in-class-Lxx-R-id-or-its-superclasses-declaration-of-‘xx-R-id’-appears-in-data-app-xx-base-apk" class="headerlink" title="报错：java.lang.NoSuchFieldError: No field xx in class Lxx/R$id; or its superclasses (declaration of ‘xx.R$id’ appears in /data/app/xx/base.apk)"></a><strong>报错：java.lang.NoSuchFieldError: No field xx in class Lxx/R$id; or its superclasses (declaration of ‘xx.R$id’ appears in /data/app/xx/base.apk)</strong></h4><p>重命名<code>component_demo\component1\src\main\res\layout\activity_main.xml</code>为<code>component_demo\component1\src\main\res\layout\component1_activity_main.xml</code>。</p><p>修改<code>component_demo\component1\src\main\res\layout\component1_activity_main.xml</code>为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/textview"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"component1"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure><h3 id="运行成功-2"><a href="#运行成功-2" class="headerlink" title="运行成功"></a><strong>运行成功</strong></h3><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ww
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>使用 libstreaming 实现同屏时的代码执行流程</title>
    <link href="http://www.weichao.io/2018/03/11/%E4%BD%BF%E7%94%A8-libstreaming-%E5%AE%9E%E7%8E%B0%E5%90%8C%E5%B1%8F%E6%97%B6%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/"/>
    <id>http://www.weichao.io/2018/03/11/使用-libstreaming-实现同屏时的代码执行流程/</id>
    <published>2018-03-11T10:39:10.000Z</published>
    <updated>2018-03-11T10:45:16.396Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li><a href="https://github.com/fyhertz/libstreaming" title="https://github.com/fyhertz/libstreaming" target="_blank" rel="external">libstreaming</a></li><li><a href="https://github.com/weichao66666/MediaMirror" title="https://github.com/weichao66666/MediaMirror" target="_blank" rel="external">MediaMirror</a></li></ul><hr><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a><strong>概述</strong></h1><p>实现同屏需要一个服务端和至少一个客户端。服务端是发送音视频数据的，数据来源可以是相机、屏幕捕捉等。客户端是接收音视频数据的，接收到的数据会实时在屏幕上显示。</p><p><code>MediaMirror</code>是<code>libstreaming</code>的 demo，实现了服务端通过相机采集数据，并发送数据给客户端，客户端实时在屏幕上显示的功能。</p><p>实现同屏的操作是：<br>1、服务端和客户端连接同一个 AP。<br>2、服务端安装在 Android 6.0+ 系统上需要手动授权。<br>3、客户端需要修改 IP 地址指向服务端。<br>4、先启动服务端，再启动客户端。</p><p><code>MediaMirror</code>基于<code>libstreaming</code>，对代码有修改，以下分析基于<code>MediaMirror</code>。</p><hr><h1 id="启动服务端"><a href="#启动服务端" class="headerlink" title="启动服务端"></a><strong>启动服务端</strong></h1><h2 id="入口-Activity"><a href="#入口-Activity" class="headerlink" title="入口 Activity"></a><strong>入口 Activity</strong></h2><p>代码很少，全部贴出来：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">SurfaceHolder</span>.<span class="title">Callback</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> SurfaceView surfaceView;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Session session;</div><div class="line">    <span class="keyword">private</span> RtspServer rtspServer;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        surfaceView = findViewById(R.id.surface);</div><div class="line"></div><div class="line">        surfaceView.getHolder().addCallback(<span class="keyword">this</span>);</div><div class="line">        startRtspServer();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDestroy();</div><div class="line">        stopRtspServer();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startRtspServer</span><span class="params">()</span> </span>&#123;</div><div class="line">        rtspServer = <span class="keyword">new</span> RtspServer();</div><div class="line">        rtspServer.start();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stopRtspServer</span><span class="params">()</span> </span>&#123;</div><div class="line">        rtspServer.stop();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">buildSession</span><span class="params">()</span> </span>&#123;</div><div class="line">        session = SessionBuilder.getInstance()</div><div class="line">                .setSurfaceView(surfaceView)</div><div class="line">                .setPreviewOrientation(<span class="number">90</span>)</div><div class="line">                .setContext(<span class="keyword">this</span>)</div><div class="line">                .setAudioEncoder(SessionBuilder.AUDIO_AAC)</div><div class="line">                .setAudioQuality(<span class="keyword">new</span> AudioQuality(<span class="number">16000</span>, <span class="number">32000</span>))</div><div class="line">                .setVideoEncoder(SessionBuilder.VIDEO_H264)</div><div class="line">                .setVideoQuality(<span class="keyword">new</span> VideoQuality(<span class="number">320</span>, <span class="number">240</span>, <span class="number">20</span>, <span class="number">500000</span>))</div><div class="line">                .build();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*SurfaceHolder.Callback start*/</span></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">surfaceCreated</span><span class="params">(SurfaceHolder holder)</span> </span>&#123;</div><div class="line">        buildSession();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">surfaceChanged</span><span class="params">(SurfaceHolder holder, <span class="keyword">int</span> format, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">surfaceDestroyed</span><span class="params">(SurfaceHolder holder)</span> </span>&#123;</div><div class="line">        session.release();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*SurfaceHolder.Callback end*/</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>布局文件中只有一个普通的<code>SurfaceView</code>，在<code>SurfaceView</code>回调<code>surfaceCreated(SurfaceHolder holder)</code>方法时会调用<code>buildSession()</code>方法，<code>buildSession()</code>设置了<code>Session</code>的参数并最终调用<code>SessionBuilder#build()</code>方法进行初始化。</p><p>然后，创建了<code>RtspServer</code>实例并启动。</p><h3 id="SessionBuilder-build"><a href="#SessionBuilder-build" class="headerlink" title="SessionBuilder#build()"></a><strong>SessionBuilder#build()</strong></h3><p>创建 H.264 视频的对应流并设置给<code>Session</code>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">H264Stream stream = <span class="keyword">new</span> H264Stream(mCameraFacing);</div><div class="line"><span class="keyword">if</span> (mContext != <span class="keyword">null</span>) &#123;</div><div class="line">    stream.setSharedPreferences(PreferenceManager.getDefaultSharedPreferences(mContext));</div><div class="line">&#125;</div><div class="line">session.addVideoTrack(stream);</div></pre></td></tr></table></figure><p>创建 AAC 音频的对应流并设置给<code>Session</code>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">AacStream stream = <span class="keyword">new</span> AacStream();</div><div class="line">session.addAudioTrack(stream);</div><div class="line"><span class="keyword">if</span> (mContext != <span class="keyword">null</span>) &#123;</div><div class="line">    stream.setPreferences(PreferenceManager.getDefaultSharedPreferences(mContext));</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="H264Stream-构造函数"><a href="#H264Stream-构造函数" class="headerlink" title="H264Stream 构造函数"></a><strong>H264Stream 构造函数</strong></h4><p><code>H264Stream</code>是<code>VideoStream</code>的子类，这里调用了<code>VideoStream</code>的有参构造函数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">super</span>(cameraId);</div></pre></td></tr></table></figure><p>创建了<code>H264Packetizer</code>实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">packetizer = <span class="keyword">new</span> H264Packetizer();</div></pre></td></tr></table></figure><h5 id="VideoStream-有参构造函数"><a href="#VideoStream-有参构造函数" class="headerlink" title="VideoStream 有参构造函数"></a><strong>VideoStream 有参构造函数</strong></h5><p><code>VideoStream</code>是<code>MediaStream</code>的子类，这里调用了<code>MediaStream</code>的无参构造函数。</p><h5 id="H264Packetizer-构造函数"><a href="#H264Packetizer-构造函数" class="headerlink" title="H264Packetizer 构造函数"></a><strong>H264Packetizer 构造函数</strong></h5><p><code>H264Packetizer</code>是<code>AbstractPacketizer</code>的子类，这里调用了<code>AbstractPacketizer</code>的无参构造函数。</p><h6 id="AbstractPacketizer-构造函数"><a href="#AbstractPacketizer-构造函数" class="headerlink" title="AbstractPacketizer 构造函数"></a><strong>AbstractPacketizer 构造函数</strong></h6><p>创建了<code>RtpSocket</code>实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rtpSocket = <span class="keyword">new</span> RtpSocket();</div></pre></td></tr></table></figure><p>####### <strong>RtpSocket 构造函数</strong></p><p>创建 UDP 的数据包数组：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">datagramPackets = <span class="keyword">new</span> DatagramPacket[bufferCount];</div></pre></td></tr></table></figure><p>创建<code>MulticastSocket</code>实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">multicastSocket = <span class="keyword">new</span> MulticastSocket();</div></pre></td></tr></table></figure><h4 id="AacStream-构造函数"><a href="#AacStream-构造函数" class="headerlink" title="AacStream 构造函数"></a><strong>AacStream 构造函数</strong></h4><p><code>AacStream</code>是<code>AudioStream</code>的子类，这里调用了<code>AudioStream</code>的无参构造函数。</p><h5 id="AudioStream-构造函数"><a href="#AudioStream-构造函数" class="headerlink" title="AudioStream 构造函数"></a><strong>AudioStream 构造函数</strong></h5><p><code>AudioStream</code>是<code>MediaStream</code>的子类，这里调用了<code>MediaStream</code>的无参构造函数。</p><h3 id="RtspServer-start"><a href="#RtspServer-start" class="headerlink" title="RtspServer#start()"></a><strong>RtspServer#start()</strong></h3><p>创建<code>RequestListener</code>实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">requestListener = <span class="keyword">new</span> RequestListener();</div></pre></td></tr></table></figure><h4 id="RequestListener-构造函数"><a href="#RequestListener-构造函数" class="headerlink" title="RequestListener 构造函数"></a><strong>RequestListener 构造函数</strong></h4><p><code>RequestListener</code>是一个线程，在构造函数中会创建<code>ServerSocket</code>实例，并开启这个线程：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">serverSocket = <span class="keyword">new</span> ServerSocket(port);</div><div class="line">start();</div></pre></td></tr></table></figure><h5 id="RequestListener-run"><a href="#RequestListener-run" class="headerlink" title="RequestListener#run()"></a><strong>RequestListener#run()</strong></h5><p>创建<code>WorkerThread</code>实例，<code>WorkerThread</code>同样是个线程，创建后立刻开启线程：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> WorkerThread(serverSocket.accept()).start();</div></pre></td></tr></table></figure><h6 id="WorkerThread-有参构造函数"><a href="#WorkerThread-有参构造函数" class="headerlink" title="WorkerThread 有参构造函数"></a><strong>WorkerThread 有参构造函数</strong></h6><p>创建客户端输入流的缓冲流和输出流：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mInput = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(client.getInputStream()));</div><div class="line">mOutput = client.getOutputStream();</div></pre></td></tr></table></figure><p>创建<code>Session</code>实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">session = <span class="keyword">new</span> Session();</div></pre></td></tr></table></figure><p>####### <strong>WorkerThread#run()</strong></p><p>等待客户端连接，如果接收到客户端请求，解析该请求，并做出对应的响应，最后发送响应给客户端。</p><p>当客户端断开连接后，停止流传输并释放资源：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span> streaming = isStreaming();</div><div class="line">session.syncStop();</div><div class="line"><span class="keyword">if</span> (streaming &amp;&amp; !isStreaming()) &#123;</div><div class="line">    postMessage(MESSAGE_STREAMING_STOPPED);</div><div class="line">&#125;</div><div class="line">session.release();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    mClient.close();</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    e.printStackTrace();</div><div class="line">&#125;</div></pre></td></tr></table></figure><hr><h1 id="启动客户端"><a href="#启动客户端" class="headerlink" title="启动客户端"></a><strong>启动客户端</strong></h1><h2 id="入口-Activity-1"><a href="#入口-Activity-1" class="headerlink" title="入口 Activity"></a><strong>入口 Activity</strong></h2><p>代码很少，全部贴出来：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">SurfaceHolder</span>.<span class="title">Callback</span>, <span class="title">MediaPlayer</span>.<span class="title">OnPreparedListener</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String VIDEO_URL_HOST = <span class="string">"192.168.0.114"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String VIDEO_URL_PORT = <span class="string">"8086"</span>;<span class="comment">// RtspServer.DEFAULT_RTSP_PORT</span></div><div class="line"></div><div class="line">    <span class="keyword">private</span> SurfaceView surfaceView;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> MediaPlayer mediaPlayer;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        surfaceView = findViewById(R.id.surface);</div><div class="line"></div><div class="line">        surfaceView.getHolder().addCallback(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">configureMediaPlayer</span><span class="params">(Uri videoUri)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mediaPlayer == <span class="keyword">null</span>) &#123;</div><div class="line">            mediaPlayer = <span class="keyword">new</span> MediaPlayer();</div><div class="line">        &#125;</div><div class="line">        mediaPlayer.setDisplay(surfaceView.getHolder());</div><div class="line">        mediaPlayer.setOnPreparedListener(<span class="keyword">this</span>);</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            mediaPlayer.setDataSource(<span class="keyword">this</span>, videoUri);</div><div class="line">            mediaPlayer.prepareAsync();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">releaseMediaPlayer</span><span class="params">()</span> </span>&#123;</div><div class="line">        surfaceView.getHolder().removeCallback(<span class="keyword">this</span>);</div><div class="line">        mediaPlayer.release();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*SurfaceHolder.Callback start*/</span></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">surfaceCreated</span><span class="params">(SurfaceHolder holder)</span> </span>&#123;</div><div class="line">        StringBuilder videoUrlBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line">        videoUrlBuilder.append(<span class="string">"rtsp://"</span> + VIDEO_URL_HOST + <span class="string">":"</span> + VIDEO_URL_PORT + <span class="string">"/"</span>);</div><div class="line">        Uri videoUri = Uri.parse(videoUrlBuilder.toString());</div><div class="line">        configureMediaPlayer(videoUri);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">surfaceChanged</span><span class="params">(SurfaceHolder holder, <span class="keyword">int</span> format, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">surfaceDestroyed</span><span class="params">(SurfaceHolder holder)</span> </span>&#123;</div><div class="line">        releaseMediaPlayer();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*SurfaceHolder.Callback end*/</span></div><div class="line"></div><div class="line">    <span class="comment">/*MediaPlayer.OnPreparedListener start*/</span></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPrepared</span><span class="params">(MediaPlayer mp)</span> </span>&#123;</div><div class="line">        mp.start();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*MediaPlayer.OnPreparedListener end*/</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>布局文件中只有一个 Android 原生的<code>VideoView</code>，<code>VideoView</code>是<code>SurfaceView</code>的子类，在<code>SurfaceView</code>回调<code>surfaceCreated(SurfaceHolder holder)</code>方法时，调用<code>configureMediaPlayer()</code>方法，该方法中会创建<code>MediaPlayer</code>实例，并在设置<code>MediaPlayer</code>的参数后开始准备，最后在<code>onPrepared(MediaPlayer mp)</code>回调中开始播放。</p><p><code>VideoView</code>支持<code>RTSP</code>，<code>RTSP</code>请求都是自发的。</p><h3 id="服务端接收到请求"><a href="#服务端接收到请求" class="headerlink" title="服务端接收到请求"></a><strong>服务端接收到请求</strong></h3><p>解析该请求：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">request = Request.parseRequest(mInput);</div></pre></td></tr></table></figure><p>并做出对应的响应：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">response = processRequest(request);</div></pre></td></tr></table></figure><p>最后发送响应给客户端。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">response.send(mOutput);</div></pre></td></tr></table></figure><h4 id="RtspServer-processRequest-Request-request"><a href="#RtspServer-processRequest-Request-request" class="headerlink" title="RtspServer#processRequest(Request request)"></a><strong>RtspServer#processRequest(Request request)</strong></h4><p>该方法会根据不同的客户端请求，执行相应处理，并拼接响应报文，最后返回给客户端。</p><p>1、当是<code>DESCRIBE</code>请求时，调用了<code>handleRequest()</code>方法（该方法创建了<code>Session</code>，所以该请求是建立同步的入口）：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">session = handleRequest(request.uri, mClient);</div></pre></td></tr></table></figure><p>拼接会话描述信息：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">StringBuilder builder = <span class="keyword">new</span> StringBuilder();</div><div class="line">builder.append(<span class="string">"Content-Base: "</span> + mClient.getLocalAddress().getHostAddress() + <span class="string">":"</span> + mClient.getLocalPort() + <span class="string">"/"</span>)<span class="comment">// Content-Base: 10.4.70.229:8086/</span></div><div class="line">        .append(<span class="string">"\r\n"</span>)</div><div class="line">        .append(<span class="string">"Content-Type: application/sdp"</span>)<span class="comment">// Content-Type: application/sdp</span></div><div class="line">        .append(<span class="string">"\r\n"</span>);</div><div class="line">response.attributes = builder.toString();</div><div class="line">response.content = session.getSessionDescription();</div><div class="line">response.status = Response.STATUS_OK;</div></pre></td></tr></table></figure><p>2、当是<code>SETUP</code>请求时，会将音视频通道分别映射到客户端指定的端口，如果客户端没有指定端口，则使用默认端口：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">Pattern pattern;</div><div class="line">Matcher matcher;</div><div class="line"><span class="keyword">int</span> port1, port2, ssrc, trackId, src[];</div><div class="line">String destination;</div><div class="line"></div><div class="line">pattern = Pattern.compile(<span class="string">"trackID=(\\w+)"</span>, Pattern.CASE_INSENSITIVE);</div><div class="line">matcher = pattern.matcher(request.uri);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!matcher.find()) &#123;</div><div class="line">    response.status = Response.STATUS_BAD_REQUEST;</div><div class="line">    <span class="keyword">return</span> response;</div><div class="line">&#125;</div><div class="line"></div><div class="line">trackId = Integer.parseInt(matcher.group(<span class="number">1</span>));</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!session.isTrackExist(trackId)) &#123;</div><div class="line">    response.status = Response.STATUS_NOT_FOUND;</div><div class="line">    <span class="keyword">return</span> response;</div><div class="line">&#125;</div><div class="line"></div><div class="line">pattern = Pattern.compile(<span class="string">"client_port=(\\d+)-(\\d+)"</span>, Pattern.CASE_INSENSITIVE);</div><div class="line">matcher = pattern.matcher(request.headers.get(<span class="string">"transport"</span>));</div><div class="line">IStream track = session.getTrack(trackId);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!matcher.find()) &#123;</div><div class="line">    <span class="keyword">int</span>[] ports = track.getDestinationPorts();</div><div class="line">    port1 = ports[<span class="number">0</span>];</div><div class="line">    port2 = ports[<span class="number">1</span>];</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    port1 = Integer.parseInt(matcher.group(<span class="number">1</span>));</div><div class="line">    port2 = Integer.parseInt(matcher.group(<span class="number">2</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line">ssrc = track.getSsrc();</div><div class="line">src = track.getLocalPorts();</div><div class="line">destination = session.getDestination();</div><div class="line"></div><div class="line">track.setDestinationPorts(port1, port2);</div></pre></td></tr></table></figure><p>调用了<code>Session#syncStart()</code>方法，该方法用于开始同步：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">session.syncStart(trackId);</div></pre></td></tr></table></figure><p>拼接会话描述信息：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">StringBuilder builder = <span class="keyword">new</span> StringBuilder();</div><div class="line">builder.append(<span class="string">"Transport: RTP/AVP/UDP;"</span> + (InetAddress.getByName(destination).isMulticastAddress() ? <span class="string">"multicast"</span> : <span class="string">"unicast"</span>)</div><div class="line">        + <span class="string">";destination="</span> + session.getDestination()</div><div class="line">        + <span class="string">";client_port="</span> + port1 + <span class="string">"-"</span> + port2</div><div class="line">        + <span class="string">";server_port="</span> + src[<span class="number">0</span>] + <span class="string">"-"</span> + src[<span class="number">1</span>]</div><div class="line">        + <span class="string">";ssrc="</span> + Integer.toHexString(ssrc)</div><div class="line">        + <span class="string">";mode=play"</span></div><div class="line">)<span class="comment">// Transport: RTP/AVP/UDP;unicast;destination=10.4.70.110;client_port=57148-57149;server_port=39848-33032;ssrc=4b5eeef9;mode=play</span></div><div class="line">        .append(<span class="string">"\r\n"</span>)</div><div class="line">        .append(<span class="string">"Session: "</span> + <span class="string">"1185d20035702ca"</span>)<span class="comment">// Session: 1185d20035702ca</span></div><div class="line">        .append(<span class="string">"\r\n"</span>)</div><div class="line">        .append(<span class="string">"Cache-Control: no-cache"</span>)<span class="comment">// Cache-Control: no-cache</span></div><div class="line">        .append(<span class="string">"\r\n"</span>);</div><div class="line">response.attributes = builder.toString();</div><div class="line">response.status = Response.STATUS_OK;</div></pre></td></tr></table></figure><h5 id="RtspServer-handleRequest-String-uri-Socket-client"><a href="#RtspServer-handleRequest-String-uri-Socket-client" class="headerlink" title="RtspServer#handleRequest(String uri, Socket client)"></a><strong>RtspServer#handleRequest(String uri, Socket client)</strong></h5><p>调用了<code>UriParser#parse()</code>方法，该方法用于解析客户端传递的参数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Session session = UriParser.parse(uri);</div></pre></td></tr></table></figure><p>设置会话的源地址和目的地址：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">session.setOrigin(client.getLocalAddress().getHostAddress());</div><div class="line"><span class="keyword">if</span> (session.getDestination() == <span class="keyword">null</span>) &#123;</div><div class="line">    session.setDestination(client.getInetAddress().getHostAddress());</div><div class="line">&#125;</div></pre></td></tr></table></figure><h5 id="Session-syncStart-int-id"><a href="#Session-syncStart-int-id" class="headerlink" title="Session#syncStart(int id)"></a><strong>Session#syncStart(int id)</strong></h5><p>开始同步流：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">stream.start();</div></pre></td></tr></table></figure><p>对于<code>H264</code>视频，依次调用了<code>H264Stream#start()</code>-&gt;<code>VideoStream#start()</code>-&gt;<code>MediaStream#start()</code>-&gt;<code>MediaStream#encodeWithMediaCodec()</code>-&gt;<code>VideoStream#encodeWithMediaCodec()</code>-&gt;<code>VideoStream#encodeWithMediaCodecMethod1()</code>。</p><h6 id="VideoStream-encodeWithMediaCodecMethod1"><a href="#VideoStream-encodeWithMediaCodecMethod1" class="headerlink" title="VideoStream#encodeWithMediaCodecMethod1()"></a><strong>VideoStream#encodeWithMediaCodecMethod1()</strong></h6><p>开始相机预览：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">camera.startPreview();</div></pre></td></tr></table></figure><p>调试编码参数后运行编码器：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">EncoderDebugger debugger = EncoderDebugger.debug(mSharedPreferences, mQuality.resX, mQuality.resY);</div><div class="line"><span class="keyword">final</span> Nv21Convertor convertor = debugger.getNv21Convertor();</div><div class="line">mediaCodec = MediaCodec.createByCodecName(debugger.getEncoderName());</div><div class="line">MediaFormat mediaFormat = MediaFormat.createVideoFormat(<span class="string">"video/avc"</span>, mQuality.resX, mQuality.resY);</div><div class="line">mediaFormat.setInteger(MediaFormat.KEY_BIT_RATE, mQuality.bitrate);</div><div class="line">mediaFormat.setInteger(MediaFormat.KEY_FRAME_RATE, mQuality.framerate);</div><div class="line">mediaFormat.setInteger(MediaFormat.KEY_COLOR_FORMAT, debugger.getEncoderColorFormat());</div><div class="line">mediaFormat.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, <span class="number">1</span>);</div><div class="line">mediaCodec.configure(mediaFormat, <span class="keyword">null</span>, <span class="keyword">null</span>, MediaCodec.CONFIGURE_FLAG_ENCODE);</div><div class="line">mediaCodec.start();</div></pre></td></tr></table></figure><p>将预览回调的帧数据进行转换，再由编码器编码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">    camera.addCallbackBuffer(<span class="keyword">new</span> <span class="keyword">byte</span>[convertor.getBufferSize()]);</div><div class="line">&#125;</div><div class="line">camera.setPreviewCallbackWithBuffer(<span class="keyword">new</span> Camera.PreviewCallback() &#123;</div><div class="line">    ByteBuffer[] inputBuffers = mediaCodec.getInputBuffers();</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPreviewFrame</span><span class="params">(<span class="keyword">byte</span>[] data, Camera camera)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">int</span> bufferIndex = mediaCodec.dequeueInputBuffer(<span class="number">500000</span>);</div><div class="line">            <span class="keyword">if</span> (bufferIndex &gt;= <span class="number">0</span>) &#123;</div><div class="line">                inputBuffers[bufferIndex].clear();</div><div class="line">                <span class="keyword">if</span> (data == <span class="keyword">null</span>) &#123;</div><div class="line">                    Log.e(TAG, <span class="string">"Symptom of the \"Callback buffer was to small\" problem..."</span>);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    convertor.convert(data, inputBuffers[bufferIndex]);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">long</span> now = System.nanoTime() / <span class="number">1000</span>;</div><div class="line">                mediaCodec.queueInputBuffer(bufferIndex, <span class="number">0</span>, inputBuffers[bufferIndex].position(), now, <span class="number">0</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                Log.e(TAG, <span class="string">"No buffer available !"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">finally</span> &#123;</div><div class="line">            VideoStream.<span class="keyword">this</span>.camera.addCallbackBuffer(data);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p>将数据写入打包器，启动打包器线程：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">packetizer.setInputStream(<span class="keyword">new</span> MediaCodecInputStream(mediaCodec));</div><div class="line">packetizer.start();</div></pre></td></tr></table></figure><p>####### <strong>H264Packetizer#run()</strong></p><p>调用了<code>send()</code>方法发送数据。</p><p>######## <strong>H264Packetizer#send()</strong></p><p>生成<code>NAL</code>单元<code>LENGTH</code>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fill(header, <span class="number">0</span>, NALU_LENGTH_LENGTH);</div></pre></td></tr></table></figure><p>生成时间戳和<code>NAL</code>单元长度：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">timestamp = ((MediaCodecInputStream) inputStream).getLastBufferInfo().presentationTimeUs * <span class="number">1000L</span>;</div><div class="line">naluLength = inputStream.available() + <span class="number">1</span>;</div></pre></td></tr></table></figure><p>如果出现<code>NAL</code>单元类型为<code>IDR</code>类型，需要调用<code>AbstractPacketizer#send()</code>方法发送该数据：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">buffer = rtpSocket.requestBuffer();</div><div class="line">rtpSocket.markNextPacket();</div><div class="line">rtpSocket.updateTimestamp(timestamp);</div><div class="line">System.arraycopy(mStapA, <span class="number">0</span>, buffer, RtpSocket.RTP_HEADER_LENGTH, mStapA.length);</div><div class="line"><span class="keyword">super</span>.send(RtpSocket.RTP_HEADER_LENGTH + mStapA.length);</div></pre></td></tr></table></figure><p>如果<code>NAL</code>长度低于设置的最大包大小，会调用<code>AbstractPacketizer#send()</code>方法发送该数据，否则，拆分<code>NAL</code>单元为<code>FU-A</code>单元再调用<code>AbstractPacketizer#send()</code>方法发送：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Small NAL unit =&gt; Single NAL unit</span></div><div class="line"><span class="keyword">if</span> (naluLength &lt;= MAX_PACKET_SIZE - RtpSocket.RTP_HEADER_LENGTH - <span class="number">2</span>) &#123;</div><div class="line">    buffer = rtpSocket.requestBuffer();</div><div class="line">    <span class="comment">// RTP 头后面的一个字节用于表示前一个 NALU 的长度</span></div><div class="line">    buffer[RtpSocket.RTP_HEADER_LENGTH] = header[<span class="number">4</span>];</div><div class="line">    fill(buffer, RtpSocket.RTP_HEADER_LENGTH + <span class="number">1</span>, naluLength - <span class="number">1</span>);</div><div class="line">    rtpSocket.updateTimestamp(timestamp);</div><div class="line">    rtpSocket.markNextPacket();</div><div class="line">    <span class="keyword">super</span>.send(naluLength + RtpSocket.RTP_HEADER_LENGTH);</div><div class="line">    <span class="comment">// Log.d(TAG,"----- Single NAL unit - len:"+len+" delay: "+delay);</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// Large NAL unit =&gt; Split nal unit</span></div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// Set FU-A header</span></div><div class="line">    header[<span class="number">1</span>] = (<span class="keyword">byte</span>) (header[<span class="number">4</span>] &amp; <span class="number">0x1F</span>);  <span class="comment">// FU header type</span></div><div class="line">    header[<span class="number">1</span>] += <span class="number">0x80</span>; <span class="comment">// Start bit</span></div><div class="line">    <span class="comment">// Set FU-A indicator</span></div><div class="line">    header[<span class="number">0</span>] = (<span class="keyword">byte</span>) ((header[<span class="number">4</span>] &amp; <span class="number">0x60</span>) &amp; <span class="number">0xFF</span>); <span class="comment">// FU indicator NRI</span></div><div class="line">    header[<span class="number">0</span>] += <span class="number">28</span>;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (sum &lt; naluLength) &#123;</div><div class="line">        buffer = rtpSocket.requestBuffer();</div><div class="line">        buffer[RtpSocket.RTP_HEADER_LENGTH] = header[<span class="number">0</span>];</div><div class="line">        buffer[RtpSocket.RTP_HEADER_LENGTH + <span class="number">1</span>] = header[<span class="number">1</span>];</div><div class="line">        rtpSocket.updateTimestamp(timestamp);</div><div class="line">        <span class="keyword">if</span> ((len = fill(buffer, RtpSocket.RTP_HEADER_LENGTH + <span class="number">2</span>, Math.min(naluLength - sum, MAX_PACKET_SIZE - RtpSocket.RTP_HEADER_LENGTH - <span class="number">2</span>))) &lt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        sum += len;</div><div class="line">        <span class="comment">// Last packet before next NAL</span></div><div class="line">        <span class="comment">// 下一个 NAL 前的最后一个包</span></div><div class="line">        <span class="keyword">if</span> (sum &gt;= naluLength) &#123;</div><div class="line">            <span class="comment">// End bit on</span></div><div class="line">            buffer[RtpSocket.RTP_HEADER_LENGTH + <span class="number">1</span>] += <span class="number">0x40</span>;</div><div class="line">            rtpSocket.markNextPacket();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">super</span>.send(len + RtpSocket.RTP_HEADER_LENGTH + <span class="number">2</span>);</div><div class="line">        <span class="comment">// Switch start bit</span></div><div class="line">        header[<span class="number">1</span>] = (<span class="keyword">byte</span>) (header[<span class="number">1</span>] &amp; <span class="number">0x7F</span>);</div><div class="line">        <span class="comment">// Log.d(TAG,"----- FU-A unit, sum:"+sum);</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>######### <strong>AbstractPacketizer#send(int length)</strong></p><p>调用了<code>RtpSocket#commitBuffer()</code>方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rtpSocket.commitBuffer(length);</div></pre></td></tr></table></figure><p>########## <strong>RtpSocket#commitBuffer(int length)</strong></p><p>调用<code>updateSequence()</code>方法，<code>updateSequence()</code>方法调用了<code>setLong()</code>方法，<code>setLong()</code>方法用于扩充数组索引长度。原来是 1 个字节表示一个索引，则最多可以表示 256 个索引，现在用连续的 2 个字节表示一个索引。</p><p>设置<code>UDP</code>包当前索引对应数据的长度：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">datagramPackets[bufferInputIndex].setLength(length);</div></pre></td></tr></table></figure><p>如果<code>UDP</code>包下一个索引已超过设置的缓冲大小时，从头开始替换：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (++bufferInputIndex &gt;= bufferCount) &#123;</div><div class="line">    bufferInputIndex = <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>如果<code>RtpSocket</code>线程未启动，则启动该线程：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (mThread == <span class="keyword">null</span>) &#123;</div><div class="line">    mThread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">    mThread.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>########### <strong>RtpSocket#run()</strong></p><p>调用<code>SenderReport#update()</code>方法更新数据：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">senderReport.update(datagramPackets[bufferOutputIndex].getLength(), (timestamps[bufferOutputIndex] / <span class="number">100L</span>) * (mClock / <span class="number">1000L</span>) / <span class="number">10000L</span>);</div></pre></td></tr></table></figure><p>忽略前 30 帧，之后发送缓冲区中的数据：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (count++ &gt; <span class="number">30</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (transport == TRANSPORT_UDP) &#123;</div><div class="line">        multicastSocket.send(datagramPackets[bufferOutputIndex]);<span class="comment">// TODO</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        sendTcp();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>如果<code>UDP</code>包下一个索引已超过设置的缓冲大小时，从头开始发送：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (++bufferOutputIndex &gt;= BUFFER_COUNT) &#123;</div><div class="line">    bufferOutputIndex = <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>############ <strong>SenderReport#update(int length, long rtpTimestamp)</strong></p><p>更新数据，最后调用了<code>send()</code>方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">send(System.nanoTime(), rtpTimestamp);</div></pre></td></tr></table></figure><p>############ <strong>SenderReport#send(long ntpTimestamp, long rtpTimestamp)</strong></p><p>发送<code>RTCP</code>数据：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">multicastSocket.send(datagramPacket);</div></pre></td></tr></table></figure><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://gi
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>触摸事件传递机制</title>
    <link href="http://www.weichao.io/2018/03/04/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B6/"/>
    <id>http://www.weichao.io/2018/03/04/触摸事件传递机制/</id>
    <published>2018-03-04T15:19:30.000Z</published>
    <updated>2018-03-11T01:11:22.561Z</updated>
    
    <content type="html"><![CDATA[<h1 id="触摸事件传递的三个阶段"><a href="#触摸事件传递的三个阶段" class="headerlink" title="触摸事件传递的三个阶段"></a><strong>触摸事件传递的三个阶段</strong></h1><h2 id="分发"><a href="#分发" class="headerlink" title="分发"></a><strong>分发</strong></h2><p>分发对应<code>dispatchTouchEvent()</code>方法。<br>如果当前视图是<code>ViewGroup</code>及其子类，则会调用<code>onInterceptTouchEvent()</code>方法判断是否拦截该事件。<br>该方法返回<code>true</code>或<code>false</code>表示该事件被当前视图分发过，不继续分发该事件给子视图，其中<code>true</code>表示该事件被当前视图消费掉，<code>false</code>表示该事件未被当前视图消费掉；返回<code>super.dispatchTouchEvent()</code>表示继续分发该事件给子视图。<br>该事件将会按照嵌套层次从外向内传递，到达最内层的视图时，由该视图的<code>onTouchEvent()</code>方法处理，如果该方法能消费该事件，则返回<code>true</code>，如果消费不了，返回<code>false</code>，这时事件开始按照嵌套层次从内向外传递，并由外层的视图的 <code>onTouchEvent()</code>方法进行尝试消费，其中，返回<code>true</code>为消费完毕，返回<code>false</code>为未消费，可继续向外层传递。</p><h2 id="拦截"><a href="#拦截" class="headerlink" title="拦截"></a><strong>拦截</strong></h2><p>拦截对应<code>onInterceptTouchEvent()</code>方法。<br>该方法只在<code>ViewGroup</code>及其子类中存在，在<code>Activity</code>和<code>View</code>中不存在。<br>该方法返回<code>true</code>表示拦截该事件，不继续分发给子视图，同时交给自身的<code>onTouchEvent()</code>方法进行尝试消费，其中，返回<code>true</code>为消费完毕，返回<code>false</code>为未消费，可继续向外层传递；返回<code>false</code>或<code>super.onInterceptTouchEvent</code>表示不拦截该事件，继续分发给子视图。</p><h2 id="消费"><a href="#消费" class="headerlink" title="消费"></a><strong>消费</strong></h2><p>消费对应<code>onTouchEvent()</code>方法。<br>该方法返回<code>true</code>表示处理该事件，不传递该事件给父视图；返回<code>false</code>表示当前视图不处理该事件，传递该事件给父视图的<code>onTouchEvent()</code>方法尝试消费。</p><h1 id="其他说明"><a href="#其他说明" class="headerlink" title="其他说明"></a><strong>其他说明</strong></h1><ul><li>如果同时有<code>Activity</code>、<code>ViewGroup</code>、<code>View</code>时，嵌套层次由外向内是<code>Activity</code>、<code>ViewGroup</code>、<code>View</code>。</li><li><code>View</code>控件的事件触发顺序是先执行<code>onTouch()</code>方法，再执行<code>onClick()</code>方法。如果<code>onTouch()</code>方法中返回<code>true</code>，最后不会调用<code>onClick()</code>方法。</li><li>事件的类型有三种：<ul><li><code>ACTION_DOWN</code>：手指按下操作，表示触摸事件的开始。</li><li><code>ACTION_MOVE</code>：手指移动距离超过阈值会被计为一次<code>ACTION_MOVE</code>，所以一次完整的触摸事件可能包含多个<code>ACTION_MOVE</code>，也可能一个都没有。</li><li><code>ACTION_UP</code>：手指离开屏幕，表示触摸事件的结束。</li></ul></li><li>如果一层级的最外层控件的<code>dispatchTouchEvent()</code>方法返回<code>false</code>，该层级会不响应触摸事件并且事件也不会被消费，会继续让该层级后面的下一层级处理，相当于点击“穿透”了。</li></ul><hr><h1 id="验证触摸事件传递过程"><a href="#验证触摸事件传递过程" class="headerlink" title="验证触摸事件传递过程"></a><strong>验证触摸事件传递过程</strong></h1><h2 id="默认的传递过程"><a href="#默认的传递过程" class="headerlink" title="默认的传递过程"></a><strong>默认的传递过程</strong></h2><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a><strong>代码</strong></h3><p>1.Test_Touch\app\src\main\java\io\weichao\test_touch\MainActivity.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.test_touch;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> android.view.MotionEvent;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</div><div class="line">        Log.d(<span class="string">"test_touch"</span>, <span class="string">"MainActivity dispatchTouchEvent"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(ev);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">        Log.d(<span class="string">"test_touch"</span>, <span class="string">"MainActivity onTouchEvent"</span>);</div><div class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"MainActivity onTouchEvent MotionEvent.ACTION_DOWN"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"MainActivity onTouchEvent MotionEvent.ACTION_MOVE"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"MainActivity onTouchEvent MotionEvent.ACTION_UP"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2.Test_Touch\app\src\main\res\layout\activity_main.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">io.weichao.test_touch.CustomRelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/CustomRelativeLayout"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@android:color/holo_red_dark"</span></span></div><div class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">"io.weichao.test_touch.MainActivity"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">io.weichao.test_touch.CustomButton</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/CustomButton"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Button"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">io.weichao.test_touch.CustomRelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure><p>3.Test_Touch\app\src\main\java\io\weichao\test_touch\CustomRelativeLayout.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.test_touch;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.util.AttributeSet;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> android.view.MotionEvent;</div><div class="line"><span class="keyword">import</span> android.widget.RelativeLayout;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Created by pi on 2017/7/27.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomRelativeLayout</span> <span class="keyword">extends</span> <span class="title">RelativeLayout</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomRelativeLayout</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomRelativeLayout</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomRelativeLayout</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomRelativeLayout</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr, <span class="keyword">int</span> defStyleRes)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr, defStyleRes);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</div><div class="line">        Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomRelativeLayout dispatchTouchEvent"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(ev);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onInterceptTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</div><div class="line">        Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomRelativeLayout onInterceptTouchEvent"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onInterceptTouchEvent(ev);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">        Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomRelativeLayout onTouchEvent"</span>);</div><div class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomRelativeLayout onTouchEvent MotionEvent.ACTION_DOWN"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomRelativeLayout onTouchEvent MotionEvent.ACTION_MOVE"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomRelativeLayout onTouchEvent MotionEvent.ACTION_UP"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>4.Test_Touch\app\src\main\java\io\weichao\test_touch\CustomButton.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.weichao.test_touch;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.support.v7.widget.AppCompatButton;</div><div class="line"><span class="keyword">import</span> android.util.AttributeSet;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> android.view.MotionEvent;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Created by pi on 2017/7/27.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomButton</span> <span class="keyword">extends</span> <span class="title">AppCompatButton</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomButton</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomButton</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomButton</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</div><div class="line">        Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomButton dispatchTouchEvent"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(ev);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">        Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomButton onTouchEvent"</span>);</div><div class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomButton onTouchEvent MotionEvent.ACTION_DOWN"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomButton onTouchEvent MotionEvent.ACTION_MOVE"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">                Log.d(<span class="string">"test_touch"</span>, <span class="string">"CustomButton onTouchEvent MotionEvent.ACTION_UP"</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="显示的界面"><a href="#显示的界面" class="headerlink" title="显示的界面"></a><strong>显示的界面</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B61.png" alt=""></p><h3 id="点击下面的紫色区域，显示-log"><a href="#点击下面的紫色区域，显示-log" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B62.png" alt=""></p><p>按下会触发1次，弹起会触发1次，每判定出一次移动会触发1次。</p><h3 id="点击红色区域，显示-log"><a href="#点击红色区域，显示-log" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B63.png" alt=""></p><p>中间部分每判定出一次移动会触发1次，这里触发了3次。</p><h3 id="点击灰色区域，显示-log"><a href="#点击灰色区域，显示-log" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B64.png" alt=""></p><p>中间部分每判定出一次移动会触发1次，这里触发了3次。</p><h2 id="只修改-Activity"><a href="#只修改-Activity" class="headerlink" title="只修改 Activity"></a><strong>只修改 Activity</strong></h2><h3 id="只修改-dispatchTouchEvent-方法，返回-true-或-false"><a href="#只修改-dispatchTouchEvent-方法，返回-true-或-false" class="headerlink" title="只修改 dispatchTouchEvent()方法，返回 true 或 false"></a><strong>只修改 dispatchTouchEvent()方法，返回 true 或 false</strong></h3><h4 id="点击下面的紫色区域，显示-log-1"><a href="#点击下面的紫色区域，显示-log-1" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B65.png" alt=""></p><h4 id="点击红色区域，显示-log-1"><a href="#点击红色区域，显示-log-1" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B66.png" alt=""></p><h4 id="点击灰色区域，显示-log-1"><a href="#点击灰色区域，显示-log-1" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B67.png" alt=""></p><h4 id="与默认的传递过程对比"><a href="#与默认的传递过程对比" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p>事件被<code>MainActivity</code>分发过，不管是否被消费，都不会再分发，所以不执行任何<code>onTouchEvent()</code>方法。</p><h3 id="只修改-onTouchEvent-方法，返回-true-或-false"><a href="#只修改-onTouchEvent-方法，返回-true-或-false" class="headerlink" title="只修改 onTouchEvent()方法，返回 true 或 false"></a><strong>只修改 onTouchEvent()方法，返回 true 或 false</strong></h3><h4 id="点击下面的紫色区域，显示-log-2"><a href="#点击下面的紫色区域，显示-log-2" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B68.png" alt=""></p><h4 id="点击红色区域，显示-log-2"><a href="#点击红色区域，显示-log-2" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B69.png" alt=""></p><h4 id="点击灰色区域，显示-log-2"><a href="#点击灰色区域，显示-log-2" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B610.png" alt=""></p><h4 id="与默认的传递过程对比-1"><a href="#与默认的传递过程对比-1" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p>无变化，但是返回<code>true</code>时最后不会调用<code>MainAcitivity</code>的<code>onClick()</code>方法。</p><h2 id="只修改-CustomRelativeLayout"><a href="#只修改-CustomRelativeLayout" class="headerlink" title="只修改 CustomRelativeLayout"></a><strong>只修改 CustomRelativeLayout</strong></h2><h3 id="只修改-dispatchTouchEvent-方法，返回-true"><a href="#只修改-dispatchTouchEvent-方法，返回-true" class="headerlink" title="只修改 dispatchTouchEvent()方法，返回 true"></a><strong>只修改 dispatchTouchEvent()方法，返回 true</strong></h3><h4 id="点击下面的紫色区域，显示-log-3"><a href="#点击下面的紫色区域，显示-log-3" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B611.png" alt=""></p><h4 id="点击红色区域，显示-log-3"><a href="#点击红色区域，显示-log-3" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B612.png" alt=""></p><h4 id="点击灰色区域，显示-log-3"><a href="#点击灰色区域，显示-log-3" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B613.png" alt=""></p><h4 id="与默认的传递过程对比-2"><a href="#与默认的传递过程对比-2" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p>事件被<code>CustomRelativeLayout</code>分发过，且被消费了，所以不执行任何<code>onTouchEvent()</code>方法。</p><h3 id="只修改-dispatchTouchEvent-方法，返回-false"><a href="#只修改-dispatchTouchEvent-方法，返回-false" class="headerlink" title="只修改 dispatchTouchEvent()方法，返回 false"></a><strong>只修改 dispatchTouchEvent()方法，返回 false</strong></h3><h4 id="点击下面的紫色区域，显示-log-4"><a href="#点击下面的紫色区域，显示-log-4" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B614.png" alt=""></p><h4 id="点击红色区域，显示-log-4"><a href="#点击红色区域，显示-log-4" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B614_1.png" alt=""></p><h4 id="点击灰色区域，显示-log-4"><a href="#点击灰色区域，显示-log-4" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B615.png" alt=""></p><h4 id="与默认的传递过程对比-3"><a href="#与默认的传递过程对比-3" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p>事件被<code>CustomRelativeLayout</code>分发过，但未被消费过，所以该事件被<code>MainActivity</code>消费掉，执行<code>MainActivity</code>的<code>onTouchEvent()</code>方法。</p><h3 id="只修改-onInterceptTouchEvent-方法，返回-true"><a href="#只修改-onInterceptTouchEvent-方法，返回-true" class="headerlink" title="只修改 onInterceptTouchEvent()方法，返回 true"></a><strong>只修改 onInterceptTouchEvent()方法，返回 true</strong></h3><h4 id="点击下面的紫色区域，显示-log-5"><a href="#点击下面的紫色区域，显示-log-5" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B616.png" alt=""></p><h4 id="点击红色区域，显示-log-5"><a href="#点击红色区域，显示-log-5" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B617.png" alt=""></p><h4 id="点击灰色区域，显示-log-5"><a href="#点击灰色区域，显示-log-5" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B618.png" alt=""></p><h4 id="与默认的传递过程对比-4"><a href="#与默认的传递过程对比-4" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p><code>CustomRelativeLayout</code>拦截向下传递，所以执行<code>CustomRelativeLayout</code>和<code>MainActivity</code>的<code>onTouchEvent()</code>方法。</p><h3 id="只修改-onInterceptTouchEvent-方法，返回-false"><a href="#只修改-onInterceptTouchEvent-方法，返回-false" class="headerlink" title="只修改 onInterceptTouchEvent()方法，返回 false"></a><strong>只修改 onInterceptTouchEvent()方法，返回 false</strong></h3><h4 id="点击下面的紫色区域，显示-log-6"><a href="#点击下面的紫色区域，显示-log-6" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B619.png" alt=""></p><h4 id="点击红色区域，显示-log-6"><a href="#点击红色区域，显示-log-6" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B620.png" alt=""></p><h4 id="点击灰色区域，显示-log-6"><a href="#点击灰色区域，显示-log-6" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B621.png" alt=""></p><h4 id="与默认的传递过程对比-5"><a href="#与默认的传递过程对比-5" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p><code>CustomRelativeLayout</code>不拦截向下传递，所以当<code>CustomButton</code>有触摸事件时，会消费掉该事件，所以执行<code>CustomButton</code>的<code>onTouchEvent()</code>方法；否则，<code>CustomRelativeLayout</code>不会消费掉该事件，所以执行<code>CustomRelativeLayout</code>和<code>MainActivity</code>的<code>onTouchEvent()</code>方法。</p><h3 id="只修改-onTouchEvent-方法，返回-true"><a href="#只修改-onTouchEvent-方法，返回-true" class="headerlink" title="只修改 onTouchEvent()方法，返回 true"></a><strong>只修改 onTouchEvent()方法，返回 true</strong></h3><h4 id="点击下面的紫色区域，显示-log-7"><a href="#点击下面的紫色区域，显示-log-7" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B622.png" alt=""></p><h4 id="点击红色区域，显示-log-7"><a href="#点击红色区域，显示-log-7" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B623.png" alt=""></p><h4 id="点击灰色区域，显示-log-7"><a href="#点击灰色区域，显示-log-7" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B624.png" alt=""></p><h4 id="与默认的传递过程对比-6"><a href="#与默认的传递过程对比-6" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p><code>CustomRelativeLayout</code>不拦截向下传递，所以当<code>CustomButton</code>有触摸事件时，会消费掉该事件，所以执行<code>CustomButton</code>的<code>onTouchEvent()</code>方法；否则，<code>CustomRelativeLayout</code>会消费掉该事件，所以执行<code>CustomRelativeLayout</code>的<code>onTouchEvent()</code>方法。</p><h3 id="只修改-onTouchEvent-方法，返回-false"><a href="#只修改-onTouchEvent-方法，返回-false" class="headerlink" title="只修改 onTouchEvent()方法，返回 false"></a><strong>只修改 onTouchEvent()方法，返回 false</strong></h3><h4 id="点击下面的紫色区域，显示-log-8"><a href="#点击下面的紫色区域，显示-log-8" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B625.png" alt=""></p><h4 id="点击红色区域，显示-log-8"><a href="#点击红色区域，显示-log-8" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B626.png" alt=""></p><h4 id="点击灰色区域，显示-log-8"><a href="#点击灰色区域，显示-log-8" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B627.png" alt=""></p><h4 id="与默认的传递过程对比-7"><a href="#与默认的传递过程对比-7" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p>和【只修改 onInterceptTouchEvent()方法，返回 false】一样。</p><h2 id="只修改-CustomButton"><a href="#只修改-CustomButton" class="headerlink" title="只修改 CustomButton"></a><strong>只修改 CustomButton</strong></h2><h3 id="只修改-dispatchTouchEvent-方法，返回-true-1"><a href="#只修改-dispatchTouchEvent-方法，返回-true-1" class="headerlink" title="只修改 dispatchTouchEvent()方法，返回 true"></a><strong>只修改 dispatchTouchEvent()方法，返回 true</strong></h3><h4 id="点击下面的紫色区域，显示-log-9"><a href="#点击下面的紫色区域，显示-log-9" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B628.png" alt=""></p><h4 id="点击红色区域，显示-log-9"><a href="#点击红色区域，显示-log-9" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B629.png" alt=""></p><h4 id="点击灰色区域，显示-log-9"><a href="#点击灰色区域，显示-log-9" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B630.png" alt=""></p><h4 id="与默认的传递过程对比-8"><a href="#与默认的传递过程对比-8" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p><code>CustomRelativeLayout</code>不拦截向下传递，所以当<code>CustomButton</code>有触摸事件时，会试图消费掉该事件，但因为<code>CustomButton</code>已分发过，所以不执行<code>CustomButton</code>的<code>onTouchEvent()</code>方法，同时该事件也被消费了，所以不会再被<code>CustomRelativeLayout</code>或<code>MainActivity</code>消费；否则，默认<code>CustomRelativeLayout</code>也不会消费掉该事件，所以执行<code>CustomRelativeLayout</code>和<code>MainActivity</code>的<code>onTouchEvent()</code>方法。</p><h3 id="只修改-dispatchTouchEvent-方法，返回-false-1"><a href="#只修改-dispatchTouchEvent-方法，返回-false-1" class="headerlink" title="只修改 dispatchTouchEvent()方法，返回 false"></a><strong>只修改 dispatchTouchEvent()方法，返回 false</strong></h3><h4 id="点击下面的紫色区域，显示-log-10"><a href="#点击下面的紫色区域，显示-log-10" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B631.png" alt=""></p><h4 id="点击红色区域，显示-log-10"><a href="#点击红色区域，显示-log-10" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B632.png" alt=""></p><h4 id="点击灰色区域，显示-log-10"><a href="#点击灰色区域，显示-log-10" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B633.png" alt=""></p><h4 id="与默认的传递过程对比-9"><a href="#与默认的传递过程对比-9" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p><code>CustomRelativeLayout</code>不拦截向下传递，所以当<code>CustomButton</code>有触摸事件时，会试图消费掉该事件，但因为<code>CustomButton</code>已分发过，所以不执行<code>CustomButton</code>的<code>onTouchEvent()</code>方法，但同时未消费过，但默认<code>CustomRelativeLayout</code>也不会消费掉该事件，所以执行<code>CustomRelativeLayout</code>和<code>MainActivity</code>的<code>onTouchEvent()</code>方法；否则，默认<code>CustomRelativeLayout</code>也不会消费掉该事件，所以执行<code>CustomRelativeLayout</code>和<code>MainActivity</code>的<code>onTouchEvent()</code>方法。</p><h3 id="只修改-onTouchEvent-方法，返回-true-1"><a href="#只修改-onTouchEvent-方法，返回-true-1" class="headerlink" title="只修改 onTouchEvent()方法，返回 true"></a><strong>只修改 onTouchEvent()方法，返回 true</strong></h3><h4 id="点击下面的紫色区域，显示-log-11"><a href="#点击下面的紫色区域，显示-log-11" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B634.png" alt=""></p><h4 id="点击红色区域，显示-log-11"><a href="#点击红色区域，显示-log-11" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B635.png" alt=""></p><h4 id="点击灰色区域，显示-log-11"><a href="#点击灰色区域，显示-log-11" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B636.png" alt=""></p><h4 id="与默认的传递过程对比-10"><a href="#与默认的传递过程对比-10" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p><code>CustomRelativeLayout</code>不拦截向下传递，所以当<code>CustomButton</code>有触摸事件时，会消费掉该事件；否则，默认<code>CustomRelativeLayout</code>也不会消费掉该事件，所以执行<code>CustomRelativeLayout</code>和<code>MainActivity</code>的<code>onTouchEvent()</code>方法。</p><h3 id="只修改-onTouchEvent-方法，返回-false-1"><a href="#只修改-onTouchEvent-方法，返回-false-1" class="headerlink" title="只修改 onTouchEvent()方法，返回 false"></a><strong>只修改 onTouchEvent()方法，返回 false</strong></h3><h4 id="点击下面的紫色区域，显示-log-12"><a href="#点击下面的紫色区域，显示-log-12" class="headerlink" title="点击下面的紫色区域，显示 log"></a><strong>点击下面的紫色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B637.png" alt=""></p><h4 id="点击红色区域，显示-log-12"><a href="#点击红色区域，显示-log-12" class="headerlink" title="点击红色区域，显示 log"></a><strong>点击红色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B638.png" alt=""></p><h4 id="点击灰色区域，显示-log-12"><a href="#点击灰色区域，显示-log-12" class="headerlink" title="点击灰色区域，显示 log"></a><strong>点击灰色区域，显示 log</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E6%9C%BA%E5%88%B639.png" alt=""></p><h4 id="与默认的传递过程对比-11"><a href="#与默认的传递过程对比-11" class="headerlink" title="与默认的传递过程对比"></a><strong>与默认的传递过程对比</strong></h4><p>完全一样。</p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;触摸事件传递的三个阶段&quot;&gt;&lt;a href=&quot;#触摸事件传递的三个阶段&quot; class=&quot;headerlink&quot; title=&quot;触摸事件传递的三个阶段&quot;&gt;&lt;/a&gt;&lt;strong&gt;触摸事件传递的三个阶段&lt;/strong&gt;&lt;/h1&gt;&lt;h2 id=&quot;分发&quot;&gt;&lt;a href=
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>HTTP 学习</title>
    <link href="http://www.weichao.io/2018/03/03/HTTP-%E5%AD%A6%E4%B9%A0/"/>
    <id>http://www.weichao.io/2018/03/03/HTTP-学习/</id>
    <published>2018-03-03T09:04:59.000Z</published>
    <updated>2018-03-03T09:50:54.973Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><ul><li><a href="https://www.w3.org/Protocols/HTTP/1.1/rfc2616.pdf" title="https://www.w3.org/Protocols/HTTP/1.1/rfc2616.pdf" target="_blank" rel="external">Hypertext Transfer Protocol – HTTP/1.1</a></li><li><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" title="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" target="_blank" rel="external">超文本传输协议</a></li><li><a href="https://zh.wikipedia.org/wiki/HTTP/2" title="https://zh.wikipedia.org/wiki/HTTP/2" target="_blank" rel="external">HTTP/2</a></li><li><a href="https://segmentfault.com/a/1190000009028150" title="https://segmentfault.com/a/1190000009028150" target="_blank" rel="external">Angular 4.x HttpModule 揭秘</a></li><li><a href="https://segmentfault.com/a/1190000004556040" title="https://segmentfault.com/a/1190000004556040" target="_blank" rel="external">聊一聊 cookie</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP" target="_blank" rel="external">HTTP</a></li><li><a href="https://segmentfault.com/a/1190000006689767#articleHeader6" title="https://segmentfault.com/a/1190000006689767#articleHeader6" target="_blank" rel="external">HTTP 请求头与请求体</a></li></ul><hr><h1 id="超文本传输协议"><a href="#超文本传输协议" class="headerlink" title="超文本传输协议"></a><strong>超文本传输协议</strong></h1><p>超文本传输协议（英文：HyperText Transfer Protocol，缩写：<code>HTTP</code>）是一种用于分布式、协作式和超媒体信息系统的应用层协议。<code>HTTP</code>是万维网的数据通信的基础。<br>通常，由<code>HTTP</code>客户端发起一个请求，创建一个到服务器指定端口（默认是<code>80</code>端口）的<code>TCP</code>连接。<code>HTTP</code>服务器则在那个端口监听客户端的请求。一旦收到请求，服务器会向客户端返回一个状态，比如<code>HTTP/1.1 200 OK</code>，以及返回的内容，如请求的文件、错误消息、或者其它信息。</p><hr><h1 id="报文"><a href="#报文" class="headerlink" title="报文"></a><strong>报文</strong></h1><h2 id="请求-响应报文共有内容"><a href="#请求-响应报文共有内容" class="headerlink" title="请求/响应报文共有内容"></a><strong>请求/响应报文共有内容</strong></h2><h3 id="常用符号"><a href="#常用符号" class="headerlink" title="常用符号"></a><strong>常用符号</strong></h3><h4 id="空格"><a href="#空格" class="headerlink" title="空格"></a><strong>空格</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A01.png" alt=""></p><p><code>0x20</code></p><h4 id="回车符"><a href="#回车符" class="headerlink" title="回车符"></a><strong>回车符</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A02.png" alt=""></p><p><code>0x0d</code></p><h4 id="换行符"><a href="#换行符" class="headerlink" title="换行符"></a><strong>换行符</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A03.png" alt=""></p><p><code>0x0a</code></p><h4 id="引号"><a href="#引号" class="headerlink" title="引号"></a><strong>引号</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A04.png" alt=""></p><p><code>0x22</code></p><h4 id="制表符"><a href="#制表符" class="headerlink" title="制表符"></a><strong>制表符</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A05.png" alt=""></p><p><code>0x09</code></p><h3 id="协议版本"><a href="#协议版本" class="headerlink" title="协议版本"></a><strong>协议版本</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A06.png" alt=""></p><h3 id="实体"><a href="#实体" class="headerlink" title="实体"></a><strong>实体</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A07.png" alt=""></p><h4 id="实体头"><a href="#实体头" class="headerlink" title="实体头"></a><strong>实体头</strong></h4><h5 id="协议中的实体头"><a href="#协议中的实体头" class="headerlink" title="协议中的实体头"></a><strong>协议中的实体头</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A08.png" alt=""></p><h6 id="Allow"><a href="#Allow" class="headerlink" title="Allow"></a><strong>Allow</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A09.png" alt=""></p><p>枚举资源所支持的<code>HTTP</code>方法的集合。</p><h6 id="Content-Encoding"><a href="#Content-Encoding" class="headerlink" title="Content-Encoding"></a><strong>Content-Encoding</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A010.png" alt=""></p><p>告知客户端应该怎样解码才能获取在<code>Content-Type</code>中标示的媒体类型内容。</p><h6 id="Content-Language"><a href="#Content-Language" class="headerlink" title="Content-Language"></a><strong>Content-Language</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A011.png" alt=""></p><p>通知客户端应该使用的语言。</p><h6 id="Content-Length"><a href="#Content-Length" class="headerlink" title="Content-Length"></a><strong>Content-Length</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A012.png" alt=""></p><p>指明发送给接收方的消息主体的大小，即用十进制数字表示的字节数。</p><h6 id="Content-Location"><a href="#Content-Location" class="headerlink" title="Content-Location"></a><strong>Content-Location</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A013.png" alt=""></p><p>指向的是可供访问的资源的直接地址。</p><h6 id="Content-MD5"><a href="#Content-MD5" class="headerlink" title="Content-MD5"></a><strong>Content-MD5</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A014.png" alt=""></p><h6 id="Content-Range"><a href="#Content-Range" class="headerlink" title="Content-Range"></a><strong>Content-Range</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A0121.png" alt=""></p><p>一个数据片段在整个文件中的位置。</p><h6 id="Content-Type"><a href="#Content-Type" class="headerlink" title="Content-Type"></a><strong>Content-Type</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A016.png" alt=""></p><p>告诉客户端实际返回的内容的内容类型。</p><h6 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a><strong>Expires</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A017.png" alt=""></p><p>指定一个时间，在这个时间之后，<code>HTTP</code>响应被认为是过时的。</p><h6 id="Last-Modified"><a href="#Last-Modified" class="headerlink" title="Last-Modified"></a><strong>Last-Modified</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A018.png" alt=""></p><p>包含源头服务器认定的资源做出修改的时间。</p><h6 id="extension-header"><a href="#extension-header" class="headerlink" title="extension-header"></a><strong>extension-header</strong></h6><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A019.png" alt=""></p><p>就是消息头。</p><h4 id="实体体"><a href="#实体体" class="headerlink" title="实体体"></a><strong>实体体</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A021.png" alt=""></p><p>十六进制的数据。</p><h3 id="消息"><a href="#消息" class="headerlink" title="消息"></a><strong>消息</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A022.png" alt=""></p><h4 id="消息头"><a href="#消息头" class="headerlink" title="消息头"></a><strong>消息头</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A023.png" alt=""></p><h5 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a><strong>Cache-Control</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A0122.png" alt=""></p><p>通过指定指令来实现缓存机制。</p><h5 id="Data"><a href="#Data" class="headerlink" title="Data"></a><strong>Data</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A025.png" alt=""></p><p>包含了消息生成的日期和时间。</p><h4 id="消息体"><a href="#消息体" class="headerlink" title="消息体"></a><strong>消息体</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A026.png" alt=""></p><p>实体体或实体体编码后的。</p><h2 id="请求报文格式"><a href="#请求报文格式" class="headerlink" title="请求报文格式"></a><strong>请求报文格式</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A027.png" alt=""></p><h3 id="图形化看请求报文格式"><a href="#图形化看请求报文格式" class="headerlink" title="图形化看请求报文格式"></a><strong>图形化看请求报文格式</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A028.png" alt=""></p><h3 id="从实际报文看请求报文格式"><a href="#从实际报文看请求报文格式" class="headerlink" title="从实际报文看请求报文格式"></a><strong>从实际报文看请求报文格式</strong></h3><p>报文：</p><pre><code>GET http://google.com/ HTTP/1.1Host: google.comProxy-Connection: keep-aliveUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7Cookie: CONSENT=YES+CN.zh-CN+20180212-01-0; SID=zwW58_4F0D8AzCbilnhAA59AS5u-hSyYn4DVyXcfCX4UYiQymleOqJ2B29o7ztTJ6C0TBw.; HSID=Aytk1MX24fv9cmSGl; APISID=NQCJtL-0Hs86V74b/AwpE5C4kviQOQC7ey; 1P_JAR=2018-3-1-0; NID=124=qmExYKzxr_cAisI1O_YQzj7EZVMl6RIorDC0vFZXYsmurbzi-YsRiYdnsFpNy9wy2e6PlpE67ipRAuvgD9iMMqMuwLzBJgjmbiC2atdGhrNAk52sVzj8B-fCaCKm3TwJV2Z4sWBQXGT1RefjynkwiUji2M4eXHaXXKETVprordDqVpZqxkSZfB8BS0ooJqT4PcnjRk0Hjw-A1xqO8S1yM8XJtmL1a5hyPPLg8PZ9suXNjVcno75ZBaoypOp7igjE3XIQiRAkbejXFbcqfLL97NQP; SIDCC=AAiTGe8ZMSv1kX5ZjP4x1uctVkWNqv7U15nY8YQn0vK2a1yOTVXJM6APXxPJ8ZtXzORc4qw8uw</code></pre><p>报文对应的十六进制：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A029.png" alt=""></p><h3 id="请求方法"><a href="#请求方法" class="headerlink" title="请求方法"></a><strong>请求方法</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A030.png" alt=""></p><h4 id="GET"><a href="#GET" class="headerlink" title="GET"></a><strong>GET</strong></h4><p>获取数据。</p><h4 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a><strong>HEAD</strong></h4><p>请求资源的<code>header</code>信息，并且这些<code>header</code>与<code>GET</code>方法请求时返回的一致。 该请求方法的一个使用场景是在下载一个大文件前先获取其大小再决定是否要下载，以此可以节约带宽资源。</p><h4 id="POST"><a href="#POST" class="headerlink" title="POST"></a><strong>POST</strong></h4><p>发送数据给服务器。请求主体的类型由<code>Content-Type header</code>指定。一个<code>POST</code>请求通常是通过<code>HTML</code>表单发送，并返回服务器的修改结果。</p><h3 id="Request-URI"><a href="#Request-URI" class="headerlink" title="Request-URI"></a><strong>Request-URI</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A031.png" alt=""></p><h3 id="请求头"><a href="#请求头" class="headerlink" title="请求头"></a><strong>请求头</strong></h3><h4 id="协议中的请求头"><a href="#协议中的请求头" class="headerlink" title="协议中的请求头"></a><strong>协议中的请求头</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A032.png" alt=""></p><h5 id="Accept"><a href="#Accept" class="headerlink" title="Accept"></a><strong>Accept</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A033.png" alt=""></p><p>说明客户端可以处理的内容类型（<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types" target="_blank" rel="external">MIME类型</a>），服务器可以从诸多备选项中选择一项进行应用，并使用<code>Content-Type</code>响应头通知客户端它的选择。</p><h5 id="Accept-Charset"><a href="#Accept-Charset" class="headerlink" title="Accept-Charset"></a><strong>Accept-Charset</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A034.png" alt=""></p><p>说明客户端可以处理的字符集类型，服务器可以从诸多备选项中选择一项进行应用，并使用<code>Content-Type</code>响应头通知客户端它的选择。</p><h5 id="Accept-Encoding"><a href="#Accept-Encoding" class="headerlink" title="Accept-Encoding"></a><strong>Accept-Encoding</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A035.png" alt=""></p><p>说明客户端可以处理的内容编码方式（通常是某种压缩算法），服务器可以从诸多备选项中选择一项进行应用，并使用<code>Content-Encoding</code>响应头通知客户端它的选择。</p><h5 id="Accept-Language"><a href="#Accept-Language" class="headerlink" title="Accept-Language"></a><strong>Accept-Language</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A036.png" alt=""></p><p>说明客户端可以处理的自然语言和优先处理的区域方言，服务器可以从诸多备选项中选择一项进行应用，并使用<code>Content-Language</code>响应头通知客户端它的选择。</p><h5 id="Authorization"><a href="#Authorization" class="headerlink" title="Authorization"></a><strong>Authorization</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A037.png" alt=""></p><p>含有服务器用于验证用户代理身份的凭证。</p><h5 id="Expect"><a href="#Expect" class="headerlink" title="Expect"></a><strong>Expect</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A038.png" alt=""></p><p>表示服务器只有在满足此期望条件的情况下才能妥善地处理请求。</p><h5 id="From"><a href="#From" class="headerlink" title="From"></a><strong>From</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A039.png" alt=""></p><p>包含一个电子邮箱地址。</p><h5 id="Host"><a href="#Host" class="headerlink" title="Host"></a><strong>Host</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A040.png" alt=""></p><p>指明了服务器的域名（对于虚拟主机来说），同时可选择设置服务器监听的<code>TCP</code>端口号。<br>如果没有给定端口号，会自动使用被请求服务的默认端口（比如请求一个<code>HTTP</code>的<code>URL</code>会自动使用<code>80</code>端口）。</p><h5 id="If-Match"><a href="#If-Match" class="headerlink" title="If-Match"></a><strong>If-Match</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A041.png" alt=""></p><p>表示这是一个条件请求。<br>在请求方法为<code>GET</code>和<code>HEAD</code>的情况下，服务器仅在请求的资源满足此<code>header</code>列出的<code>ETag</code>之一时才会返回资源。<br>而对于<code>PUT</code>或其他非安全方法来说，只有在满足条件的情况下才可以将资源上传。</p><h5 id="If-Modified-Since"><a href="#If-Modified-Since" class="headerlink" title="If-Modified-Since"></a><strong>If-Modified-Since</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A042.png" alt=""></p><p>服务器只在所请求的资源在给定的日期时间之后对内容进行过修改的情况下才会将资源返回，状态码为<code>200</code>。<br>如果请求的资源从那时起未经修改，那么返回一个不带有消息主体的<code>304</code>响应，而在<code>Last-Modified</code>中会带有上次修改时间。<br>不同于<code>If-Unmodified-Since</code>，<code>If-Modified-Since</code>只可以用在<code>GET</code>或<code>HEAD</code>请求中。<br>当与<code>If-None-Match</code>一同出现时，它会被忽略掉，除非服务器不支持<code>If-None-Match</code>。</p><h5 id="If-None-Match"><a href="#If-None-Match" class="headerlink" title="If-None-Match"></a><strong>If-None-Match</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A043.png" alt=""></p><p>对于<code>GET</code>和<code>HEAD</code>请求方法来说，当且仅当服务器上没有任何资源的<code>ETag</code>属性值与这个<code>header</code>中列出的相匹配的时候，服务器端才会返回所请求的资源，响应码为<code>200</code>。<br>对于其他方法来说，当且仅当最终确认没有已存在的资源的<code>ETag</code>属性值与这个<code>header</code>中所列出的相匹配的时候，才会对请求进行相应的处理。</p><h5 id="If-Range"><a href="#If-Range" class="headerlink" title="If-Range"></a><strong>If-Range</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A044.png" alt=""></p><p>当字段值中的条件得到满足时，<code>Range</code>字段才会起作用，同时服务器回复<code>206</code>部分内容状态码，以及<code>Range</code>字段请求的相应部分；如果字段值中的条件没有得到满足，服务器将会返回<code>200</code>状态码，并返回完整的请求资源。</p><h5 id="If-Unmodified-Since"><a href="#If-Unmodified-Since" class="headerlink" title="If-Unmodified-Since"></a><strong>If-Unmodified-Since</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A045.png" alt=""></p><p>只有当资源在指定的时间之后没有进行过修改的情况下，服务器才会返回请求的资源，或是接受<code>POST</code>或其他非安全方法的请求；如果所请求的资源在指定的时间之后发生了修改，那么会返回<code>412</code>错误。</p><h5 id="Max-Forwards"><a href="#Max-Forwards" class="headerlink" title="Max-Forwards"></a><strong>Max-Forwards</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A0123.png" alt=""></p><p>通过<code>TRACE</code>方法或<code>OPTIONS</code>方法，发送包含<code>Max-Forwards</code>的请求时，该字段以十进制整数形式指定可经过的服务器最大数目。<br>服务器在往下一个服务器转发请求之前，会将<code>Max-Forwards</code>的值减<code>1</code>后重新赋值。当服务器接收到<code>Max-Forwards</code>值为<code>0</code>的请求时，则不再进行转发，而是直接返回响应。</p><h5 id="Proxy-Authorization"><a href="#Proxy-Authorization" class="headerlink" title="Proxy-Authorization"></a><strong>Proxy-Authorization</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A046.png" alt=""></p><p>包含了用户代理提供给代理服务器的用于身份验证的凭证。</p><h5 id="Range"><a href="#Range" class="headerlink" title="Range"></a><strong>Range</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A0147.png" alt=""></p><p>告知服务器返回文件的哪一部分。在一个<code>Range</code>中，可以一次性请求多个部分，服务器会以<code>multipart</code>文件的形式将其返回。如果服务器返回的是范围响应，需要使用<code>206</code>状态码。假如所请求的范围不合法，那么服务器会返回<code>416</code>状态码，表示客户端错误。服务器允许忽略<code>Range</code>，从而返回整个文件，状态码用<code>200</code>。</p><h5 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a><strong>Referer</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A0124.png" alt=""></p><p>包含了当前请求页面的来源页面的地址，即表示当前页面是通过此来源页面里的链接进入的。</p><h5 id="TE"><a href="#TE" class="headerlink" title="TE"></a><strong>TE</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A048.png" alt=""></p><p>指定用户代理希望使用的传输编码类型。</p><h5 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a><strong>User-Agent</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A049.png" alt=""></p><p>包含了一个特征字符串，用来让网络协议的对端来识别发起请求的用户代理软件的应用类型、操作系统、软件开发商以及版本号。</p><h4 id="其他请求头"><a href="#其他请求头" class="headerlink" title="其他请求头"></a><strong>其他请求头</strong></h4><h5 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a><strong>Cookie</strong></h5><pre><code>Cookie: &lt;cookie-list&gt;Cookie: name=valueCookie: name=value; name2=value2; name3=value3</code></pre><p>含有先前由服务器通过<code>Set-Cookie</code>投放并存储到客户端的<code>HTTP</code> <code>cookies</code>。</p><h5 id="Upgrade-Insecure-Requests"><a href="#Upgrade-Insecure-Requests" class="headerlink" title="Upgrade-Insecure-Requests"></a><strong>Upgrade-Insecure-Requests</strong></h5><pre><code>Upgrade-Insecure-Requests: 1</code></pre><p>表示客户端优先选择加密及带有身份验证的响应，并且它可以成功处理<code>upgrade-insecure-requests</code> <code>CSP</code>指令。</p><h5 id="Origin"><a href="#Origin" class="headerlink" title="Origin"></a><strong>Origin</strong></h5><pre><code>Origin: &quot;&quot;Origin: &lt;scheme&gt; &quot;://&quot; &lt;host&gt; [ &quot;:&quot; &lt;port&gt; ]</code></pre><p>指示了请求来自于哪个站点。该字段仅指示服务器名称，并不包含任何路径信息。</p><h3 id="请求体"><a href="#请求体" class="headerlink" title="请求体"></a><strong>请求体</strong></h3><p>就是消息体。<br>请求体有 3 种类型：</p><h4 id="任意类型"><a href="#任意类型" class="headerlink" title="任意类型"></a><strong>任意类型</strong></h4><p>服务器不会解析请求体，请求体的处理需要自己解析。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A050.png" alt=""></p><p>如<code>POST</code> <code>JSON</code>时就是这类，建议使用<code>Content-Type:application/json</code>。</p><h4 id="application-x-www-form-urlencoded"><a href="#application-x-www-form-urlencoded" class="headerlink" title="application/x-www-form-urlencoded"></a><strong>application/x-www-form-urlencoded</strong></h4><p>多个键值对之间用<code>&amp;</code>连接，键与值之前用<code>=</code>连接，且只能用<code>ASCII</code>字符，非<code>ASCII</code>字符需使用<code>UrlEncode</code>编码。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A051.png" alt=""></p><h4 id="multipart-form-data"><a href="#multipart-form-data" class="headerlink" title="multipart/form-data"></a><strong>multipart/form-data</strong></h4><p>请求体被分成为多个部分，文件上传时会被使用，每个字段/文件都被<code>boundary</code>（<code>Content-Type</code>中指定）分成单独的段，每段以<code>--</code>加 boundary 开头，然后是该段的描述头，描述头之后空一行接内容，请求结束的标志为 boundary 后面加<code>--</code>。</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A052.png" alt=""></p><p>区分是否被当成文件的关键是<code>Content-Disposition</code>是否包含<code>filename</code>，因为文件有不同的类型，所以还要使用<code>Content-Type</code>指示文件的类型，如果不知道是什么类型取值可以为<code>application/octet-stream</code>表示该文件是个二进制文件，如果不是文件则<code>Content-Type</code>可以省略。</p><h2 id="响应报文格式"><a href="#响应报文格式" class="headerlink" title="响应报文格式"></a><strong>响应报文格式</strong></h2><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A053.png" alt=""></p><h3 id="图形化看响应报文格式"><a href="#图形化看响应报文格式" class="headerlink" title="图形化看响应报文格式"></a><strong>图形化看响应报文格式</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A054.png" alt=""></p><h3 id="从实际报文看响应报文格式"><a href="#从实际报文看响应报文格式" class="headerlink" title="从实际报文看响应报文格式"></a><strong>从实际报文看响应报文格式</strong></h3><p>报文：</p><pre><code>HTTP/1.1 302 FoundCache-Control: privateContent-Type: text/html; charset=UTF-8Referrer-Policy: no-referrerLocation: http://www.google.com.hk/?gfe_rd=cr&amp;dcr=0&amp;ei=w1yXWu_sAabj8weo7rPIDwContent-Length: 272Date: Thu, 01 Mar 2018 01:52:03 GMTConnection: closeProxy-Connection: keep-alive&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;302 Moved&lt;/H1&gt;The document has moved&lt;A HREF=&quot;http://www.google.com.hk/?gfe_rd=cr&amp;amp;dcr=0&amp;amp;ei=w1yXWu_sAabj8weo7rPIDw&quot;&gt;here&lt;/A&gt;.&lt;/BODY&gt;&lt;/HTML&gt;</code></pre><p>报文对应的十六进制：</p><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A055.png" alt=""></p><h3 id="状态码-amp-状态码描述"><a href="#状态码-amp-状态码描述" class="headerlink" title="状态码 &amp; 状态码描述"></a><strong>状态码 &amp; 状态码描述</strong></h3><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A056.png" alt=""></p><h3 id="响应头"><a href="#响应头" class="headerlink" title="响应头"></a><strong>响应头</strong></h3><h4 id="协议中的响应头"><a href="#协议中的响应头" class="headerlink" title="协议中的响应头"></a><strong>协议中的响应头</strong></h4><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A057.png" alt=""></p><h5 id="Accept-Ranges"><a href="#Accept-Ranges" class="headerlink" title="Accept-Ranges"></a><strong>Accept-Ranges</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A058.png" alt=""></p><p>标识自身支持请求的范围。</p><h5 id="Age"><a href="#Age" class="headerlink" title="Age"></a><strong>Age</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A059.png" alt=""></p><p>消息对象在缓存代理中存贮的时长，以秒为单位。</p><h5 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a><strong>ETag</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A061.png" alt=""></p><p>资源的特定版本的标识符。这可以让缓存更高效，并节省带宽，因为如果内容没有改变，Web 服务器不需要发送完整的响应。</p><h5 id="Location"><a href="#Location" class="headerlink" title="Location"></a><strong>Location</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A062.png" alt=""></p><p>需要将页面重新定向至的地址。</p><h5 id="Proxy-Authenticate"><a href="#Proxy-Authenticate" class="headerlink" title="Proxy-Authenticate"></a><strong>Proxy-Authenticate</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A063.png" alt=""></p><p>指定了为获取代理服务器上的资源访问权限而使用的身份验证方式。</p><h5 id="Retry-After"><a href="#Retry-After" class="headerlink" title="Retry-After"></a><strong>Retry-After</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A064.png" alt=""></p><p>表示用户代理需要等待多长时间之后才能继续发送请求。</p><h5 id="Server"><a href="#Server" class="headerlink" title="Server"></a><strong>Server</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A065.png" alt=""></p><p>包含了处理请求的源头服务器所用到的软件相关信息。</p><h5 id="Vary"><a href="#Vary" class="headerlink" title="Vary"></a><strong>Vary</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A066.png" alt=""></p><p>决定了对于未来的一个请求头，应该用一个缓存的回复还是向源服务器请求一个新的回复。</p><h5 id="WWW-Authenticate"><a href="#WWW-Authenticate" class="headerlink" title="WWW-Authenticate"></a><strong>WWW-Authenticate</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A067.png" alt=""></p><p>定义了使用何种验证方式获取资源的连接。</p><h4 id="其他响应头"><a href="#其他响应头" class="headerlink" title="其他响应头"></a><strong>其他响应头</strong></h4><h5 id="Content-Disposition"><a href="#Content-Disposition" class="headerlink" title="Content-Disposition"></a><strong>Content-Disposition</strong></h5><p>1、作为消息主体中的消息头</p><pre><code>Content-Disposition: inlineContent-Disposition: attachmentContent-Disposition: attachment; filename=&quot;filename.jpg&quot;</code></pre><p>在<code>HTTP</code>场景中，第一个参数或者是<code>inline</code>（默认值，表示回复中的消息体会以页面的一部分或者整个页面的形式展示），或者是<code>attachment</code>（意味着消息体应该被下载到本地；大多数浏览器会呈现一个“保存为”的对话框，将<code>filename</code>的值预填为下载后的文件名，假如它存在的话）。</p><p>2、作为 multipart body 中的消息头</p><pre><code>Content-Disposition: form-dataContent-Disposition: form-data; name=&quot;fieldName&quot;Content-Disposition: form-data; name=&quot;fieldName&quot;; filename=&quot;filename.jpg&quot;</code></pre><p>在<code>HTTP</code>场景中。第一个参数总是固定不变的<code>form-data</code>；附加的参数不区分大小写，并且拥有参数值，参数名与参数值用<code>=</code>连接，参数值用<code>&quot;</code>括起来。参数之间用<code>;</code>分隔。</p><h5 id="Set-Cookie"><a href="#Set-Cookie" class="headerlink" title="Set-Cookie"></a><strong>Set-Cookie</strong></h5><pre><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt; Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt;Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;non-zero-digit&gt;Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Path=&lt;path-value&gt;Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SecureSet-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; HttpOnlySet-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=StrictSet-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=Lax// Multiple directives are also possible, for example:Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; Secure; HttpOnly</code></pre><p>服务器端向客户端发送<code>cookie</code>。</p><h5 id="Transfer-Encoding"><a href="#Transfer-Encoding" class="headerlink" title="Transfer-Encoding"></a><strong>Transfer-Encoding</strong></h5><p><img src="http://otkw6sse5.bkt.clouddn.com/HTTP-%E5%AD%A6%E4%B9%A068.png" alt=""></p><p>逐跳传输消息首部，即仅应用于两个节点之间的消息传递，而不是所请求的资源本身。一个多节点连接中的每一段都可以应用不同的<code>Transfer-Encoding</code>值。</p><h3 id="响应体"><a href="#响应体" class="headerlink" title="响应体"></a><strong>响应体</strong></h3><p>就是消息体。</p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;strong&gt;Reference&lt;/strong&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ww
      
    
    </summary>
    
    
  </entry>
  
</feed>
